\hypertarget{aper__conf_8c}{
\section{/renoir/fourmano/Desktop/OUSIM/TIPS/branches/tips\_\-build/src/axesim/aper\_\-conf.c File Reference}
\label{aper__conf_8c}\index{/renoir/fourmano/Desktop/OUSIM/TIPS/branches/tips\_\-build/src/axesim/aper\_\-conf.c@{/renoir/fourmano/Desktop/OUSIM/TIPS/branches/tips\_\-build/src/axesim/aper\_\-conf.c}}
}
{\ttfamily \#include $<$stdio.h$>$}\par
{\ttfamily \#include $<$stdlib.h$>$}\par
{\ttfamily \#include $<$string.h$>$}\par
{\ttfamily \#include $<$gsl/gsl\_\-vector.h$>$}\par
{\ttfamily \#include \char`\"{}aper\_\-conf.h\char`\"{}}\par
{\ttfamily \#include \char`\"{}disp\_\-conf.h\char`\"{}}\par
{\ttfamily \#include \char`\"{}aXe\_\-grism.h\char`\"{}}\par
{\ttfamily \#include \char`\"{}spc\_\-cfg.h\char`\"{}}\par
{\ttfamily \#include \char`\"{}aXe\_\-utils.h\char`\"{}}\par
\subsection*{Defines}
\begin{DoxyCompactItemize}
\item 
\#define \hyperlink{aper__conf_8c_aacc3ee1a7f283f8ef65cea31f4436a95}{MAX}(x, y)~(((x)$>$(y))?(x):(y))
\end{DoxyCompactItemize}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
\hyperlink{structaperture__conf}{aperture\_\-conf} $\ast$ \hyperlink{aper__conf_8c_a45d84f2fc00f438b5da9054c45b7736c}{get\_\-aperture\_\-descriptor} (char $\ast$filename)
\item 
void \hyperlink{aper__conf_8c_a10b15e7909acc0227f1796199ae027ba}{aperture\_\-conf\_\-fprintf} (FILE $\ast$file, \hyperlink{structaperture__conf}{aperture\_\-conf} $\ast$conf)
\item 
void \hyperlink{aper__conf_8c_aa1383c872a0151435880f6ad28f9bd88}{get\_\-extension\_\-numbers} (char filename\mbox{[}$\,$\mbox{]}, \hyperlink{structaperture__conf}{aperture\_\-conf} $\ast$conf, char keyword\mbox{[}$\,$\mbox{]}, char keyval\mbox{[}$\,$\mbox{]})
\item 
void \hyperlink{aper__conf_8c_a608428f59a2adb25874101610cd6afe4}{free\_\-aperture\_\-conf} (\hyperlink{structaperture__conf}{aperture\_\-conf} $\ast$conf)
\item 
double \hyperlink{aper__conf_8c_a8164c87851c09beb885a55483557a0f2}{get\_\-psf\_\-offset} (\hyperlink{structaperture__conf}{aperture\_\-conf} $\ast$conf, const \hyperlink{structbeam}{beam} actbeam)
\item 
double \hyperlink{aper__conf_8c_a63e3b3bf0beebc0fe4677687d96b85df}{get\_\-max\_\-offset} (\hyperlink{structaperture__conf}{aperture\_\-conf} $\ast$conf)
\item 
void \hyperlink{aper__conf_8c_a743136a1bf87262e5666dd20a19c036a}{extend\_\-config\_\-beams} (\hyperlink{structaperture__conf}{aperture\_\-conf} $\ast$conf)
\end{DoxyCompactItemize}


\subsection{Define Documentation}
\hypertarget{aper__conf_8c_aacc3ee1a7f283f8ef65cea31f4436a95}{
\index{aper\_\-conf.c@{aper\_\-conf.c}!MAX@{MAX}}
\index{MAX@{MAX}!aper_conf.c@{aper\_\-conf.c}}
\subsubsection[{MAX}]{\setlength{\rightskip}{0pt plus 5cm}\#define MAX(x, \/  y)~(((x)$>$(y))?(x):(y))}}
\label{aper__conf_8c_aacc3ee1a7f283f8ef65cea31f4436a95}


\subsection{Function Documentation}
\hypertarget{aper__conf_8c_a10b15e7909acc0227f1796199ae027ba}{
\index{aper\_\-conf.c@{aper\_\-conf.c}!aperture\_\-conf\_\-fprintf@{aperture\_\-conf\_\-fprintf}}
\index{aperture\_\-conf\_\-fprintf@{aperture\_\-conf\_\-fprintf}!aper_conf.c@{aper\_\-conf.c}}
\subsubsection[{aperture\_\-conf\_\-fprintf}]{\setlength{\rightskip}{0pt plus 5cm}void aperture\_\-conf\_\-fprintf (FILE $\ast$ {\em file}, \/  {\bf aperture\_\-conf} $\ast$ {\em conf})}}
\label{aper__conf_8c_a10b15e7909acc0227f1796199ae027ba}
Function: aperture\_\-conf\_\-fprintf Function to output the content of an \hyperlink{structaperture__conf}{aperture\_\-conf} structure.

Parameters: 
\begin{DoxyParams}{Parameters}
\item[{\em file}]-\/ a pointer to an output stream or file \item[{\em conf}]-\/ a pointer to an existing \hyperlink{structaperture__conf}{aperture\_\-conf} structure \end{DoxyParams}



\begin{DoxyCode}
431 {
432      int i = 0, id;
433 
434      fprintf (file, "Aperture_conf: INSTRUMENT: %s\n", conf->instrument);
435      fprintf (file, "Aperture_conf: NBEAMS: %d\n", conf->nbeams);
436      for (i = 0; i < conf->nbeams; i++)
437        {
438          id = conf->beam[i].ID;
439          fprintf (file, "Aperture_conf: BEAM%c: %d %d\n", BEAM (id),
440                   conf->beam[i].offset.dx0, conf->beam[i].offset.dx1);
441        }
442      fprintf (file, "FITS SCI extension name: %s, number: %d\n",
443               conf->science_ext, conf->science_numext);
444      fprintf (file, "FITS ERR extension name: %s, number: %d\n",
445               conf->errors_ext, conf->errors_numext);
446      fprintf (file, "FITS DQ extension name: %s, number: %d\n",
447               conf->dq_ext, conf->dq_numext);
448      fprintf (file, "DQ mask: %d\n",conf->dqmask);
449      fprintf (file, "FF filename: %s\n",conf->FFname);
450      fprintf (file, "Refx: %d\n",conf->refx);
451      fprintf (file, "Refy: %d\n",conf->refy);
452      fprintf (file, "DRZRESO: %10.3f\n",conf->drz_resol);
453      fprintf (file, "DRZSCALE: %10.3f\n",conf->drz_scale);
454      fprintf (file, "DRZLAMB0: %10.3f\n",conf->drz_lamb0);
455      fprintf (file, "DRZXINI: %10.3f\n",conf->drz_xstart);
456      fprintf (file, "DRZPFRAC: %10.3f\n",conf->drz_pfrac);
457      fprintf (file, "DRZKERNEL: %s\n",conf->drz_kernel);
458 
459 
460 }
\end{DoxyCode}
\hypertarget{aper__conf_8c_a743136a1bf87262e5666dd20a19c036a}{
\index{aper\_\-conf.c@{aper\_\-conf.c}!extend\_\-config\_\-beams@{extend\_\-config\_\-beams}}
\index{extend\_\-config\_\-beams@{extend\_\-config\_\-beams}!aper_conf.c@{aper\_\-conf.c}}
\subsubsection[{extend\_\-config\_\-beams}]{\setlength{\rightskip}{0pt plus 5cm}void extend\_\-config\_\-beams ({\bf aperture\_\-conf} $\ast$ {\em conf})}}
\label{aper__conf_8c_a743136a1bf87262e5666dd20a19c036a}
Function: extend\_\-config\_\-beams The function extends the size of the beams in a configuration structure.

Parameters: 
\begin{DoxyParams}{Parameters}
\item[{\em conf}]-\/ the configuration structure \end{DoxyParams}



\begin{DoxyCode}
605 {
606   int index;
607 
608   // go over all beams in the configuration structure
609   for (index=0; index < conf->nbeams; index++)
610     {
611       // lower the left border
612       conf->beam[index].offset.dx0 -= BCK_BEAM_EXT;
613 
614       // enhance the right border
615       conf->beam[index].offset.dx1 += BCK_BEAM_EXT;
616     }
617 }
\end{DoxyCode}
\hypertarget{aper__conf_8c_a608428f59a2adb25874101610cd6afe4}{
\index{aper\_\-conf.c@{aper\_\-conf.c}!free\_\-aperture\_\-conf@{free\_\-aperture\_\-conf}}
\index{free\_\-aperture\_\-conf@{free\_\-aperture\_\-conf}!aper_conf.c@{aper\_\-conf.c}}
\subsubsection[{free\_\-aperture\_\-conf}]{\setlength{\rightskip}{0pt plus 5cm}void free\_\-aperture\_\-conf ({\bf aperture\_\-conf} $\ast$ {\em conf})}}
\label{aper__conf_8c_a608428f59a2adb25874101610cd6afe4}
Function: free\_\-aperture\_\-conf The function releases all memory allocated in a configuration structure.

Parameters: 
\begin{DoxyParams}{Parameters}
\item[{\em conf}]-\/ the configuration structure \end{DoxyParams}



\begin{DoxyCode}
516 {
517   if (conf->psfcoeffs)
518     gsl_vector_free(conf->psfcoeffs);
519   if (conf->psfrange)
520     gsl_vector_free(conf->psfrange);
521   free(conf);
522   conf = NULL;
523 }
\end{DoxyCode}
\hypertarget{aper__conf_8c_a45d84f2fc00f438b5da9054c45b7736c}{
\index{aper\_\-conf.c@{aper\_\-conf.c}!get\_\-aperture\_\-descriptor@{get\_\-aperture\_\-descriptor}}
\index{get\_\-aperture\_\-descriptor@{get\_\-aperture\_\-descriptor}!aper_conf.c@{aper\_\-conf.c}}
\subsubsection[{get\_\-aperture\_\-descriptor}]{\setlength{\rightskip}{0pt plus 5cm}{\bf aperture\_\-conf}$\ast$ get\_\-aperture\_\-descriptor (char $\ast$ {\em filename})}}
\label{aper__conf_8c_a45d84f2fc00f438b5da9054c45b7736c}
Function: get\_\-aperture\_\-descriptor Read a configuration file and populate an \hyperlink{structaperture__conf}{aperture\_\-conf} structure containing a description of the optical set up. This function populates the geometrical description of all the beams in all the apertures listed in the configuration file.

Parameters: 
\begin{DoxyParams}{Parameters}
\item[{\em actinfo}]-\/ the header structure with the column names \item[{\em filename}]-\/ the complete filename to the axe configuration file\end{DoxyParams}
Returns: \begin{DoxyReturn}{Returns}
config -\/ the configuration structure created 
\end{DoxyReturn}



\begin{DoxyCode}
40 {
41   char beam[MAXCHAR] = "\0";
42   aperture_conf *config;
43   int i, ix;
44   gsl_vector *v;
45 
46   struct CfgStrings AperConfig[] = {
47     {"INSTRUMENT", NULL},
48     {"CAMERA", NULL},
49     {"SCIENCE_EXT", NULL},
50     {"ERRORS_EXT", NULL},
51     {"DQ_EXT",NULL},
52     {"DQMASK",NULL},
53     {"EXPTIME",NULL},
54     {"GAIN",NULL},
55     {"OPTKEY1",NULL},
56     {"OPTVAL1",NULL},
57     {"FFNAME",NULL},
58     {"REFX",NULL},
59     {"REFY",NULL},
60     /* aXe1.4:*/
61     {"DRZRESOLA",NULL},
62     {"DRZSCALE",NULL},
63     {"DRZLAMB0",NULL},
64     {"DRZXINI",NULL},
65     {"DRZPFRAC",NULL},
66     {"DRZKERNEL",NULL},
67     /* aXe1.5: */
68     {"PSFCOEFFS",NULL},
69     {"PSFRANGE",NULL},
70     {"RDNOISE",NULL},
71     /* NICMOS HLA */
72     {"IPIXFUNCTION",NULL},
73     {"POBJSIZE",NULL},
74     {"SMFACTOR",NULL},
75 
76     {NULL, NULL},
77     {NULL, NULL}                /* array terminator. REQUIRED !!! */
78   };
79 
80   struct CfgStrings BeamConfig[] = {
81     {NULL, NULL},
82     {NULL, NULL}
83   };
84 
85   AperConfig[25].name = beam;
86   BeamConfig[0].name = beam;
87 
88 
89   config = malloc (sizeof (aperture_conf));
90   if (config == NULL)
91     {
92       aXe_message (aXe_M_FATAL, __FILE__, __LINE__,
93                    "Could not allocate memory for aperture configuration");
94     }
95 
96   CfgRead (filename, AperConfig);
97 
98   /* Initialize optional keywords to default values*/
99   sprintf(config->instrument,"None");
100   sprintf(config->camera,"None");
101   sprintf(config->science_ext,"None");
102   sprintf(config->errors_ext,"None");
103   sprintf(config->dq_ext,"None");
104   sprintf(config->exptimekey,"None");
105   sprintf(config->gainkey,"None");
106   config->dqmask=0;
107   sprintf(config->optkey1,"None");
108   sprintf(config->optval1,"None");
109   sprintf(config->FFname,"None");
110   sprintf(config->IPIXfunc,"None");
111   sprintf(config->drz_kernel,"square");
112   config->refx       = 0;
113   config->refy       = 0;
114   config->drz_resol  = 0.0;
115   config->drz_scale  = 0.0;
116   config->drz_lamb0  = 0.0;
117   config->drz_xstart = 15.0;
118   config->drz_pfrac  = 1.0;
119   config->psfcoeffs  = NULL;
120   config->psfrange   = NULL;
121   config->rdnoise    = 0.0;
122   config->pobjsize   = -1.0;
123   config->smfactor   = -1.0;
124 
125   for (ix = 0; ix < 26; ix++)
126     {
127 
128       /* Name of the instrument */
129       if (!strcmp (AperConfig[ix].name, "INSTRUMENT"))
130         {
131           if (AperConfig[ix].data == NULL)
132             aXe_message (aXe_M_FATAL, __FILE__, __LINE__,
133                          "INSTRUMENT tag was not read from %s\n",
134                          filename);
135           sprintf (config->instrument, "%s", AperConfig[ix].data);
136         }
137 
138       /* Name of the camera */
139       if (!strcmp (AperConfig[ix].name, "CAMERA"))
140         {
141           if (AperConfig[ix].data == NULL)
142             aXe_message (aXe_M_FATAL, __FILE__, __LINE__,
143                          "camera tag was not read from %s\n",
144                          filename);
145           sprintf (config->camera, "%s", AperConfig[ix].data);
146         }
147 
148       /* Name of the Science data extension */
149       if (!strcmp (AperConfig[ix].name, "SCIENCE_EXT"))
150         {
151           if (AperConfig[ix].data != NULL)
152             sprintf (config->science_ext, "%s", AperConfig[ix].data);
153         }
154 
155       /* Name of the optional Error FITS extension */
156       if (!strcmp (AperConfig[ix].name, "ERRORS_EXT"))
157         {
158           if (AperConfig[ix].data != NULL)
159             {
160               sprintf (config->errors_ext, "%s", AperConfig[ix].data);
161             }
162         }
163 
164       /* Name of the optional Data Quality FITS extension */
165       if (!strcmp (AperConfig[ix].name, "DQ_EXT"))
166         {
167           if (AperConfig[ix].data != NULL)
168             {
169               sprintf (config->dq_ext, "%s", AperConfig[ix].data);
170             }
171         }
172 
173       /* Name of the optional EXPTIME FITS keyword */
174       if (!strcmp (AperConfig[ix].name, "EXPTIME"))
175         {
176           if (AperConfig[ix].data != NULL)
177             {
178               sprintf (config->exptimekey, "%s", AperConfig[ix].data);
179             }
180         }
181 
182       /* Red in the readout noise */
183       if (!strcmp (AperConfig[ix].name, "RDNOISE"))
184         {
185           if (AperConfig[ix].data != NULL)
186             {
187               config->rdnoise = atof(AperConfig[ix].data);
188             }
189         }
190 
191       /* Name of the optional GAIN FITS keyword */
192       if (!strcmp (AperConfig[ix].name, "GAIN"))
193         {
194           if (AperConfig[ix].data != NULL)
195             {
196               sprintf (config->gainkey, "%s", AperConfig[ix].data);
197             }
198         }
199 
200       /* Gett the Data Quality Mask */
201       if (!strcmp (AperConfig[ix].name, "DQMASK"))
202         {
203           if (AperConfig[ix].data != NULL)
204             {
205               config->dqmask = atoi(AperConfig[ix].data);
206             }
207         }
208 
209 
210       /* Optional OPTional 1st FITS keyword selection */
211       if (!strcmp (AperConfig[ix].name, "OPTKEY1"))
212         {
213           if (AperConfig[ix].data != NULL)
214             {
215               sprintf (config->optkey1, "%s", AperConfig[ix].data);
216             }
217         }
218 
219       /* Optional OPTional 1st FITS keyword value */
220       if (!strcmp (AperConfig[ix].name, "OPTVAL1"))
221         {
222           if (AperConfig[ix].data != NULL)
223             {
224               sprintf (config->optval1, "%s", AperConfig[ix].data);
225             }
226         }
227 
228       /* Optional FFname keyword value */
229       if (!strcmp (AperConfig[ix].name, "FFNAME"))
230         {
231           if (AperConfig[ix].data != NULL)
232             {
233               sprintf (config->FFname, "%s", AperConfig[ix].data);
234             }
235         }
236 
237       /* Optional intra pixel correction keyword value */
238       if (!strcmp (AperConfig[ix].name, "IPIXFUNCTION"))
239         {
240           if (AperConfig[ix].data != NULL)
241             {
242               sprintf (config->IPIXfunc, "%s", AperConfig[ix].data);
243             }
244         }
245 
246       /* Optional REFX keyword value */
247       if (!strcmp (AperConfig[ix].name, "REFX"))
248         {
249           if (AperConfig[ix].data != NULL)
250             {
251               config->refx = atoi(AperConfig[ix].data);
252             }
253         }
254 
255       /* Optional REFY keyword value */
256       if (!strcmp (AperConfig[ix].name, "REFY"))
257         {
258           if (AperConfig[ix].data != NULL)
259             {
260               config->refy = atoi(AperConfig[ix].data);
261             }
262         }
263       if (!strcmp (AperConfig[ix].name, "DRZRESOLA"))
264         {
265           if (AperConfig[ix].data != NULL)
266             {
267               config->drz_resol = atof(AperConfig[ix].data);
268             }
269         }
270       if (!strcmp (AperConfig[ix].name, "DRZSCALE"))
271         {
272           if (AperConfig[ix].data != NULL)
273             {
274               config->drz_scale = atof(AperConfig[ix].data);
275             }
276         }
277       if (!strcmp (AperConfig[ix].name, "DRZLAMB0"))
278         {
279           if (AperConfig[ix].data != NULL)
280             {
281               config->drz_lamb0 = atof(AperConfig[ix].data);
282             }
283         }
284       if (!strcmp (AperConfig[ix].name, "DRZXINI"))
285         {
286           if (AperConfig[ix].data != NULL)
287             {
288               config->drz_xstart = atof(AperConfig[ix].data);
289             }
290         }
291       if (!strcmp (AperConfig[ix].name, "DRZPFRAC"))
292         {
293           if (AperConfig[ix].data != NULL)
294             {
295               config->drz_pfrac = atof(AperConfig[ix].data);
296             }
297         }
298       if (!strcmp (AperConfig[ix].name, "DRZKERNEL"))
299         {
300           if (AperConfig[ix].data != NULL)
301             {
302               sprintf (config->drz_kernel, "%s", AperConfig[ix].data);
303             }
304         }
305 
306       if (!strcmp (AperConfig[ix].name, "PSFCOEFFS"))
307         {
308           if (AperConfig[ix].data != NULL)
309             {
310               //              sprintf (config->drz_kernel, "%s", AperConfig[ix].d
      ata);
311               v = string_to_gsl_array (AperConfig[ix].data);
312               config->psfcoeffs = v;
313             }
314         }
315 
316       if (!strcmp (AperConfig[ix].name, "PSFRANGE"))
317         {
318           if (AperConfig[ix].data != NULL)
319             {
320               v = string_to_gsl_array (AperConfig[ix].data);
321               if (v->size != 2)
322                 aXe_message (aXe_M_FATAL, __FILE__, __LINE__,
323                              "configuration file: two items for PSFRANGE, lambda_
      min and lambda_max must be given, not %i\n", v->size);
324               config->psfrange = v;
325             }
326         }
327 
328       // read in the size of point-like objects
329       if (!strcmp (AperConfig[ix].name, "POBJSIZE"))
330         {
331           if (AperConfig[ix].data != NULL)
332             {
333               config->pobjsize = atof(AperConfig[ix].data);
334             }
335         }
336 
337       // read in the adjustment for smoothed flux conversion
338       if (!strcmp (AperConfig[ix].name, "SMFACTOR"))
339         {
340           if (AperConfig[ix].data != NULL)
341             {
342               config->smfactor = atof(AperConfig[ix].data);
343             }
344         }
345 
346 
347     }
348 
349   // release memory
350   i=0;
351   while(AperConfig[i].name!=NULL)
352     free(AperConfig[i++].data);
353 
354   /* Looking for up to MAX_BEAMS beams */
355   config->nbeams = 0;
356   for (i = 0; i < MAX_BEAMS; i++)
357     {
358       sprintf (beam, "BEAM%c", BEAM (i));
359       CfgRead (filename, BeamConfig);
360       if (BeamConfig[0].data != NULL)
361         {
362           v = string_to_gsl_array (BeamConfig[0].data);
363           if (v->size != 2)
364             {
365               aXe_message (aXe_M_FATAL, __FILE__, __LINE__,
366                            "tag %s does not have the proper format in file %s.\n"
      
367                            "Should be of the form %s [integer] [integer]\n",
368                            BeamConfig[0].data, filename,beam);
369               //                           beam, filename,beam);
370             }
371           (config->beam[config->nbeams]).offset.dx0 =
372             (int) gsl_vector_get (v, 0);
373           (config->beam[config->nbeams]).offset.dx1 =
374             (int) gsl_vector_get (v, 1);
375 
376           // release the memory
377           gsl_vector_free(v);
378 
379           (config->beam[config->nbeams]).ID = i;
380 
381           // release memory
382           ix=0;
383           while(BeamConfig[ix].name!=NULL)
384             free(BeamConfig[ix++].data);
385           BeamConfig[0].data = NULL;
386 
387           (config->beam[config->nbeams]).mmag_extract = get_beam_mmag_extract (fi
      lename, i);
388           (config->beam[config->nbeams]).mmag_mark = get_beam_mmag_mark (filename
      , i);
389 
390           sprintf (beam, "PSF_OFFSET_%c", BEAM (i));
391           CfgRead (filename, BeamConfig);
392           if (BeamConfig[0].data != NULL)
393             {
394               (config->beam[config->nbeams]).psf_offset = atof(BeamConfig[0].
      data);
395             }
396           else
397             {
398               (config->beam[config->nbeams]).psf_offset = 0.0;
399             }
400 
401           // release memory
402           ix=0;
403           while(BeamConfig[ix].name!=NULL)
404             free(BeamConfig[ix++].data);
405 
406           BeamConfig[0].data = NULL;
407 
408           config->nbeams = config->nbeams + 1;
409         }
410     }
411 
412   if (config->nbeams == 0)
413     {
414       aXe_message (aXe_M_FATAL, __FILE__, __LINE__,
415                    "No beam was found in %s. At least one beam must be found.\n",
      
416                    filename);
417     }
418   return config;
419 }
\end{DoxyCode}
\hypertarget{aper__conf_8c_aa1383c872a0151435880f6ad28f9bd88}{
\index{aper\_\-conf.c@{aper\_\-conf.c}!get\_\-extension\_\-numbers@{get\_\-extension\_\-numbers}}
\index{get\_\-extension\_\-numbers@{get\_\-extension\_\-numbers}!aper_conf.c@{aper\_\-conf.c}}
\subsubsection[{get\_\-extension\_\-numbers}]{\setlength{\rightskip}{0pt plus 5cm}void get\_\-extension\_\-numbers (char {\em filename}\mbox{[}$\,$\mbox{]}, \/  {\bf aperture\_\-conf} $\ast$ {\em conf}, \/  char {\em keyword}\mbox{[}$\,$\mbox{]}, \/  char {\em keyval}\mbox{[}$\,$\mbox{]})}}
\label{aper__conf_8c_aa1383c872a0151435880f6ad28f9bd88}
Function: get\_\-extension\_\-numbers This function assigns HDU numbers to an \hyperlink{structaperture__conf}{aperture\_\-conf} structues after looking for the location of named extension in a given FITS file. Optional values not found are set to -\/1.

Parameters: 
\begin{DoxyParams}{Parameters}
\item[{\em filename}]-\/ a pointer to a string containing the name of an existing FITS file \item[{\em conf}]-\/ a pointer to a populated \hyperlink{structaperture__conf}{aperture\_\-conf} structure \item[{\em keyword}]-\/ a pointer to a string containing the name of an optional keyword to read \item[{\em keyval}]-\/ a pointer to a string containing the value of the optional keyword to look for \end{DoxyParams}



\begin{DoxyCode}
481 {
482   int extver = -1;
483 
484   conf->science_numext = get_hdunum_from_hduname(filename,
485                                                  conf->science_ext,keyword
486                                                  ,keyval,extver);
487   if (conf->science_numext > -1)
488     extver = (int)get_float_from_keyword(filename, conf->science_numext, "EXTVER"
      );
489 
490   if (strcmp(conf->errors_ext,"None"))
491   {
492     conf->errors_numext = get_hdunum_from_hduname(filename,
493                                                   conf->errors_ext,keyword,
494                                                   keyval,extver);
495   } else {
496     conf->errors_numext = -1;
497   }
498   if (strcmp(conf->dq_ext,"None")) {
499     conf->dq_numext = get_hdunum_from_hduname(filename,conf->dq_ext,
500                                               keyword,keyval,extver);
501   } else {
502     conf->dq_numext = -1;
503   }
504 }
\end{DoxyCode}
\hypertarget{aper__conf_8c_a63e3b3bf0beebc0fe4677687d96b85df}{
\index{aper\_\-conf.c@{aper\_\-conf.c}!get\_\-max\_\-offset@{get\_\-max\_\-offset}}
\index{get\_\-max\_\-offset@{get\_\-max\_\-offset}!aper_conf.c@{aper\_\-conf.c}}
\subsubsection[{get\_\-max\_\-offset}]{\setlength{\rightskip}{0pt plus 5cm}double get\_\-max\_\-offset ({\bf aperture\_\-conf} $\ast$ {\em conf})}}
\label{aper__conf_8c_a63e3b3bf0beebc0fe4677687d96b85df}
Function: get\_\-psf\_\-offset The function extracts and returns the psf-\/offset stored in a given configuration structure and a given \hyperlink{structbeam}{beam}

Parameters: 
\begin{DoxyParams}{Parameters}
\item[{\em conf}]-\/ the configuration structure \item[{\em \hyperlink{structbeam}{beam}}]-\/ the \hyperlink{structbeam}{beam}\end{DoxyParams}
Returns: \begin{DoxyReturn}{Returns}
psf\_\-offset -\/ the psf-\/offset for the \hyperlink{structbeam}{beam} 
\end{DoxyReturn}



\begin{DoxyCode}
576 {
577   // initialize the offset
578   double max_offset=0.0;
579 
580   int i=0;
581 
582   // go over all beams in the configuration structure
583   for (i = 0; i < conf->nbeams; i++)
584     {
585       // check whether the current beam is the
586       // right one
587       max_offset = MAX(conf->beam[i].psf_offset, max_offset);
588     }
589 
590   // return the default offset
591   return max_offset;
592 }
\end{DoxyCode}
\hypertarget{aper__conf_8c_a8164c87851c09beb885a55483557a0f2}{
\index{aper\_\-conf.c@{aper\_\-conf.c}!get\_\-psf\_\-offset@{get\_\-psf\_\-offset}}
\index{get\_\-psf\_\-offset@{get\_\-psf\_\-offset}!aper_conf.c@{aper\_\-conf.c}}
\subsubsection[{get\_\-psf\_\-offset}]{\setlength{\rightskip}{0pt plus 5cm}double get\_\-psf\_\-offset ({\bf aperture\_\-conf} $\ast$ {\em conf}, \/  const {\bf beam} {\em actbeam})}}
\label{aper__conf_8c_a8164c87851c09beb885a55483557a0f2}
Function: get\_\-psf\_\-offset The function extracts and returns the psf-\/offset stored in a given configuration structure and a given \hyperlink{structbeam}{beam}

Parameters: 
\begin{DoxyParams}{Parameters}
\item[{\em conf}]-\/ the configuration structure \item[{\em \hyperlink{structbeam}{beam}}]-\/ the \hyperlink{structbeam}{beam}\end{DoxyParams}
Returns: \begin{DoxyReturn}{Returns}
psf\_\-offset -\/ the psf-\/offset for the \hyperlink{structbeam}{beam} 
\end{DoxyReturn}



\begin{DoxyCode}
541 {
542   // initialize the offset
543   double psf_offset=0.0;
544 
545   int i=0;
546 
547   // go over all beams in the configuration structure
548   for (i = 0; i < conf->nbeams; i++)
549     {
550       // check whether the current beam is the
551       // right one
552       if (conf->beam[i].ID == actbeam.ID)
553         // return the offset
554         return conf->beam[i].psf_offset;
555     }
556 
557   // return the default offset
558   return psf_offset;
559 }
\end{DoxyCode}
