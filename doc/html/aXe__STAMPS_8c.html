<!-- This comment will put IE 6, 7 and 8 in quirks mode -->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>TIPS: /renoir/fourmano/Desktop/OUSIM/TIPS/branches/tips_build/src/axesim/aXe_STAMPS.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javaScript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body onload='searchBox.OnSelectItem(0);'>
<!-- Generated by Doxygen 1.6.1 -->
<script type="text/javascript"><!--
var searchBox = new SearchBox("searchBox", "search",false,'Search');
--></script>
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Data&nbsp;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <img id="MSearchSelect" src="search/search.png"
             onmouseover="return searchBox.OnSearchSelectShow()"
             onmouseout="return searchBox.OnSearchSelectHide()"
             alt=""/>
        <input type="text" id="MSearchField" value="Search" accesskey="S"
             onfocus="searchBox.OnSearchFieldFocus(true)" 
             onblur="searchBox.OnSearchFieldFocus(false)" 
             onkeyup="searchBox.OnSearchFieldChange(event)"/>
        <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
        </div>
      </li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="files.html"><span>File&nbsp;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
</div>
<div class="contents">
<h1>/renoir/fourmano/Desktop/OUSIM/TIPS/branches/tips_build/src/axesim/aXe_STAMPS.c File Reference</h1><code>#include &lt;stdio.h&gt;</code><br/>
<code>#include &lt;stdlib.h&gt;</code><br/>
<code>#include &lt;string.h&gt;</code><br/>
<code>#include &lt;math.h&gt;</code><br/>
<code>#include &quot;<a class="el" href="aXe__grism_8h_source.html">aXe_grism.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="aXe__utils_8h_source.html">aXe_utils.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="spce__PET_8h_source.html">spce_PET.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="inout__aper_8h_source.html">inout_aper.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="trace__conf_8h_source.html">trace_conf.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="aper__conf_8h_source.html">aper_conf.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="spc__sex_8h_source.html">spc_sex.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="disp__conf_8h_source.html">disp_conf.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="spc__wl__calib_8h_source.html">spc_wl_calib.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="spce__binning_8h_source.html">spce_binning.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="spc__spc_8h_source.html">spc_spc.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="spc__FITScards_8h_source.html">spc_FITScards.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="spce__output_8h_source.html">spce_output.h</a>&quot;</code><br/>
<table border="0" cellpadding="0" cellspacing="0">
<tr><td colspan="2"><h2>Defines</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="aXe__STAMPS_8c.html#a7a38b874452a6cde6ebee9e98c980eef">AXE_IMAGE_PATH</a>&nbsp;&nbsp;&nbsp;&quot;AXE_IMAGE_PATH&quot;</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="aXe__STAMPS_8c.html#a75c154942e560254898bcafaf48bdf3d">AXE_OUTPUT_PATH</a>&nbsp;&nbsp;&nbsp;&quot;AXE_OUTPUT_PATH&quot;</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="aXe__STAMPS_8c.html#a0b0be957330d9c69fa325ee014ce4dad">AXE_CONFIG_PATH</a>&nbsp;&nbsp;&nbsp;&quot;AXE_CONFIG_PATH&quot;</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="aXe__STAMPS_8c.html#a387b2332dae116e8d0c1f8e489bc9057">AXE_DRIZZLE_PATH</a>&nbsp;&nbsp;&nbsp;&quot;AXE_DRIZZLE_PATH&quot;</td></tr>
<tr><td colspan="2"><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="aXe__STAMPS_8c.html#a0ddf1224851353fc92bfbff6f499fa97">main</a> (int argc, char *argv[])</td></tr>
</table>
<hr/><h2>Define Documentation</h2>
<a class="anchor" id="a0b0be957330d9c69fa325ee014ce4dad"></a><!-- doxytag: member="aXe_STAMPS.c::AXE_CONFIG_PATH" ref="a0b0be957330d9c69fa325ee014ce4dad" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define AXE_CONFIG_PATH&nbsp;&nbsp;&nbsp;&quot;AXE_CONFIG_PATH&quot;</td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="a387b2332dae116e8d0c1f8e489bc9057"></a><!-- doxytag: member="aXe_STAMPS.c::AXE_DRIZZLE_PATH" ref="a387b2332dae116e8d0c1f8e489bc9057" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define AXE_DRIZZLE_PATH&nbsp;&nbsp;&nbsp;&quot;AXE_DRIZZLE_PATH&quot;</td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="a7a38b874452a6cde6ebee9e98c980eef"></a><!-- doxytag: member="aXe_STAMPS.c::AXE_IMAGE_PATH" ref="a7a38b874452a6cde6ebee9e98c980eef" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define AXE_IMAGE_PATH&nbsp;&nbsp;&nbsp;&quot;AXE_IMAGE_PATH&quot;</td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="a75c154942e560254898bcafaf48bdf3d"></a><!-- doxytag: member="aXe_STAMPS.c::AXE_OUTPUT_PATH" ref="a75c154942e560254898bcafaf48bdf3d" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define AXE_OUTPUT_PATH&nbsp;&nbsp;&nbsp;&quot;AXE_OUTPUT_PATH&quot;</td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<hr/><h2>Function Documentation</h2>
<a class="anchor" id="a0ddf1224851353fc92bfbff6f499fa97"></a><!-- doxytag: member="aXe_STAMPS.c::main" ref="a0ddf1224851353fc92bfbff6f499fa97" args="(int argc, char *argv[])" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int main </td>
          <td>(</td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>argc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&nbsp;</td>
          <td class="paramname"> <em>argv</em>[]</td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p><div class="fragment"><pre class="fragment"><a name="l00048"></a>00048 {
<a name="l00049"></a>00049   <span class="keywordtype">char</span> *opt;
<a name="l00050"></a>00050   <span class="keywordtype">char</span> aper_file[<a class="code" href="aXe__grism_8h.html#ac1535592e39e7edf0cafbd5e695ea622">MAXCHAR</a>];
<a name="l00051"></a>00051   <span class="keywordtype">char</span> aper_file_path[<a class="code" href="aXe__grism_8h.html#ac1535592e39e7edf0cafbd5e695ea622">MAXCHAR</a>];
<a name="l00052"></a>00052 
<a name="l00053"></a>00053   <span class="keywordtype">char</span> conf_file[<a class="code" href="aXe__grism_8h.html#ac1535592e39e7edf0cafbd5e695ea622">MAXCHAR</a>];
<a name="l00054"></a>00054   <span class="keywordtype">char</span> conf_file_path[<a class="code" href="aXe__grism_8h.html#ac1535592e39e7edf0cafbd5e695ea622">MAXCHAR</a>];
<a name="l00055"></a>00055 
<a name="l00056"></a>00056   <span class="keywordtype">char</span> grism_file[<a class="code" href="aXe__grism_8h.html#ac1535592e39e7edf0cafbd5e695ea622">MAXCHAR</a>];
<a name="l00057"></a>00057   <span class="keywordtype">char</span> grism_file_path[<a class="code" href="aXe__grism_8h.html#ac1535592e39e7edf0cafbd5e695ea622">MAXCHAR</a>];
<a name="l00058"></a>00058 
<a name="l00059"></a>00059   <span class="keywordtype">char</span> PET_file[<a class="code" href="aXe__grism_8h.html#ac1535592e39e7edf0cafbd5e695ea622">MAXCHAR</a>];
<a name="l00060"></a>00060   <span class="keywordtype">char</span> PET_file_path[<a class="code" href="aXe__grism_8h.html#ac1535592e39e7edf0cafbd5e695ea622">MAXCHAR</a>];
<a name="l00061"></a>00061 
<a name="l00062"></a>00062   <span class="comment">//  char outputroot[MAXCHAR];</span>
<a name="l00063"></a>00063   <span class="comment">//  char outputroot_path[MAXCHAR];</span>
<a name="l00064"></a>00064   <span class="keywordtype">char</span> STP_file[<a class="code" href="aXe__grism_8h.html#ac1535592e39e7edf0cafbd5e695ea622">MAXCHAR</a>];
<a name="l00065"></a>00065   <span class="keywordtype">char</span> STP_file_path[<a class="code" href="aXe__grism_8h.html#ac1535592e39e7edf0cafbd5e695ea622">MAXCHAR</a>];
<a name="l00066"></a>00066 
<a name="l00067"></a>00067   <span class="comment">//  char output_path[MAXCHAR];</span>
<a name="l00068"></a>00068 
<a name="l00069"></a>00069   <a class="code" href="structaperture__conf.html">aperture_conf</a> *conf;
<a name="l00070"></a>00070 
<a name="l00071"></a>00071   <span class="keywordtype">object</span> **oblist;
<a name="l00072"></a>00072   <a class="code" href="structobservation.html">observation</a> *obs;
<a name="l00073"></a>00073 
<a name="l00074"></a>00074   <a class="code" href="structap__pixel.html">ap_pixel</a> *PET;
<a name="l00075"></a>00075 
<a name="l00076"></a>00076   <span class="keywordtype">int</span> index, i;
<a name="l00077"></a>00077   <span class="keywordtype">char</span> label[<a class="code" href="aXe__grism_8h.html#ac1535592e39e7edf0cafbd5e695ea622">MAXCHAR</a>];
<a name="l00078"></a>00078 
<a name="l00079"></a>00079   fitsfile *PET_ptr, *STP_ptr;
<a name="l00080"></a>00080   <span class="keywordtype">int</span> f_status = 0;
<a name="l00081"></a>00081 
<a name="l00082"></a>00082   <span class="keywordtype">int</span> aperID, beamID, objindex;
<a name="l00083"></a>00083   <a class="code" href="structFITScards.html">FITScards</a> *cards;
<a name="l00084"></a>00084   <a class="code" href="structFITScards.html">FITScards</a> *xymin_cards;
<a name="l00085"></a>00085 
<a name="l00086"></a>00086   <a class="code" href="aXe__grism_8h.html#a6117e17bb3108107676f4486e62d40e5">gsl_matrix</a> *rstamp;
<a name="l00087"></a>00087   <a class="code" href="structdrzstamp.html">drzstamp</a> *drzstmp;
<a name="l00088"></a>00088   <a class="code" href="structdrzstamp__dim.html">drzstamp_dim</a> dim;
<a name="l00089"></a>00089 
<a name="l00090"></a>00090   <span class="keywordtype">int</span> rectified = 0;
<a name="l00091"></a>00091   <span class="comment">//int drizzled = 0;</span>
<a name="l00092"></a>00092   <span class="keywordtype">int</span> drizzle=0;
<a name="l00093"></a>00093   <span class="keywordtype">int</span> <a class="code" href="structdrzstamp.html">drzstamp</a>=0;
<a name="l00094"></a>00094   <span class="keywordtype">int</span> for_grism=0;
<a name="l00095"></a>00095 
<a name="l00096"></a>00096   <a class="code" href="structd__point.html">d_point</a> stp_min;
<a name="l00097"></a>00097 
<a name="l00098"></a>00098   <span class="keywordflow">if</span> ((argc &lt; 3) || (opt = <a class="code" href="aXe__utils_8c.html#a831cd1049c0c8b8e918404c5035d5411">get_online_option</a> (<span class="stringliteral">&quot;help&quot;</span>, argc, argv)))
<a name="l00099"></a>00099     {
<a name="l00100"></a>00100       fprintf (stdout,
<a name="l00101"></a>00101                <span class="stringliteral">&quot;ST-ECF European Coordinating Facility\n&quot;</span>
<a name="l00102"></a>00102                <span class="stringliteral">&quot;aXe_STAMPS Version %s:\n&quot;</span>
<a name="l00103"></a>00103                <span class="stringliteral">&quot;           Task that generates some Postscript stamp images from the\n&quot;</span>
<a name="l00104"></a>00104                <span class="stringliteral">&quot;           content of a Pixel Extraction Table (PET)\n&quot;</span>
<a name="l00105"></a>00105                <span class="stringliteral">&quot;           The trace is overplotted and is generated from the group\n&quot;</span>
<a name="l00106"></a>00106                <span class="stringliteral">&quot;           of pixels in the PET which have the smallest projected distance\n&quot;</span>
<a name="l00107"></a>00107                <span class="stringliteral">&quot;           to the trace in the PET. No analytical a-priori trace function \n&quot;</span>
<a name="l00108"></a>00108                <span class="stringliteral">&quot;           is used.\n&quot;</span>
<a name="l00109"></a>00109                <span class="stringliteral">&quot;\n&quot;</span>
<a name="l00110"></a>00110                <span class="stringliteral">&quot;Usage:\n&quot;</span>
<a name="l00111"></a>00111                <span class="stringliteral">&quot;      aXe_STAMPS g/prism_filename configuration_filename [options]\n&quot;</span>
<a name="l00112"></a>00112                <span class="stringliteral">&quot;\n&quot;</span>
<a name="l00113"></a>00113                <span class="stringliteral">&quot;Options:\n&quot;</span>
<a name="l00114"></a>00114                <span class="stringliteral">&quot;      -rectified            - produces rectified stamp image following the\n&quot;</span>
<a name="l00115"></a>00115                <span class="stringliteral">&quot;                              direction of the extraction process\n&quot;</span>
<a name="l00116"></a>00116                <span class="stringliteral">&quot;      -drz                  - use $AXE_DRIZZLE_PATH to locate the grism-, OAF-\n&quot;</span>
<a name="l00117"></a>00117                <span class="stringliteral">&quot;                              and PET-files instead of $AXE_IMAGE/OUTPUT_PATH\n&quot;</span>
<a name="l00118"></a>00118                <span class="stringliteral">&quot;      -in_AF=[string]       - overwrite the automatically generated name\n&quot;</span>
<a name="l00119"></a>00119                <span class="stringliteral">&quot;                              of the input aperture file\n&quot;</span>
<a name="l00120"></a>00120                <span class="stringliteral">&quot;      -in_PET=[string]      - overwrite the automatically generated name\n&quot;</span>
<a name="l00121"></a>00121                <span class="stringliteral">&quot;                              of the input PET file\n&quot;</span>
<a name="l00122"></a>00122                <span class="stringliteral">&quot;      -out_STP=[string]     - overwrite the automatically generated name\n&quot;</span>
<a name="l00123"></a>00123                <span class="stringliteral">&quot;                              of the output stamp FITS image\n&quot;</span>
<a name="l00124"></a>00124                <span class="stringliteral">&quot;\n&quot;</span>,<a class="code" href="aXe__grism_8h.html#a5bd9a30fc22d9a737ee060d41a4ec479">RELEASE</a>);
<a name="l00125"></a>00125       exit (1);
<a name="l00126"></a>00126     }
<a name="l00127"></a>00127 
<a name="l00128"></a>00128   fprintf (stdout, <span class="stringliteral">&quot;aXe_STAMPS: Starting...\n&quot;</span>);
<a name="l00129"></a>00129 
<a name="l00130"></a>00130   index = 0;
<a name="l00131"></a>00131   strcpy (grism_file, argv[++index]);
<a name="l00132"></a>00132   <span class="keywordflow">if</span> ((opt = <a class="code" href="aXe__utils_8c.html#a831cd1049c0c8b8e918404c5035d5411">get_online_option</a> (<span class="stringliteral">&quot;drz&quot;</span>, argc, argv))){
<a name="l00133"></a>00133     <a class="code" href="aXe__utils_8c.html#a4f0ee2e065affb06ef1b8669d2b1029c">build_path</a> (<a class="code" href="aXe__PET2SPC_8c.html#a387b2332dae116e8d0c1f8e489bc9057">AXE_DRIZZLE_PATH</a>, grism_file, grism_file_path);
<a name="l00134"></a>00134     drizzle=1;
<a name="l00135"></a>00135   }
<a name="l00136"></a>00136   <span class="keywordflow">else</span>{
<a name="l00137"></a>00137     <a class="code" href="aXe__utils_8c.html#a4f0ee2e065affb06ef1b8669d2b1029c">build_path</a> (<a class="code" href="aXe__AF2PET_8c.html#a7a38b874452a6cde6ebee9e98c980eef">AXE_IMAGE_PATH</a>, grism_file, grism_file_path);
<a name="l00138"></a>00138     drizzle=0;
<a name="l00139"></a>00139   }
<a name="l00140"></a>00140 
<a name="l00141"></a>00141   strcpy (conf_file, argv[++index]);
<a name="l00142"></a>00142   <a class="code" href="aXe__utils_8c.html#a4f0ee2e065affb06ef1b8669d2b1029c">build_path</a> (<a class="code" href="aXe__AF2PET_8c.html#a0b0be957330d9c69fa325ee014ce4dad">AXE_CONFIG_PATH</a>, conf_file, conf_file_path);
<a name="l00143"></a>00143 
<a name="l00144"></a>00144 
<a name="l00145"></a>00145   conf = <a class="code" href="aper__conf_8c.html#a45d84f2fc00f438b5da9054c45b7736c">get_aperture_descriptor</a> (conf_file_path);
<a name="l00146"></a>00146 
<a name="l00147"></a>00147   <span class="comment">/* Determine where the various extensions are in the FITS file */</span>
<a name="l00148"></a>00148   <a class="code" href="aper__conf_8c.html#aa1383c872a0151435880f6ad28f9bd88">get_extension_numbers</a>(grism_file_path, conf,conf-&gt;<a class="code" href="structaperture__conf.html#a730cc39bb91c34d0dfe92977cb2aaf46">optkey1</a>,conf-&gt;<a class="code" href="structaperture__conf.html#a6b84a9e8edd79d020ea2e189839d86ba">optval1</a>);
<a name="l00149"></a>00149 
<a name="l00150"></a>00150   <span class="comment">/* Build aperture file name */</span>
<a name="l00151"></a>00151   <span class="keywordflow">if</span> ((opt = <a class="code" href="aXe__utils_8c.html#a831cd1049c0c8b8e918404c5035d5411">get_online_option</a>(<span class="stringliteral">&quot;in_AF&quot;</span>, argc, argv))){
<a name="l00152"></a>00152     <span class="comment">/* get it */</span>
<a name="l00153"></a>00153     strcpy (aper_file, opt);
<a name="l00154"></a>00154     strcpy (aper_file_path, opt);
<a name="l00155"></a>00155   }
<a name="l00156"></a>00156   <span class="keywordflow">else</span> {
<a name="l00157"></a>00157     <a class="code" href="aXe__utils_8c.html#a94637b37589d1f9b3c9418d620156519">replace_file_extension</a> (grism_file, aper_file, <span class="stringliteral">&quot;.fits&quot;</span>,
<a name="l00158"></a>00158                             <span class="stringliteral">&quot;.OAF&quot;</span>, conf-&gt;<a class="code" href="structaperture__conf.html#abe36ba97113a8ccb1916acdbe5db113f">science_numext</a>);
<a name="l00159"></a>00159     <span class="keywordflow">if</span> (drizzle)
<a name="l00160"></a>00160       <a class="code" href="aXe__utils_8c.html#a4f0ee2e065affb06ef1b8669d2b1029c">build_path</a> (<a class="code" href="aXe__PET2SPC_8c.html#a387b2332dae116e8d0c1f8e489bc9057">AXE_DRIZZLE_PATH</a>, aper_file, aper_file_path);
<a name="l00161"></a>00161     <span class="keywordflow">else</span>
<a name="l00162"></a>00162       <a class="code" href="aXe__utils_8c.html#a4f0ee2e065affb06ef1b8669d2b1029c">build_path</a> (<a class="code" href="aXe__AF2PET_8c.html#a75c154942e560254898bcafaf48bdf3d">AXE_OUTPUT_PATH</a>, aper_file, aper_file_path);
<a name="l00163"></a>00163   }
<a name="l00164"></a>00164 
<a name="l00165"></a>00165   <span class="keywordflow">if</span> ((opt = <a class="code" href="aXe__utils_8c.html#a831cd1049c0c8b8e918404c5035d5411">get_online_option</a>(<span class="stringliteral">&quot;in_PET&quot;</span>, argc, argv))){
<a name="l00166"></a>00166     <span class="comment">/* get it */</span>
<a name="l00167"></a>00167     strcpy (PET_file, opt);
<a name="l00168"></a>00168     strcpy (PET_file_path, opt);
<a name="l00169"></a>00169   }
<a name="l00170"></a>00170   <span class="keywordflow">else</span>{
<a name="l00171"></a>00171     <span class="comment">/* Build object PET file name */</span>
<a name="l00172"></a>00172     <a class="code" href="aXe__utils_8c.html#a94637b37589d1f9b3c9418d620156519">replace_file_extension</a> (grism_file, PET_file, <span class="stringliteral">&quot;.fits&quot;</span>,
<a name="l00173"></a>00173                             <span class="stringliteral">&quot;.PET.fits&quot;</span>, conf-&gt;<a class="code" href="structaperture__conf.html#abe36ba97113a8ccb1916acdbe5db113f">science_numext</a>);
<a name="l00174"></a>00174     <span class="keywordflow">if</span> (drizzle)
<a name="l00175"></a>00175       <a class="code" href="aXe__utils_8c.html#a4f0ee2e065affb06ef1b8669d2b1029c">build_path</a> (<a class="code" href="aXe__PET2SPC_8c.html#a387b2332dae116e8d0c1f8e489bc9057">AXE_DRIZZLE_PATH</a>, PET_file, PET_file_path);
<a name="l00176"></a>00176     <span class="keywordflow">else</span>
<a name="l00177"></a>00177       <a class="code" href="aXe__utils_8c.html#a4f0ee2e065affb06ef1b8669d2b1029c">build_path</a> (<a class="code" href="aXe__AF2PET_8c.html#a75c154942e560254898bcafaf48bdf3d">AXE_OUTPUT_PATH</a>, PET_file, PET_file_path);
<a name="l00178"></a>00178   }
<a name="l00179"></a>00179 
<a name="l00180"></a>00180   <span class="keywordflow">if</span> ( (opt = <a class="code" href="aXe__utils_8c.html#a831cd1049c0c8b8e918404c5035d5411">get_online_option</a> (<span class="stringliteral">&quot;out_STP&quot;</span>, argc, argv)) )
<a name="l00181"></a>00181     {
<a name="l00182"></a>00182       strcpy (STP_file, opt);
<a name="l00183"></a>00183       <span class="comment">//      strcpy (STP_file_PATH, opt);</span>
<a name="l00184"></a>00184     }
<a name="l00185"></a>00185   <span class="keywordflow">else</span>
<a name="l00186"></a>00186     {
<a name="l00187"></a>00187       <span class="comment">//      replace_file_extension (PET_file, STP_file, &quot;.PET.fits&quot;, &quot;.STP.fits&quot;,-1);</span>
<a name="l00188"></a>00188       <a class="code" href="aXe__utils_8c.html#a94637b37589d1f9b3c9418d620156519">replace_file_extension</a> (grism_file, STP_file, <span class="stringliteral">&quot;.fits&quot;</span>, <span class="stringliteral">&quot;.STP.fits&quot;</span>,conf-&gt;<a class="code" href="structaperture__conf.html#abe36ba97113a8ccb1916acdbe5db113f">science_numext</a>);
<a name="l00189"></a>00189     }
<a name="l00190"></a>00190 
<a name="l00191"></a>00191 
<a name="l00192"></a>00192   <span class="keywordflow">if</span> (drizzle)
<a name="l00193"></a>00193     <a class="code" href="aXe__utils_8c.html#a4f0ee2e065affb06ef1b8669d2b1029c">build_path</a> (<a class="code" href="aXe__PET2SPC_8c.html#a387b2332dae116e8d0c1f8e489bc9057">AXE_DRIZZLE_PATH</a>, STP_file, STP_file_path);
<a name="l00194"></a>00194   <span class="keywordflow">else</span>
<a name="l00195"></a>00195     <a class="code" href="aXe__utils_8c.html#a4f0ee2e065affb06ef1b8669d2b1029c">build_path</a> (<a class="code" href="aXe__AF2PET_8c.html#a75c154942e560254898bcafaf48bdf3d">AXE_OUTPUT_PATH</a>, STP_file, STP_file_path);
<a name="l00196"></a>00196 
<a name="l00197"></a>00197   <span class="keywordflow">if</span> ((opt=<a class="code" href="aXe__utils_8c.html#a831cd1049c0c8b8e918404c5035d5411">get_online_option</a>(<span class="stringliteral">&quot;rectified&quot;</span>,argc,argv)))
<a name="l00198"></a>00198     rectified = 1;
<a name="l00199"></a>00199   <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((opt = <a class="code" href="aXe__utils_8c.html#a831cd1049c0c8b8e918404c5035d5411">get_online_option</a> (<span class="stringliteral">&quot;drzstamp&quot;</span>, argc, argv)))
<a name="l00200"></a>00200     drzstamp=1;
<a name="l00201"></a>00201 
<a name="l00202"></a>00202 
<a name="l00203"></a>00203   <span class="comment">// give feedback onto the screen:</span>
<a name="l00204"></a>00204   <span class="comment">// report on input and output</span>
<a name="l00205"></a>00205   <span class="comment">// and also on specific parameters</span>
<a name="l00206"></a>00206   fprintf (stdout, <span class="stringliteral">&quot;aXe_STAMPS: Input Image file name:               %s\n&quot;</span>,
<a name="l00207"></a>00207            grism_file_path);
<a name="l00208"></a>00208   fprintf (stdout, <span class="stringliteral">&quot;aXe_STAMPS: Input Aperture file name:            %s\n&quot;</span>,
<a name="l00209"></a>00209            aper_file_path);
<a name="l00210"></a>00210   fprintf (stdout, <span class="stringliteral">&quot;aXe_STAMPS: Input PET file name:                 %s\n&quot;</span>,
<a name="l00211"></a>00211            PET_file_path);
<a name="l00212"></a>00212   fprintf (stdout, <span class="stringliteral">&quot;aXe_STAMPS: Name of STP file :                   %s\n&quot;</span>,
<a name="l00213"></a>00213            STP_file_path);
<a name="l00214"></a>00214   <span class="keywordflow">if</span> (rectified)
<a name="l00215"></a>00215     fprintf (stdout, <span class="stringliteral">&quot;aXe_STAMPS: Producing rectified stamp images.\n&quot;</span>);
<a name="l00216"></a>00216   <span class="keywordflow">else</span> <span class="keywordflow">if</span> (drzstamp)
<a name="l00217"></a>00217     fprintf (stdout, <span class="stringliteral">&quot;aXe_STAMPS: Producing drizzled stamp images.\n&quot;</span>);
<a name="l00218"></a>00218   <span class="keywordflow">else</span>
<a name="l00219"></a>00219     fprintf (stdout, <span class="stringliteral">&quot;aXe_STAMPS: Producing trace stamp images.\n&quot;</span>);
<a name="l00220"></a>00220 
<a name="l00221"></a>00221 
<a name="l00222"></a>00222   <span class="comment">// Loading the object list</span>
<a name="l00223"></a>00223   obs = <a class="code" href="spc__utils_8c.html#ac89172f10962f24de5d0284500597c64">load_dummy_observation</a> ();
<a name="l00224"></a>00224   fprintf (stdout, <span class="stringliteral">&quot;\naXe_STAMPS: Loading object aperture list...&quot;</span>);
<a name="l00225"></a>00225   oblist = <a class="code" href="inout__aper_8c.html#ae18fecd8e762c35bae1376a8d637d8e8">file_to_object_list_seq</a> (aper_file_path, obs);
<a name="l00226"></a>00226   fprintf (stdout,<span class="stringliteral">&quot;%d objects loaded.\n\n&quot;</span>,<a class="code" href="inout__aper_8c.html#aa4bd812673400180537c7ea98650d3fe">object_list_size</a>(oblist));
<a name="l00227"></a>00227 
<a name="l00228"></a>00228   <span class="comment">//  Open the OPET file for reading</span>
<a name="l00229"></a>00229   fits_open_file (&amp;PET_ptr, PET_file_path, READONLY, &amp;f_status);
<a name="l00230"></a>00230   <span class="keywordflow">if</span> (f_status)
<a name="l00231"></a>00231     {
<a name="l00232"></a>00232       ffrprt (stdout, f_status);
<a name="l00233"></a>00233       <a class="code" href="aXe__errors_8c.html#a7ef7588e5f91237ba7ce4084e6ed3c11">aXe_message</a> (<a class="code" href="aXe__errors_8h.html#a2556a67874555249b07691c37aa6d6e9">aXe_M_FATAL</a>, __FILE__, __LINE__,
<a name="l00234"></a>00234                    <span class="stringliteral">&quot;aXe_STAMPS: Could not open file: %s\n&quot;</span>,
<a name="l00235"></a>00235                    PET_file_path);
<a name="l00236"></a>00236     }
<a name="l00237"></a>00237 
<a name="l00238"></a>00238   STP_ptr = <a class="code" href="aXe__utils_8c.html#aeed8cb8563260b750fda48d5636c92f2">create_FITSimage_opened</a> (STP_file_path, 1);
<a name="l00239"></a>00239 
<a name="l00240"></a>00240   i = 0;
<a name="l00241"></a>00241   <span class="keywordflow">if</span> (oblist!=NULL)
<a name="l00242"></a>00242     {
<a name="l00243"></a>00243       <span class="keywordflow">while</span> (1)
<a name="l00244"></a>00244         {
<a name="l00245"></a>00245 
<a name="l00246"></a>00246           <span class="comment">/* Get the PET for this object */</span>
<a name="l00247"></a>00247           PET = <a class="code" href="spce__PET_8c.html#a6d9546246608829c70349f2d8ca69543">get_ALL_from_next_in_PET</a>(PET_ptr, &amp;aperID, &amp;beamID);
<a name="l00248"></a>00248           <span class="keywordflow">if</span> ((aperID==-1) &amp;&amp; (beamID==-1)) <span class="keywordflow">break</span>;
<a name="l00249"></a>00249           fprintf (stdout, <span class="stringliteral">&quot;aXe_STAMPS: BEAM %d%c.&quot;</span>, aperID, <a class="code" href="aXe__grism_8h.html#a7d90dabb6016bb0e09b6ab84087b70a7">BEAM</a>(beamID));
<a name="l00250"></a>00250           objindex =  <a class="code" href="inout__aper_8c.html#a12854533fd67781a0bf70a93a6ad91e4">find_object_in_object_list</a>(oblist,aperID);
<a name="l00251"></a>00251 
<a name="l00252"></a>00252           sprintf (label, <span class="stringliteral">&quot;%s.%d%c.ps/CPS&quot;</span>, STP_file_path,
<a name="l00253"></a>00253                    oblist[objindex]-&gt;ID, <a class="code" href="aXe__grism_8h.html#a7d90dabb6016bb0e09b6ab84087b70a7">BEAM</a> (oblist[objindex]-&gt;beams[beamID].ID));
<a name="l00254"></a>00254 
<a name="l00255"></a>00255           <span class="comment">// determine the minimum in x and y</span>
<a name="l00256"></a>00256           stp_min.<a class="code" href="structd__point.html#a922a3b5d82a119168ba85e5f939d02c3">x</a> = -1.0;
<a name="l00257"></a>00257           stp_min.<a class="code" href="structd__point.html#ad9846a025508bf8873a501ca5fcefbf4">y</a> = -1.0;
<a name="l00258"></a>00258 
<a name="l00259"></a>00259           <span class="comment">// special treatment for FORS2: dirzzled stamp images</span>
<a name="l00260"></a>00260           <span class="keywordflow">if</span> (drzstamp)
<a name="l00261"></a>00261             {
<a name="l00262"></a>00262 
<a name="l00263"></a>00263               for_grism = <a class="code" href="disp__conf_8c.html#a18a284f304a89240630f4f61869f468f">check_for_grism</a> (conf_file_path, beamID);
<a name="l00264"></a>00264               <span class="keywordflow">if</span> (!for_grism)
<a name="l00265"></a>00265                 <a class="code" href="aXe__errors_8c.html#a7ef7588e5f91237ba7ce4084e6ed3c11">aXe_message</a> (<a class="code" href="aXe__errors_8h.html#a2556a67874555249b07691c37aa6d6e9">aXe_M_FATAL</a>, __FILE__, __LINE__,
<a name="l00266"></a>00266                              <span class="stringliteral">&quot;aXe_STAMPS: Drizzled stamp images are not\n&quot;</span>
<a name="l00267"></a>00267                              <span class="stringliteral">&quot;supported for prism images. Please choose a different option!\n&quot;</span>);
<a name="l00268"></a>00268 
<a name="l00269"></a>00269               <span class="comment">// get the dimensions of the drizzled stamp</span>
<a name="l00270"></a>00270               dim = <a class="code" href="spce__output_8c.html#aece0dc2dd2738020829c96e9413f5494">get_stamp_dim</a>(PET, oblist[objindex]-&gt;beams[beamID].width, conf, beamID, &amp;stp_min);
<a name="l00271"></a>00271 
<a name="l00272"></a>00272               <span class="comment">// fill the drzstamp structure (counts plus weight matrix)</span>
<a name="l00273"></a>00273               drzstmp = <a class="code" href="spce__output_8c.html#abc094a62d0858bccc25eff2dc0b49538">drizzled_stamp_img</a> (PET,oblist[objindex]-&gt;beams[beamID].width,
<a name="l00274"></a>00274                                             oblist[objindex]-&gt;beams[beamID].orient,  dim);
<a name="l00275"></a>00275 
<a name="l00276"></a>00276               <span class="comment">// does this make sense</span>
<a name="l00277"></a>00277               <a class="code" href="spce__output_8c.html#a863b4bf317f0bd06437963cd958db9ba">interpolate_over_NaN</a> (drzstmp-&gt;<a class="code" href="structdrzstamp.html#a1e8778c4fa3383cb553fbfd9d6eb2582">counts</a>);
<a name="l00278"></a>00278 
<a name="l00279"></a>00279               <span class="comment">// give the extension name and store the counts</span>
<a name="l00280"></a>00280               sprintf (label, <span class="stringliteral">&quot;BEAM_%d%c&quot;</span>,oblist[objindex]-&gt;ID, <a class="code" href="aXe__grism_8h.html#a7d90dabb6016bb0e09b6ab84087b70a7">BEAM</a> (oblist[objindex]-&gt;beams[beamID].ID));
<a name="l00281"></a>00281               <a class="code" href="aXe__utils_8c.html#a338bd69255708dd92dc8da5f081ea812">gsl_to_FITSimage_opened</a> (drzstmp-&gt;<a class="code" href="structdrzstamp.html#a1e8778c4fa3383cb553fbfd9d6eb2582">counts</a>, STP_ptr ,0,label);
<a name="l00282"></a>00282 
<a name="l00283"></a>00283               <span class="comment">// in case that the stamp is no dummy, make and store the WCS header</span>
<a name="l00284"></a>00284               <span class="keywordflow">if</span> (dim.<a class="code" href="structdrzstamp__dim.html#ab3c0ed305132ecda42a1e8b6dad5ce27">resolution</a>)
<a name="l00285"></a>00285                 {
<a name="l00286"></a>00286                   cards = <a class="code" href="spc__FITScards_8c.html#a7a09d3f4ae7b2068f051e00781080751">get_WCS_FITScards</a>(dim.<a class="code" href="structdrzstamp__dim.html#af6df14c21230e289ef6abe7134de3cc3">xstart</a>*dim.<a class="code" href="structdrzstamp__dim.html#ab3c0ed305132ecda42a1e8b6dad5ce27">resolution</a>, dim.<a class="code" href="structdrzstamp__dim.html#ab3c0ed305132ecda42a1e8b6dad5ce27">resolution</a>, dim.<a class="code" href="structdrzstamp__dim.html#a9ed53e0c679cabe8bd15189b7b9b7a62">ystart</a>);
<a name="l00287"></a>00287                   <a class="code" href="aXe__utils_8c.html#a6652d52eca381c6c7fbc9913f2b42a0e">put_FITS_cards_opened</a>(STP_ptr,cards);
<a name="l00288"></a>00288                   <a class="code" href="spc__FITScards_8c.html#aaaba4aea09f708f12bf52e9446e5384b">free_FITScards</a>(cards);
<a name="l00289"></a>00289                 }
<a name="l00290"></a>00290 
<a name="l00291"></a>00291               <span class="comment">// make and store the default header</span>
<a name="l00292"></a>00292               cards = <a class="code" href="spc__FITScards_8c.html#a60d9bff1233863fe6771d0413d340bc5">beam_to_FITScards</a>(oblist[objindex],beamID);
<a name="l00293"></a>00293               xymin_cards = <a class="code" href="spc__FITScards_8c.html#a1c59aaa35e0ecd19cbbfc7d65b1cdf3a">stpmin_to_FITScards</a>(stp_min);
<a name="l00294"></a>00294               <a class="code" href="aXe__utils_8c.html#a6652d52eca381c6c7fbc9913f2b42a0e">put_FITS_cards_opened</a>(STP_ptr,cards);
<a name="l00295"></a>00295               <a class="code" href="aXe__utils_8c.html#a6652d52eca381c6c7fbc9913f2b42a0e">put_FITS_cards_opened</a>(STP_ptr,xymin_cards);
<a name="l00296"></a>00296               <a class="code" href="spc__FITScards_8c.html#aaaba4aea09f708f12bf52e9446e5384b">free_FITScards</a>(cards);
<a name="l00297"></a>00297               <a class="code" href="spc__FITScards_8c.html#aaaba4aea09f708f12bf52e9446e5384b">free_FITScards</a>(xymin_cards);
<a name="l00298"></a>00298 
<a name="l00299"></a>00299               <span class="comment">// give the extension name and store the weight image</span>
<a name="l00300"></a>00300               sprintf (label, <span class="stringliteral">&quot;WEIG_%d%c&quot;</span>,oblist[objindex]-&gt;ID, <a class="code" href="aXe__grism_8h.html#a7d90dabb6016bb0e09b6ab84087b70a7">BEAM</a> (oblist[objindex]-&gt;beams[beamID].ID));
<a name="l00301"></a>00301               <a class="code" href="aXe__utils_8c.html#a338bd69255708dd92dc8da5f081ea812">gsl_to_FITSimage_opened</a> (drzstmp-&gt;<a class="code" href="structdrzstamp.html#a175c8d689fec7a99909d3df716891907">weight</a>, STP_ptr ,0,label);
<a name="l00302"></a>00302 
<a name="l00303"></a>00303               <span class="comment">// in case that the stamp is no dummy, make and store the WCS header</span>
<a name="l00304"></a>00304               <span class="keywordflow">if</span> (dim.<a class="code" href="structdrzstamp__dim.html#ab3c0ed305132ecda42a1e8b6dad5ce27">resolution</a>)
<a name="l00305"></a>00305                 {
<a name="l00306"></a>00306                   cards = <a class="code" href="spc__FITScards_8c.html#a7a09d3f4ae7b2068f051e00781080751">get_WCS_FITScards</a>(dim.<a class="code" href="structdrzstamp__dim.html#af6df14c21230e289ef6abe7134de3cc3">xstart</a>*dim.<a class="code" href="structdrzstamp__dim.html#ab3c0ed305132ecda42a1e8b6dad5ce27">resolution</a>, dim.<a class="code" href="structdrzstamp__dim.html#ab3c0ed305132ecda42a1e8b6dad5ce27">resolution</a>, dim.<a class="code" href="structdrzstamp__dim.html#a9ed53e0c679cabe8bd15189b7b9b7a62">ystart</a>);
<a name="l00307"></a>00307                   <a class="code" href="aXe__utils_8c.html#a6652d52eca381c6c7fbc9913f2b42a0e">put_FITS_cards_opened</a>(STP_ptr,cards);
<a name="l00308"></a>00308                   <a class="code" href="spc__FITScards_8c.html#aaaba4aea09f708f12bf52e9446e5384b">free_FITScards</a>(cards);
<a name="l00309"></a>00309                 }
<a name="l00310"></a>00310 
<a name="l00311"></a>00311               <span class="comment">// make and store the default header</span>
<a name="l00312"></a>00312               cards = <a class="code" href="spc__FITScards_8c.html#a60d9bff1233863fe6771d0413d340bc5">beam_to_FITScards</a>(oblist[objindex],beamID);
<a name="l00313"></a>00313               xymin_cards = <a class="code" href="spc__FITScards_8c.html#a1c59aaa35e0ecd19cbbfc7d65b1cdf3a">stpmin_to_FITScards</a>(stp_min);
<a name="l00314"></a>00314               <a class="code" href="aXe__utils_8c.html#a6652d52eca381c6c7fbc9913f2b42a0e">put_FITS_cards_opened</a>(STP_ptr,cards);
<a name="l00315"></a>00315               <a class="code" href="aXe__utils_8c.html#a6652d52eca381c6c7fbc9913f2b42a0e">put_FITS_cards_opened</a>(STP_ptr,xymin_cards);
<a name="l00316"></a>00316               <a class="code" href="spc__FITScards_8c.html#aaaba4aea09f708f12bf52e9446e5384b">free_FITScards</a>(cards);
<a name="l00317"></a>00317               <a class="code" href="spc__FITScards_8c.html#aaaba4aea09f708f12bf52e9446e5384b">free_FITScards</a>(xymin_cards);
<a name="l00318"></a>00318 
<a name="l00319"></a>00319               <span class="comment">// free the structure with the count and weight matrix</span>
<a name="l00320"></a>00320               <a class="code" href="spce__output_8c.html#a27673f685a62f03a7e504a69324d1a4f">free_drzstamp</a>(drzstmp);
<a name="l00321"></a>00321             }
<a name="l00322"></a>00322           <span class="keywordflow">else</span>
<a name="l00323"></a>00323             {
<a name="l00324"></a>00324               <span class="keywordflow">if</span> (rectified)
<a name="l00325"></a>00325                 {
<a name="l00326"></a>00326                   rstamp = <a class="code" href="spce__output_8c.html#acfb8de045d5147f405aac44a201d51a1">rectified_stamp_img</a> (PET,oblist[objindex]-&gt;beams[beamID].width, &amp;stp_min);
<a name="l00327"></a>00327                 }
<a name="l00328"></a>00328               <span class="keywordflow">else</span>
<a name="l00329"></a>00329                 {
<a name="l00330"></a>00330                   rstamp = <a class="code" href="spce__output_8c.html#adecd7e61360bb4de56f06143b2f070ac">stamp_img</a> (PET,oblist[objindex]-&gt;beams[beamID].width, &amp;stp_min);
<a name="l00331"></a>00331                 }
<a name="l00332"></a>00332               sprintf (label, <span class="stringliteral">&quot;BEAM_%d%c&quot;</span>,oblist[objindex]-&gt;ID, <a class="code" href="aXe__grism_8h.html#a7d90dabb6016bb0e09b6ab84087b70a7">BEAM</a> (oblist[objindex]-&gt;beams[beamID].ID));
<a name="l00333"></a>00333               <a class="code" href="spce__output_8c.html#a863b4bf317f0bd06437963cd958db9ba">interpolate_over_NaN</a> (rstamp);
<a name="l00334"></a>00334               <a class="code" href="aXe__utils_8c.html#a338bd69255708dd92dc8da5f081ea812">gsl_to_FITSimage_opened</a> (rstamp, STP_ptr ,0,label);
<a name="l00335"></a>00335               cards = <a class="code" href="spc__FITScards_8c.html#a60d9bff1233863fe6771d0413d340bc5">beam_to_FITScards</a>(oblist[objindex],beamID);
<a name="l00336"></a>00336               xymin_cards = <a class="code" href="spc__FITScards_8c.html#a1c59aaa35e0ecd19cbbfc7d65b1cdf3a">stpmin_to_FITScards</a>(stp_min);
<a name="l00337"></a>00337               <a class="code" href="aXe__utils_8c.html#a6652d52eca381c6c7fbc9913f2b42a0e">put_FITS_cards_opened</a>(STP_ptr,cards);
<a name="l00338"></a>00338               <a class="code" href="aXe__utils_8c.html#a6652d52eca381c6c7fbc9913f2b42a0e">put_FITS_cards_opened</a>(STP_ptr,xymin_cards);
<a name="l00339"></a>00339               <a class="code" href="spc__FITScards_8c.html#aaaba4aea09f708f12bf52e9446e5384b">free_FITScards</a>(cards);
<a name="l00340"></a>00340               <a class="code" href="spc__FITScards_8c.html#aaaba4aea09f708f12bf52e9446e5384b">free_FITScards</a>(xymin_cards);
<a name="l00341"></a>00341 
<a name="l00342"></a>00342               <a class="code" href="spce__output_8c.html#afea19a0c681697df7d6220ab0af9b0c0">free_stamp_img</a>(rstamp);
<a name="l00343"></a>00343             }
<a name="l00344"></a>00344 
<a name="l00345"></a>00345           <span class="keywordflow">if</span> (PET!=NULL)
<a name="l00346"></a>00346             free(PET);
<a name="l00347"></a>00347 
<a name="l00348"></a>00348           fprintf (stdout, <span class="stringliteral">&quot; Done.\n&quot;</span>);
<a name="l00349"></a>00349           i++;
<a name="l00350"></a>00350         }
<a name="l00351"></a>00351 
<a name="l00352"></a>00352     }
<a name="l00353"></a>00353   <span class="keywordflow">if</span> (oblist!=NULL) <a class="code" href="aXe__utils_8c.html#a1f63bfb071e9d0ea1f8854efdfae4692">free_oblist</a> (oblist);
<a name="l00354"></a>00354 
<a name="l00355"></a>00355   fits_close_file (STP_ptr, &amp;f_status);
<a name="l00356"></a>00356   <span class="keywordflow">if</span> (f_status)
<a name="l00357"></a>00357     {
<a name="l00358"></a>00358       ffrprt (stdout, f_status);
<a name="l00359"></a>00359       <a class="code" href="aXe__errors_8c.html#a7ef7588e5f91237ba7ce4084e6ed3c11">aXe_message</a> (<a class="code" href="aXe__errors_8h.html#a2556a67874555249b07691c37aa6d6e9">aXe_M_FATAL</a>, __FILE__, __LINE__,
<a name="l00360"></a>00360                    <span class="stringliteral">&quot;aXe_STAMPS: Could not&quot;</span> <span class="stringliteral">&quot; close STP file: %s\n&quot;</span>, STP_file_path);
<a name="l00361"></a>00361     }
<a name="l00362"></a>00362 
<a name="l00363"></a>00363   fprintf (stdout, <span class="stringliteral">&quot;aXe_STAMPS: Done...\n&quot;</span>);
<a name="l00364"></a>00364 
<a name="l00365"></a>00365   <span class="comment">/* Copy the header info from the grism image */</span>
<a name="l00366"></a>00366   {
<a name="l00367"></a>00367     <a class="code" href="structFITScards.html">FITScards</a> *cards;
<a name="l00368"></a>00368     cards = <a class="code" href="aXe__utils_8c.html#aa1a7ef7b7d19206e1df681bf2bea0d7c">get_FITS_cards</a> (PET_file_path, 1);
<a name="l00369"></a>00369     <a class="code" href="aXe__utils_8c.html#a8abd9ee69f161e0ac3ee47dc722cebf0">put_FITS_cards</a>(STP_file_path,1,cards);
<a name="l00370"></a>00370     <a class="code" href="spc__FITScards_8c.html#aaaba4aea09f708f12bf52e9446e5384b">free_FITScards</a>(cards);
<a name="l00371"></a>00371   }
<a name="l00372"></a>00372   exit (0);
<a name="l00373"></a>00373 }
</pre></div></p>

</div>
</div>
</div>
<!--- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&nbsp;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&nbsp;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&nbsp;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&nbsp;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&nbsp;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&nbsp;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&nbsp;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&nbsp;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&nbsp;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&nbsp;</span>Defines</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<hr size="1"/><address style="text-align: right;"><small>Generated on 12 Oct 2014 for TIPS by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.6.1 </small></address>
</body>
</html>
