<!-- This comment will put IE 6, 7 and 8 in quirks mode -->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>TIPS: /renoir/fourmano/Desktop/OUSIM/TIPS/branches/tips_build/src/axesim/spc_FITScards.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javaScript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body onload='searchBox.OnSelectItem(0);'>
<!-- Generated by Doxygen 1.6.1 -->
<script type="text/javascript"><!--
var searchBox = new SearchBox("searchBox", "search",false,'Search');
--></script>
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Data&nbsp;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <img id="MSearchSelect" src="search/search.png"
             onmouseover="return searchBox.OnSearchSelectShow()"
             onmouseout="return searchBox.OnSearchSelectHide()"
             alt=""/>
        <input type="text" id="MSearchField" value="Search" accesskey="S"
             onfocus="searchBox.OnSearchFieldFocus(true)" 
             onblur="searchBox.OnSearchFieldFocus(false)" 
             onkeyup="searchBox.OnSearchFieldChange(event)"/>
        <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
        </div>
      </li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="files.html"><span>File&nbsp;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
</div>
<div class="contents">
<h1>/renoir/fourmano/Desktop/OUSIM/TIPS/branches/tips_build/src/axesim/spc_FITScards.c File Reference</h1><code>#include &quot;<a class="el" href="spc__FITScards_8h_source.html">spc_FITScards.h</a>&quot;</code><br/>
<table border="0" cellpadding="0" cellspacing="0">
<tr><td colspan="2"><h2>Namespaces</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">namespace &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacespc__FITScards.html">spc_FITScards</a></td></tr>
<tr><td colspan="2"><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="structFITScards.html">FITScards</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="spc__FITScards_8c.html#a2b3df1d707d609ec92e837b96e79140d">allocate_FITScards</a> (int n)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="spc__FITScards_8c.html#aaaba4aea09f708f12bf52e9446e5384b">free_FITScards</a> (<a class="el" href="structFITScards.html">FITScards</a> *cards)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="structFITScards.html">FITScards</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="spc__FITScards_8c.html#a7a09d3f4ae7b2068f051e00781080751">get_WCS_FITScards</a> (const double rval1, const double delta1, const double rval2)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="structFITScards.html">FITScards</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="spc__FITScards_8c.html#a60d9bff1233863fe6771d0413d340bc5">beam_to_FITScards</a> (<a class="el" href="structobject.html">object</a> *ob, int beamnum)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="structFITScards.html">FITScards</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="spc__FITScards_8c.html#a1c59aaa35e0ecd19cbbfc7d65b1cdf3a">stpmin_to_FITScards</a> (<a class="el" href="structd__point.html">d_point</a> stp_min)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="structFITScards.html">FITScards</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="spc__FITScards_8c.html#a8b1e5d01354331f3046be5e0a432f51e">drzinfo_to_FITScards</a> (<a class="el" href="structobject.html">object</a> *ob, int beamnum, <a class="el" href="structd__point.html">d_point</a> outref, <a class="el" href="structaperture__conf.html">aperture_conf</a> *conf, gsl_matrix *drizzcoeffs, int trlength, double relx, double rely, double objwidth, <a class="el" href="structd__point.html">d_point</a> refwave_pos, float sky_cps, double drizzle_width, double cdref, double spcorr)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="structFITScards.html">FITScards</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="spc__FITScards_8c.html#af17c0df011aa3245c5aecb6bf5d0b9b1">nicbck_info_to_FITScards</a> (const double skypix_frac, const double scale_factor, const double offset)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="structFITScards.html">FITScards</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="spc__FITScards_8c.html#a4a08bd7a333e8696bb347a2e7bec8a20">dispstruct_to_FITScards</a> (<a class="el" href="structdispstruct.html">dispstruct</a> *disp)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="spc__FITScards_8c.html#a6cb1187c647e381a5d1803846ee73a3e">update_contam_model</a> (fitsfile *fptr, char model_name[])</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="spc__FITScards_8c.html#a1ffb6615410d56886fdf5dc4ab8129ed">check_quantitative_contamination</a> (fitsfile *fptr)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="spc__FITScards_8c.html#a471d2609ea9bc328e07b18489922f5d2">transport_cont_modname</a> (char grism_file_path[], char PET_file_path[])</td></tr>
</table>
<hr/><h2>Function Documentation</h2>
<a class="anchor" id="a2b3df1d707d609ec92e837b96e79140d"></a><!-- doxytag: member="spc_FITScards.c::allocate_FITScards" ref="a2b3df1d707d609ec92e837b96e79140d" args="(int n)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structFITScards.html">FITScards</a>* allocate_FITScards </td>
          <td>(</td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>n</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Routine to return a pointer to a FITScard structure with room allocated for n FITS header cards strings.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>n</em>&nbsp;</td><td>the number of card to allocated memory for</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>a pointer to an allocated <a class="el" href="structFITScards.html">FITScards</a> structure </dd></dl>

<p><div class="fragment"><pre class="fragment"><a name="l00021"></a>00021 {
<a name="l00022"></a>00022     <span class="keywordtype">int</span> i;
<a name="l00023"></a>00023     <a class="code" href="structFITScards.html">FITScards</a> *res;
<a name="l00024"></a>00024 
<a name="l00025"></a>00025     res = malloc(<span class="keyword">sizeof</span>(<a class="code" href="structFITScards.html">FITScards</a>));
<a name="l00026"></a>00026 
<a name="l00027"></a>00027     <span class="comment">// Allocate enough room (n+1 for NULL termination) for all the cards</span>
<a name="l00028"></a>00028     res-&gt;<a class="code" href="structFITScards.html#ad1be9be894e41dec8131959f119b387c">cards</a> = (<span class="keywordtype">char</span> **) malloc(<span class="keyword">sizeof</span>(<span class="keywordtype">char</span> *)*n);
<a name="l00029"></a>00029     <span class="keywordflow">if</span> ( res-&gt;<a class="code" href="structFITScards.html#ad1be9be894e41dec8131959f119b387c">cards</a>==NULL) {
<a name="l00030"></a>00030         <a class="code" href="aXe__errors_8c.html#a7ef7588e5f91237ba7ce4084e6ed3c11">aXe_message</a> (<a class="code" href="aXe__errors_8h.html#a2556a67874555249b07691c37aa6d6e9">aXe_M_FATAL</a>, __FILE__, __LINE__, <span class="stringliteral">&quot;allocate_FITScards: Out of memory.&quot;</span>);
<a name="l00031"></a>00031     }
<a name="l00032"></a>00032     <span class="keywordflow">for</span>(i=0;i&lt;n;i++) {
<a name="l00033"></a>00033         res-&gt;<a class="code" href="structFITScards.html#ad1be9be894e41dec8131959f119b387c">cards</a>[i] = (<span class="keywordtype">char</span> *)malloc(<span class="keyword">sizeof</span>(<span class="keywordtype">char</span>)*FLEN_CARD);
<a name="l00034"></a>00034         <span class="keywordflow">if</span> (res-&gt;<a class="code" href="structFITScards.html#ad1be9be894e41dec8131959f119b387c">cards</a>[i]==NULL) {
<a name="l00035"></a>00035             <a class="code" href="aXe__errors_8c.html#a7ef7588e5f91237ba7ce4084e6ed3c11">aXe_message</a> (<a class="code" href="aXe__errors_8h.html#a2556a67874555249b07691c37aa6d6e9">aXe_M_FATAL</a>, __FILE__, __LINE__, <span class="stringliteral">&quot;allocate_FITScards: Out of memory.&quot;</span>);
<a name="l00036"></a>00036         }
<a name="l00037"></a>00037     }
<a name="l00038"></a>00038 
<a name="l00039"></a>00039     res-&gt;<a class="code" href="structFITScards.html#ae541232523495d8487f2d47d2ad71873">n</a> = n;
<a name="l00040"></a>00040 
<a name="l00041"></a>00041     <span class="keywordflow">return</span> res;
<a name="l00042"></a>00042 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a60d9bff1233863fe6771d0413d340bc5"></a><!-- doxytag: member="spc_FITScards.c::beam_to_FITScards" ref="a60d9bff1233863fe6771d0413d340bc5" args="(object *ob, int beamnum)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structFITScards.html">FITScards</a>* beam_to_FITScards </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structobject.html">object</a> *&nbsp;</td>
          <td class="paramname"> <em>ob</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>beamnum</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Routine to generate FITS header cards containing the information contained in a <a class="el" href="structbeam.html">beam</a> structure</p>
<p>The following information gets written about the <a class="el" href="structbeam.html">beam</a>:</p>
<p>OBJECTID, Object ID, ob-&gt;ID NBEAM,Number of <a class="el" href="structbeam.html">beam</a> in <a class="el" href="structobject.html">object</a>, ob-&gt;nbeam BEAMID, This <a class="el" href="structbeam.html">beam</a> ID, b-&gt;ID REFPNTX, x coord. of reference point, b-&gt;refpoint.x REFPNTY, y coord. of reference point, b-&gt;refpoint.y C0X, x coord. of 1st bounding <a class="el" href="structquadrangle.html">quadrangle</a> corner, b-&gt;corners[0].x C0Y, y coord. of 1st bounding <a class="el" href="structquadrangle.html">quadrangle</a> corner, b-&gt;corners[0].y C1X, x coord. of 2nd bounding <a class="el" href="structquadrangle.html">quadrangle</a> corner, b-&gt;corners[1].x C1Y, y coord. of 2nd bounding <a class="el" href="structquadrangle.html">quadrangle</a> corner, b-&gt;corners[1].y C2X, x coord. of 3rd bounding <a class="el" href="structquadrangle.html">quadrangle</a> corner, b-&gt;corners[2].x C2Y, y coord. of 3rd bounding <a class="el" href="structquadrangle.html">quadrangle</a> corner, b-&gt;corners[2].y C3X, x coord. of 4th bounding <a class="el" href="structquadrangle.html">quadrangle</a> corner, b-&gt;corners[3].x C3Y, y coord. of 4th bounding <a class="el" href="structquadrangle.html">quadrangle</a> corner, b-&gt;corners[3].y BB0X, x coord. of 1st bounding box corner, b-&gt;bbox[0].x BB0Y, y coord. of 1st bounding box corner, b-&gt;bbox[0].y BB1X, x coord. of 2nd bounding box corner, b-&gt;bbox[1].x BB1Y, y coord. of 2nd bounding box corner, b-&gt;bbox[1].y WIDTH, Width of <a class="el" href="structobject.html">object</a> in pixel, b-&gt;width ORIENT, Orientation of <a class="el" href="structobject.html">object</a> in deg. wrt y-axis, CCW, b-&gt;orient IGNORE, Ignore flag for this <a class="el" href="structbeam.html">beam</a>, b-&gt;ignore</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>ob</em>&nbsp;</td><td>a pointer to an existing <a class="el" href="structobject.html">object</a> structure containing the <a class="el" href="structbeam.html">beam</a> we are interested in </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>b</em>&nbsp;</td><td>a pointer to an existing <a class="el" href="structbeam.html">beam</a> in the passed <a class="el" href="structobject.html">object</a> ob</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>a pointer to an allocated <a class="el" href="structFITScards.html">FITScards</a> structure </dd></dl>

<p><div class="fragment"><pre class="fragment"><a name="l00146"></a>00146 {
<a name="l00147"></a>00147     <span class="keywordtype">char</span> templt[FLEN_CARD];
<a name="l00148"></a>00148     <span class="keywordtype">int</span> i=0,keytype, f_status=0;
<a name="l00149"></a>00149     <a class="code" href="structbeam.html">beam</a> *b = ob-&gt;<a class="code" href="structobject.html#ad643757142781f8265b430e19700cfe5">beams</a>+beamnum;
<a name="l00150"></a>00150 
<a name="l00151"></a>00151     <a class="code" href="structFITScards.html">FITScards</a> *cards;
<a name="l00152"></a>00152 
<a name="l00153"></a>00153     cards = <a class="code" href="spc__FITScards_8c.html#a2b3df1d707d609ec92e837b96e79140d">allocate_FITScards</a>(20);
<a name="l00154"></a>00154 
<a name="l00155"></a>00155     i=0;
<a name="l00156"></a>00156     sprintf(templt,<span class="stringliteral">&quot;OBJECTID = %d / Object ID&quot;</span>,ob-&gt;<a class="code" href="structobject.html#a8575880bdfc1c0bf44914b4efd2665bf">ID</a>);
<a name="l00157"></a>00157     fits_parse_template (templt, cards-&gt;<a class="code" href="structFITScards.html#ad1be9be894e41dec8131959f119b387c">cards</a>[i++], &amp;keytype, &amp;f_status);
<a name="l00158"></a>00158     sprintf(templt,<span class="stringliteral">&quot;NBEAM = %d / Number of beam in object&quot;</span>,ob-&gt;<a class="code" href="structobject.html#a14120e3b048a2118f7acd75ea1571c60">nbeams</a>);
<a name="l00159"></a>00159     fits_parse_template (templt, cards-&gt;<a class="code" href="structFITScards.html#ad1be9be894e41dec8131959f119b387c">cards</a>[i++], &amp;keytype, &amp;f_status);
<a name="l00160"></a>00160     sprintf(templt,<span class="stringliteral">&quot;BEAMID = %d / This beam ID&quot;</span>,b-&gt;<a class="code" href="structbeam.html#a5c3f06b67e4cc3c79be539d1b515f3c6">ID</a>);
<a name="l00161"></a>00161     fits_parse_template (templt, cards-&gt;<a class="code" href="structFITScards.html#ad1be9be894e41dec8131959f119b387c">cards</a>[i++], &amp;keytype, &amp;f_status);
<a name="l00162"></a>00162     sprintf(templt,<span class="stringliteral">&quot;REFPNTX = %f / x coord. of reference point&quot;</span>,b-&gt;<a class="code" href="structbeam.html#a54c64670a8b3e8732c1468d156ddb0ca">refpoint</a>.<a class="code" href="structd__point.html#a922a3b5d82a119168ba85e5f939d02c3">x</a>);
<a name="l00163"></a>00163     fits_parse_template (templt, cards-&gt;<a class="code" href="structFITScards.html#ad1be9be894e41dec8131959f119b387c">cards</a>[i++], &amp;keytype, &amp;f_status);
<a name="l00164"></a>00164     sprintf(templt,<span class="stringliteral">&quot;REFPNTY = %f / y coord. of reference point&quot;</span>,b-&gt;<a class="code" href="structbeam.html#a54c64670a8b3e8732c1468d156ddb0ca">refpoint</a>.<a class="code" href="structd__point.html#ad9846a025508bf8873a501ca5fcefbf4">y</a>);
<a name="l00165"></a>00165     fits_parse_template (templt, cards-&gt;<a class="code" href="structFITScards.html#ad1be9be894e41dec8131959f119b387c">cards</a>[i++], &amp;keytype, &amp;f_status);
<a name="l00166"></a>00166     sprintf(templt,<span class="stringliteral">&quot;C0X = %d / x coord. of 1st bounding quadrangle corner&quot;</span>,b-&gt;<a class="code" href="structbeam.html#a785bab6bf808db6a8841654312d20899">corners</a>[0].<a class="code" href="structpx__point.html#ab715a558731a820a25b50bd7797dd004">x</a>);
<a name="l00167"></a>00167     fits_parse_template (templt, cards-&gt;<a class="code" href="structFITScards.html#ad1be9be894e41dec8131959f119b387c">cards</a>[i++], &amp;keytype, &amp;f_status);
<a name="l00168"></a>00168     sprintf(templt,<span class="stringliteral">&quot;C0Y = %d / y coord. of 1st bounding quadrangle corner&quot;</span>,b-&gt;<a class="code" href="structbeam.html#a785bab6bf808db6a8841654312d20899">corners</a>[0].<a class="code" href="structpx__point.html#a2d02b900722a71f22a8d5100822bda61">y</a>);
<a name="l00169"></a>00169     fits_parse_template (templt, cards-&gt;<a class="code" href="structFITScards.html#ad1be9be894e41dec8131959f119b387c">cards</a>[i++], &amp;keytype, &amp;f_status);
<a name="l00170"></a>00170     sprintf(templt,<span class="stringliteral">&quot;C1X = %d / x coord. of 2nd bounding quadrangle corner&quot;</span>,b-&gt;<a class="code" href="structbeam.html#a785bab6bf808db6a8841654312d20899">corners</a>[1].<a class="code" href="structpx__point.html#ab715a558731a820a25b50bd7797dd004">x</a>);
<a name="l00171"></a>00171     fits_parse_template (templt, cards-&gt;<a class="code" href="structFITScards.html#ad1be9be894e41dec8131959f119b387c">cards</a>[i++], &amp;keytype, &amp;f_status);
<a name="l00172"></a>00172     sprintf(templt,<span class="stringliteral">&quot;C1Y = %d / y coord. of 2nd bounding quadrangle corner&quot;</span>,b-&gt;<a class="code" href="structbeam.html#a785bab6bf808db6a8841654312d20899">corners</a>[1].<a class="code" href="structpx__point.html#a2d02b900722a71f22a8d5100822bda61">y</a>);
<a name="l00173"></a>00173     fits_parse_template (templt, cards-&gt;<a class="code" href="structFITScards.html#ad1be9be894e41dec8131959f119b387c">cards</a>[i++], &amp;keytype, &amp;f_status);
<a name="l00174"></a>00174     sprintf(templt,<span class="stringliteral">&quot;C2X = %d / x coord. of 3rd bounding quadrangle corner&quot;</span>,b-&gt;<a class="code" href="structbeam.html#a785bab6bf808db6a8841654312d20899">corners</a>[2].<a class="code" href="structpx__point.html#ab715a558731a820a25b50bd7797dd004">x</a>);
<a name="l00175"></a>00175     fits_parse_template (templt, cards-&gt;<a class="code" href="structFITScards.html#ad1be9be894e41dec8131959f119b387c">cards</a>[i++], &amp;keytype, &amp;f_status);
<a name="l00176"></a>00176     sprintf(templt,<span class="stringliteral">&quot;C2Y = %d / y coord. of 3rd bounding quadrangle corner&quot;</span>,b-&gt;<a class="code" href="structbeam.html#a785bab6bf808db6a8841654312d20899">corners</a>[2].<a class="code" href="structpx__point.html#a2d02b900722a71f22a8d5100822bda61">y</a>);
<a name="l00177"></a>00177     fits_parse_template (templt, cards-&gt;<a class="code" href="structFITScards.html#ad1be9be894e41dec8131959f119b387c">cards</a>[i++], &amp;keytype, &amp;f_status);
<a name="l00178"></a>00178     sprintf(templt,<span class="stringliteral">&quot;C3X = %d / x coord. of 4th bounding quadrangle corner&quot;</span>,b-&gt;<a class="code" href="structbeam.html#a785bab6bf808db6a8841654312d20899">corners</a>[3].<a class="code" href="structpx__point.html#ab715a558731a820a25b50bd7797dd004">x</a>);
<a name="l00179"></a>00179     fits_parse_template (templt, cards-&gt;<a class="code" href="structFITScards.html#ad1be9be894e41dec8131959f119b387c">cards</a>[i++], &amp;keytype, &amp;f_status);
<a name="l00180"></a>00180     sprintf(templt,<span class="stringliteral">&quot;C3Y = %d / y coord. of 4th bounding quadrangle corner&quot;</span>,b-&gt;<a class="code" href="structbeam.html#a785bab6bf808db6a8841654312d20899">corners</a>[3].<a class="code" href="structpx__point.html#a2d02b900722a71f22a8d5100822bda61">y</a>);
<a name="l00181"></a>00181     fits_parse_template (templt, cards-&gt;<a class="code" href="structFITScards.html#ad1be9be894e41dec8131959f119b387c">cards</a>[i++], &amp;keytype, &amp;f_status);
<a name="l00182"></a>00182     sprintf(templt,<span class="stringliteral">&quot;BB0X = %d / x coord. of 1st bounding box corner&quot;</span>,b-&gt;<a class="code" href="structbeam.html#aa703d04290c347c35197ff52993b98f3">bbox</a>[0].<a class="code" href="structpx__point.html#ab715a558731a820a25b50bd7797dd004">x</a>);
<a name="l00183"></a>00183     fits_parse_template (templt, cards-&gt;<a class="code" href="structFITScards.html#ad1be9be894e41dec8131959f119b387c">cards</a>[i++], &amp;keytype, &amp;f_status);
<a name="l00184"></a>00184     sprintf(templt,<span class="stringliteral">&quot;BB0Y = %d / y coord. of 1st bounding box corner&quot;</span>,b-&gt;<a class="code" href="structbeam.html#aa703d04290c347c35197ff52993b98f3">bbox</a>[0].<a class="code" href="structpx__point.html#a2d02b900722a71f22a8d5100822bda61">y</a>);
<a name="l00185"></a>00185     fits_parse_template (templt, cards-&gt;<a class="code" href="structFITScards.html#ad1be9be894e41dec8131959f119b387c">cards</a>[i++], &amp;keytype, &amp;f_status);
<a name="l00186"></a>00186     sprintf(templt,<span class="stringliteral">&quot;BB1X = %d / x coord. of 2nd bounding box corner&quot;</span>,b-&gt;<a class="code" href="structbeam.html#aa703d04290c347c35197ff52993b98f3">bbox</a>[1].<a class="code" href="structpx__point.html#ab715a558731a820a25b50bd7797dd004">x</a>);
<a name="l00187"></a>00187     fits_parse_template (templt, cards-&gt;<a class="code" href="structFITScards.html#ad1be9be894e41dec8131959f119b387c">cards</a>[i++], &amp;keytype, &amp;f_status);
<a name="l00188"></a>00188     sprintf(templt,<span class="stringliteral">&quot;BB1Y = %d / y coord. of 2nd bounding box corner&quot;</span>,b-&gt;<a class="code" href="structbeam.html#aa703d04290c347c35197ff52993b98f3">bbox</a>[1].<a class="code" href="structpx__point.html#a2d02b900722a71f22a8d5100822bda61">y</a>);
<a name="l00189"></a>00189     fits_parse_template (templt, cards-&gt;<a class="code" href="structFITScards.html#ad1be9be894e41dec8131959f119b387c">cards</a>[i++], &amp;keytype, &amp;f_status);
<a name="l00190"></a>00190     sprintf(templt,<span class="stringliteral">&quot;WIDTH = %f / Width of object in pixel&quot;</span>,b-&gt;<a class="code" href="structbeam.html#ae99ff960c070381b6e76af5a58cb9c45">width</a>);
<a name="l00191"></a>00191     fits_parse_template (templt, cards-&gt;<a class="code" href="structFITScards.html#ad1be9be894e41dec8131959f119b387c">cards</a>[i++], &amp;keytype, &amp;f_status);
<a name="l00192"></a>00192     <span class="comment">/* Angle reference frame is converted from aXe&apos;s to SeXtractor */</span>
<a name="l00193"></a>00193     sprintf(templt,<span class="stringliteral">&quot;ORIENT = %f / Orientation of object in deg. wrt y-axis, CCW&quot;</span>,((b-&gt;<a class="code" href="structbeam.html#a362f20c7f29a9d08731a03939103c8c1">orient</a>) / M_PI * 180. - 180.));
<a name="l00194"></a>00194     fits_parse_template (templt, cards-&gt;<a class="code" href="structFITScards.html#ad1be9be894e41dec8131959f119b387c">cards</a>[i++], &amp;keytype, &amp;f_status);
<a name="l00195"></a>00195     sprintf(templt,<span class="stringliteral">&quot;IGNORE = %d / Ignore flag for this beam&quot;</span>,b-&gt;<a class="code" href="structbeam.html#a8c7dc459dedfd957741d35c59440972f">ignore</a>);
<a name="l00196"></a>00196     fits_parse_template (templt, cards-&gt;<a class="code" href="structFITScards.html#ad1be9be894e41dec8131959f119b387c">cards</a>[i++], &amp;keytype, &amp;f_status);
<a name="l00197"></a>00197 
<a name="l00198"></a>00198     <span class="keywordflow">return</span> cards;
<a name="l00199"></a>00199 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a1ffb6615410d56886fdf5dc4ab8129ed"></a><!-- doxytag: member="spc_FITScards.c::check_quantitative_contamination" ref="a1ffb6615410d56886fdf5dc4ab8129ed" args="(fitsfile *fptr)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int check_quantitative_contamination </td>
          <td>(</td>
          <td class="paramtype">fitsfile *&nbsp;</td>
          <td class="paramname"> <em>fptr</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>The function reads the keyword "CONTAM" in an open FITS file and ananlyzes its content. In case that the content indicates a quantitative contamination model, 1 is returned. If not the value 0 is given back.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>fptr</em>&nbsp;</td><td>- pointer to the FITS-file </td></tr>
  </table>
  </dd>
</dl>

<p><div class="fragment"><pre class="fragment"><a name="l00492"></a>00492 {
<a name="l00493"></a>00493 
<a name="l00494"></a>00494   <span class="keywordtype">char</span> keyval[FLEN_CARD];
<a name="l00495"></a>00495   <span class="keywordtype">char</span> keyw[FLEN_KEYWORD];
<a name="l00496"></a>00496   <span class="keywordtype">char</span> comment[FLEN_COMMENT];
<a name="l00497"></a>00497 
<a name="l00498"></a>00498   <span class="keywordtype">int</span>  f_status=0;
<a name="l00499"></a>00499   <span class="keywordtype">int</span> ret;
<a name="l00500"></a>00500 
<a name="l00501"></a>00501   <span class="comment">// fill the keyword valiable</span>
<a name="l00502"></a>00502   sprintf(keyw,<span class="stringliteral">&quot;CONTAM&quot;</span>);
<a name="l00503"></a>00503 
<a name="l00504"></a>00504   <span class="comment">// use the fitsio routine to read the keyword</span>
<a name="l00505"></a>00505   <span class="comment">// react in case of an error</span>
<a name="l00506"></a>00506   fits_read_key(fptr, TSTRING, keyw, keyval, comment, &amp;f_status);
<a name="l00507"></a>00507   <span class="keywordflow">if</span> (f_status)
<a name="l00508"></a>00508     {
<a name="l00509"></a>00509       ffrprt (stderr, f_status);
<a name="l00510"></a>00510       <a class="code" href="aXe__errors_8c.html#a7ef7588e5f91237ba7ce4084e6ed3c11">aXe_message</a> (<a class="code" href="aXe__errors_8h.html#a3f3c2d017ceaf0b51cfb71efbcaeff44">aXe_M_WARN4</a>, __FILE__, __LINE__,
<a name="l00511"></a>00511                    <span class="stringliteral">&quot;check_quantitative_contamination:\nCould not read keyword %s from fits-file.\n&quot;</span>, keyw);
<a name="l00512"></a>00512     }
<a name="l00513"></a>00513 
<a name="l00514"></a>00514   <span class="comment">// check whether the keyword was there</span>
<a name="l00515"></a>00515   <span class="keywordflow">if</span> (strlen(keyval) &gt;0)
<a name="l00516"></a>00516     {
<a name="l00517"></a>00517       <span class="comment">// check the keyword content agaist the</span>
<a name="l00518"></a>00518       <span class="comment">// names of the non quantitative contamination models</span>
<a name="l00519"></a>00519       <span class="keywordflow">if</span> (!strcmp(keyval,<span class="stringliteral">&quot;GEOM&quot;</span>))
<a name="l00520"></a>00520         ret=0;
<a name="l00521"></a>00521       <span class="comment">// set the quantitative contamination flag</span>
<a name="l00522"></a>00522       <span class="keywordflow">else</span>
<a name="l00523"></a>00523         ret=1;
<a name="l00524"></a>00524     }
<a name="l00525"></a>00525   <span class="comment">// in case that the keyword does not exist,</span>
<a name="l00526"></a>00526   <span class="comment">// the flag is not set</span>
<a name="l00527"></a>00527   <span class="keywordflow">else</span>
<a name="l00528"></a>00528     {
<a name="l00529"></a>00529       ret=0;
<a name="l00530"></a>00530     }
<a name="l00531"></a>00531 
<a name="l00532"></a>00532   <span class="comment">// return the flag</span>
<a name="l00533"></a>00533   <span class="keywordflow">return</span> ret;
<a name="l00534"></a>00534 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a4a08bd7a333e8696bb347a2e7bec8a20"></a><!-- doxytag: member="spc_FITScards.c::dispstruct_to_FITScards" ref="a4a08bd7a333e8696bb347a2e7bec8a20" args="(dispstruct *disp)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structFITScards.html">FITScards</a>* dispstruct_to_FITScards </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structdispstruct.html">dispstruct</a> *&nbsp;</td>
          <td class="paramname"> <em>disp</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>A helper function which generates FITS keywords containing the content of a disp structure.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>disp</em>&nbsp;</td><td>A pointer to a <a class="el" href="structdispstruct.html">dispstruct</a> structure</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>a pointer to an allocated <a class="el" href="structFITScards.html">FITScards</a> structure </dd></dl>

<p><div class="fragment"><pre class="fragment"><a name="l00420"></a>00420 {
<a name="l00421"></a>00421   <span class="keywordtype">char</span> templt[FLEN_CARD];
<a name="l00422"></a>00422   <span class="keywordtype">int</span> i=0,j,keytype, f_status=0;
<a name="l00423"></a>00423   <span class="keywordtype">int</span> numcards=0;
<a name="l00424"></a>00424   <a class="code" href="structFITScards.html">FITScards</a> *cards;
<a name="l00425"></a>00425 
<a name="l00426"></a>00426   numcards += disp-&gt;<a class="code" href="structdispstruct.html#aa3d9b87899d74411311e3a0ab60eeb20">pol</a>-&gt;size;
<a name="l00427"></a>00427   numcards +=1 ; <span class="comment">/* for for_grism */</span>
<a name="l00428"></a>00428   <span class="comment">//numcards +=2 ; /* for offset */</span>
<a name="l00429"></a>00429   numcards +=2 ; <span class="comment">/* for cpoint */</span>
<a name="l00430"></a>00430   cards = <a class="code" href="spc__FITScards_8c.html#a2b3df1d707d609ec92e837b96e79140d">allocate_FITScards</a>(numcards);
<a name="l00431"></a>00431 
<a name="l00432"></a>00432   i=0;
<a name="l00433"></a>00433   <span class="keywordflow">for</span> (j=0;j&lt;disp-&gt;<a class="code" href="structdispstruct.html#aa3d9b87899d74411311e3a0ab60eeb20">pol</a>-&gt;size;j++) {
<a name="l00434"></a>00434     sprintf(templt,<span class="stringliteral">&quot;DLDX%d = %g / Wavelength solution parameter&quot;</span>,j,gsl_vector_get(disp-&gt;<a class="code" href="structdispstruct.html#aa3d9b87899d74411311e3a0ab60eeb20">pol</a>,j));
<a name="l00435"></a>00435     fits_parse_template (templt, cards-&gt;<a class="code" href="structFITScards.html#ad1be9be894e41dec8131959f119b387c">cards</a>[i++], &amp;keytype, &amp;f_status);
<a name="l00436"></a>00436   }
<a name="l00437"></a>00437 
<a name="l00438"></a>00438   sprintf(templt,<span class="stringliteral">&quot;FORGRISM = %d / If 1 then grism polynomial used. Prism otherwise.&quot;</span>,disp-&gt;<a class="code" href="structdispstruct.html#ac05fe270c9ee7b243421a69226068ee9">for_grism</a>);
<a name="l00439"></a>00439   fits_parse_template (templt, cards-&gt;<a class="code" href="structFITScards.html#ad1be9be894e41dec8131959f119b387c">cards</a>[i++], &amp;keytype, &amp;f_status);
<a name="l00440"></a>00440   sprintf(templt,<span class="stringliteral">&quot;CPOINTX = %f / X position where wavelength disp. was computed&quot;</span>,disp-&gt;<a class="code" href="structdispstruct.html#afec7c60794164585d3c86f3e588f3060">cpoint</a>.<a class="code" href="structd__point.html#a922a3b5d82a119168ba85e5f939d02c3">x</a>);
<a name="l00441"></a>00441   fits_parse_template (templt, cards-&gt;<a class="code" href="structFITScards.html#ad1be9be894e41dec8131959f119b387c">cards</a>[i++], &amp;keytype, &amp;f_status);
<a name="l00442"></a>00442   sprintf(templt,<span class="stringliteral">&quot;CPOINTY = %f / X position where wavelength disp. was computed&quot;</span>,disp-&gt;<a class="code" href="structdispstruct.html#afec7c60794164585d3c86f3e588f3060">cpoint</a>.<a class="code" href="structd__point.html#ad9846a025508bf8873a501ca5fcefbf4">y</a>);
<a name="l00443"></a>00443   fits_parse_template (templt, cards-&gt;<a class="code" href="structFITScards.html#ad1be9be894e41dec8131959f119b387c">cards</a>[i++], &amp;keytype, &amp;f_status);
<a name="l00444"></a>00444   <span class="keywordflow">return</span> cards;
<a name="l00445"></a>00445 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a8b1e5d01354331f3046be5e0a432f51e"></a><!-- doxytag: member="spc_FITScards.c::drzinfo_to_FITScards" ref="a8b1e5d01354331f3046be5e0a432f51e" args="(object *ob, int beamnum, d_point outref, aperture_conf *conf, gsl_matrix *drizzcoeffs, int trlength, double relx, double rely, double objwidth, d_point refwave_pos, float sky_cps, double drizzle_width, double cdref, double spcorr)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structFITScards.html">FITScards</a>* drzinfo_to_FITScards </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structobject.html">object</a> *&nbsp;</td>
          <td class="paramname"> <em>ob</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>beamnum</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structd__point.html">d_point</a>&nbsp;</td>
          <td class="paramname"> <em>outref</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structaperture__conf.html">aperture_conf</a> *&nbsp;</td>
          <td class="paramname"> <em>conf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">gsl_matrix *&nbsp;</td>
          <td class="paramname"> <em>drizzcoeffs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>trlength</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&nbsp;</td>
          <td class="paramname"> <em>relx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&nbsp;</td>
          <td class="paramname"> <em>rely</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&nbsp;</td>
          <td class="paramname"> <em>objwidth</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structd__point.html">d_point</a>&nbsp;</td>
          <td class="paramname"> <em>refwave_pos</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&nbsp;</td>
          <td class="paramname"> <em>sky_cps</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&nbsp;</td>
          <td class="paramname"> <em>drizzle_width</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&nbsp;</td>
          <td class="paramname"> <em>cdref</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&nbsp;</td>
          <td class="paramname"> <em>spcorr</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Routine to generate FITS header cards containing the information for drizzling and <a class="el" href="structbeam.html">beam</a> information contained in a <a class="el" href="structbeam.html">beam</a> structure</p>
<p>The following information gets written about the <a class="el" href="structbeam.html">beam</a>:</p>
<p>OBJECTID, Object ID, ob-&gt;ID NBEAM,Number of <a class="el" href="structbeam.html">beam</a> in <a class="el" href="structobject.html">object</a>, ob-&gt;nbeam BEAMID, This <a class="el" href="structbeam.html">beam</a> ID, b-&gt;ID REFPNTX, x coord. of reference point, b-&gt;refpoint.x REFPNTY, y coord. of reference point, b-&gt;refpoint.y C0X, x coord. of 1st bounding <a class="el" href="structquadrangle.html">quadrangle</a> corner, b-&gt;corners[0].x C0Y, y coord. of 1st bounding <a class="el" href="structquadrangle.html">quadrangle</a> corner, b-&gt;corners[0].y C1X, x coord. of 2nd bounding <a class="el" href="structquadrangle.html">quadrangle</a> corner, b-&gt;corners[1].x C1Y, y coord. of 2nd bounding <a class="el" href="structquadrangle.html">quadrangle</a> corner, b-&gt;corners[1].y C2X, x coord. of 3rd bounding <a class="el" href="structquadrangle.html">quadrangle</a> corner, b-&gt;corners[2].x C2Y, y coord. of 3rd bounding <a class="el" href="structquadrangle.html">quadrangle</a> corner, b-&gt;corners[2].y C3X, x coord. of 4th bounding <a class="el" href="structquadrangle.html">quadrangle</a> corner, b-&gt;corners[3].x C3Y, y coord. of 4th bounding <a class="el" href="structquadrangle.html">quadrangle</a> corner, b-&gt;corners[3].y BB0X, x coord. of 1st bounding box corner, b-&gt;bbox[0].x BB0Y, y coord. of 1st bounding box corner, b-&gt;bbox[0].y BB1X, x coord. of 2nd bounding box corner, b-&gt;bbox[1].x BB1Y, y coord. of 2nd bounding box corner, b-&gt;bbox[1].y WIDTH, Width of <a class="el" href="structobject.html">object</a> in pixel, b-&gt;width ORIENT, Orientation of <a class="el" href="structobject.html">object</a> in deg. wrt y-axis, CCW, b-&gt;orient IGNORE, Ignore flag for this <a class="el" href="structbeam.html">beam</a>, b-&gt;ignore</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>ob</em>&nbsp;</td><td>a pointer to an existing <a class="el" href="structobject.html">object</a> structure containing the <a class="el" href="structbeam.html">beam</a> we are interested in </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>b</em>&nbsp;</td><td>a pointer to an existing <a class="el" href="structbeam.html">beam</a> in the passed <a class="el" href="structobject.html">object</a> ob</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>a pointer to an allocated <a class="el" href="structFITScards.html">FITScards</a> structure </dd></dl>

<p><div class="fragment"><pre class="fragment"><a name="l00261"></a>00261 {
<a name="l00262"></a>00262     <span class="comment">//double dx, dy;</span>
<a name="l00263"></a>00263     <span class="keywordtype">char</span> templt[FLEN_CARD];
<a name="l00264"></a>00264     <span class="keywordtype">int</span> i=0,keytype, f_status=0;
<a name="l00265"></a>00265     <a class="code" href="structbeam.html">beam</a> *b = ob-&gt;<a class="code" href="structobject.html#ad643757142781f8265b430e19700cfe5">beams</a>+beamnum;
<a name="l00266"></a>00266 
<a name="l00267"></a>00267     <a class="code" href="structFITScards.html">FITScards</a> *cards;
<a name="l00268"></a>00268 
<a name="l00269"></a>00269     cards = <a class="code" href="spc__FITScards_8c.html#a2b3df1d707d609ec92e837b96e79140d">allocate_FITScards</a>(56);
<a name="l00270"></a>00270 
<a name="l00271"></a>00271     i=0;
<a name="l00272"></a>00272     sprintf(templt,<span class="stringliteral">&quot;OBJECTID = %d / Object ID&quot;</span>,ob-&gt;<a class="code" href="structobject.html#a8575880bdfc1c0bf44914b4efd2665bf">ID</a>);
<a name="l00273"></a>00273     fits_parse_template (templt, cards-&gt;<a class="code" href="structFITScards.html#ad1be9be894e41dec8131959f119b387c">cards</a>[i++], &amp;keytype, &amp;f_status);
<a name="l00274"></a>00274     sprintf(templt,<span class="stringliteral">&quot;NBEAM = %d / Number of beam in object&quot;</span>,ob-&gt;<a class="code" href="structobject.html#a14120e3b048a2118f7acd75ea1571c60">nbeams</a>);
<a name="l00275"></a>00275     fits_parse_template (templt, cards-&gt;<a class="code" href="structFITScards.html#ad1be9be894e41dec8131959f119b387c">cards</a>[i++], &amp;keytype, &amp;f_status);
<a name="l00276"></a>00276     sprintf(templt,<span class="stringliteral">&quot;BEAMID = %d / This beam ID&quot;</span>,b-&gt;<a class="code" href="structbeam.html#a5c3f06b67e4cc3c79be539d1b515f3c6">ID</a>);
<a name="l00277"></a>00277     fits_parse_template (templt, cards-&gt;<a class="code" href="structFITScards.html#ad1be9be894e41dec8131959f119b387c">cards</a>[i++], &amp;keytype, &amp;f_status);
<a name="l00278"></a>00278     sprintf(templt,<span class="stringliteral">&quot;REFPNTX = %f / x coord. of reference point&quot;</span>,b-&gt;<a class="code" href="structbeam.html#a54c64670a8b3e8732c1468d156ddb0ca">refpoint</a>.<a class="code" href="structd__point.html#a922a3b5d82a119168ba85e5f939d02c3">x</a>);
<a name="l00279"></a>00279     fits_parse_template (templt, cards-&gt;<a class="code" href="structFITScards.html#ad1be9be894e41dec8131959f119b387c">cards</a>[i++], &amp;keytype, &amp;f_status);
<a name="l00280"></a>00280     sprintf(templt,<span class="stringliteral">&quot;REFPNTY = %f / y coord. of reference point&quot;</span>,b-&gt;<a class="code" href="structbeam.html#a54c64670a8b3e8732c1468d156ddb0ca">refpoint</a>.<a class="code" href="structd__point.html#ad9846a025508bf8873a501ca5fcefbf4">y</a>);
<a name="l00281"></a>00281     fits_parse_template (templt, cards-&gt;<a class="code" href="structFITScards.html#ad1be9be894e41dec8131959f119b387c">cards</a>[i++], &amp;keytype, &amp;f_status);
<a name="l00282"></a>00282     sprintf(templt,<span class="stringliteral">&quot;C0X = %d / x coord. of 1st bounding quadrangle corner&quot;</span>,b-&gt;<a class="code" href="structbeam.html#a785bab6bf808db6a8841654312d20899">corners</a>[0].<a class="code" href="structpx__point.html#ab715a558731a820a25b50bd7797dd004">x</a>);
<a name="l00283"></a>00283     fits_parse_template (templt, cards-&gt;<a class="code" href="structFITScards.html#ad1be9be894e41dec8131959f119b387c">cards</a>[i++], &amp;keytype, &amp;f_status);
<a name="l00284"></a>00284     sprintf(templt,<span class="stringliteral">&quot;C0Y = %d / y coord. of 1st bounding quadrangle corner&quot;</span>,b-&gt;<a class="code" href="structbeam.html#a785bab6bf808db6a8841654312d20899">corners</a>[0].<a class="code" href="structpx__point.html#a2d02b900722a71f22a8d5100822bda61">y</a>);
<a name="l00285"></a>00285     fits_parse_template (templt, cards-&gt;<a class="code" href="structFITScards.html#ad1be9be894e41dec8131959f119b387c">cards</a>[i++], &amp;keytype, &amp;f_status);
<a name="l00286"></a>00286     sprintf(templt,<span class="stringliteral">&quot;C1X = %d / x coord. of 2nd bounding quadrangle corner&quot;</span>,b-&gt;<a class="code" href="structbeam.html#a785bab6bf808db6a8841654312d20899">corners</a>[1].<a class="code" href="structpx__point.html#ab715a558731a820a25b50bd7797dd004">x</a>);
<a name="l00287"></a>00287     fits_parse_template (templt, cards-&gt;<a class="code" href="structFITScards.html#ad1be9be894e41dec8131959f119b387c">cards</a>[i++], &amp;keytype, &amp;f_status);
<a name="l00288"></a>00288     sprintf(templt,<span class="stringliteral">&quot;C1Y = %d / y coord. of 2nd bounding quadrangle corner&quot;</span>,b-&gt;<a class="code" href="structbeam.html#a785bab6bf808db6a8841654312d20899">corners</a>[1].<a class="code" href="structpx__point.html#a2d02b900722a71f22a8d5100822bda61">y</a>);
<a name="l00289"></a>00289     fits_parse_template (templt, cards-&gt;<a class="code" href="structFITScards.html#ad1be9be894e41dec8131959f119b387c">cards</a>[i++], &amp;keytype, &amp;f_status);
<a name="l00290"></a>00290     sprintf(templt,<span class="stringliteral">&quot;C2X = %d / x coord. of 3rd bounding quadrangle corner&quot;</span>,b-&gt;<a class="code" href="structbeam.html#a785bab6bf808db6a8841654312d20899">corners</a>[2].<a class="code" href="structpx__point.html#ab715a558731a820a25b50bd7797dd004">x</a>);
<a name="l00291"></a>00291     fits_parse_template (templt, cards-&gt;<a class="code" href="structFITScards.html#ad1be9be894e41dec8131959f119b387c">cards</a>[i++], &amp;keytype, &amp;f_status);
<a name="l00292"></a>00292     sprintf(templt,<span class="stringliteral">&quot;C2Y = %d / y coord. of 3rd bounding quadrangle corner&quot;</span>,b-&gt;<a class="code" href="structbeam.html#a785bab6bf808db6a8841654312d20899">corners</a>[2].<a class="code" href="structpx__point.html#a2d02b900722a71f22a8d5100822bda61">y</a>);
<a name="l00293"></a>00293     fits_parse_template (templt, cards-&gt;<a class="code" href="structFITScards.html#ad1be9be894e41dec8131959f119b387c">cards</a>[i++], &amp;keytype, &amp;f_status);
<a name="l00294"></a>00294     sprintf(templt,<span class="stringliteral">&quot;C3X = %d / x coord. of 4th bounding quadrangle corner&quot;</span>,b-&gt;<a class="code" href="structbeam.html#a785bab6bf808db6a8841654312d20899">corners</a>[3].<a class="code" href="structpx__point.html#ab715a558731a820a25b50bd7797dd004">x</a>);
<a name="l00295"></a>00295     fits_parse_template (templt, cards-&gt;<a class="code" href="structFITScards.html#ad1be9be894e41dec8131959f119b387c">cards</a>[i++], &amp;keytype, &amp;f_status);
<a name="l00296"></a>00296     sprintf(templt,<span class="stringliteral">&quot;C3Y = %d / y coord. of 4th bounding quadrangle corner&quot;</span>,b-&gt;<a class="code" href="structbeam.html#a785bab6bf808db6a8841654312d20899">corners</a>[3].<a class="code" href="structpx__point.html#a2d02b900722a71f22a8d5100822bda61">y</a>);
<a name="l00297"></a>00297     fits_parse_template (templt, cards-&gt;<a class="code" href="structFITScards.html#ad1be9be894e41dec8131959f119b387c">cards</a>[i++], &amp;keytype, &amp;f_status);
<a name="l00298"></a>00298     sprintf(templt,<span class="stringliteral">&quot;BB0X = %d / x coord. of 1st bounding box corner&quot;</span>,b-&gt;<a class="code" href="structbeam.html#aa703d04290c347c35197ff52993b98f3">bbox</a>[0].<a class="code" href="structpx__point.html#ab715a558731a820a25b50bd7797dd004">x</a>);
<a name="l00299"></a>00299     fits_parse_template (templt, cards-&gt;<a class="code" href="structFITScards.html#ad1be9be894e41dec8131959f119b387c">cards</a>[i++], &amp;keytype, &amp;f_status);
<a name="l00300"></a>00300     sprintf(templt,<span class="stringliteral">&quot;BB0Y = %d / y coord. of 1st bounding box corner&quot;</span>,b-&gt;<a class="code" href="structbeam.html#aa703d04290c347c35197ff52993b98f3">bbox</a>[0].<a class="code" href="structpx__point.html#a2d02b900722a71f22a8d5100822bda61">y</a>);
<a name="l00301"></a>00301     fits_parse_template (templt, cards-&gt;<a class="code" href="structFITScards.html#ad1be9be894e41dec8131959f119b387c">cards</a>[i++], &amp;keytype, &amp;f_status);
<a name="l00302"></a>00302     sprintf(templt,<span class="stringliteral">&quot;BB1X = %d / x coord. of 2nd bounding box corner&quot;</span>,b-&gt;<a class="code" href="structbeam.html#aa703d04290c347c35197ff52993b98f3">bbox</a>[1].<a class="code" href="structpx__point.html#ab715a558731a820a25b50bd7797dd004">x</a>);
<a name="l00303"></a>00303     fits_parse_template (templt, cards-&gt;<a class="code" href="structFITScards.html#ad1be9be894e41dec8131959f119b387c">cards</a>[i++], &amp;keytype, &amp;f_status);
<a name="l00304"></a>00304     sprintf(templt,<span class="stringliteral">&quot;BB1Y = %d / y coord. of 2nd bounding box corner&quot;</span>,b-&gt;<a class="code" href="structbeam.html#aa703d04290c347c35197ff52993b98f3">bbox</a>[1].<a class="code" href="structpx__point.html#a2d02b900722a71f22a8d5100822bda61">y</a>);
<a name="l00305"></a>00305     fits_parse_template (templt, cards-&gt;<a class="code" href="structFITScards.html#ad1be9be894e41dec8131959f119b387c">cards</a>[i++], &amp;keytype, &amp;f_status);
<a name="l00306"></a>00306     sprintf(templt,<span class="stringliteral">&quot;WIDTH = %f / Width of object in pixel&quot;</span>,b-&gt;<a class="code" href="structbeam.html#ae99ff960c070381b6e76af5a58cb9c45">width</a>);
<a name="l00307"></a>00307     fits_parse_template (templt, cards-&gt;<a class="code" href="structFITScards.html#ad1be9be894e41dec8131959f119b387c">cards</a>[i++], &amp;keytype, &amp;f_status);
<a name="l00308"></a>00308     sprintf(templt,<span class="stringliteral">&quot;DRZWIDTH = %f / Width of object in pixel&quot;</span>,drizzle_width);
<a name="l00309"></a>00309     fits_parse_template (templt, cards-&gt;<a class="code" href="structFITScards.html#ad1be9be894e41dec8131959f119b387c">cards</a>[i++], &amp;keytype, &amp;f_status);
<a name="l00310"></a>00310     sprintf(templt,<span class="stringliteral">&quot;LENGTH= %i / Length of object in pixel&quot;</span>,trlength);
<a name="l00311"></a>00311     fits_parse_template (templt, cards-&gt;<a class="code" href="structFITScards.html#ad1be9be894e41dec8131959f119b387c">cards</a>[i++], &amp;keytype, &amp;f_status);
<a name="l00312"></a>00312     sprintf(templt,<span class="stringliteral">&quot;OWIDTH= %f / Maximum width of object in pixel&quot;</span>,objwidth);
<a name="l00313"></a>00313     fits_parse_template (templt, cards-&gt;<a class="code" href="structFITScards.html#ad1be9be894e41dec8131959f119b387c">cards</a>[i++], &amp;keytype, &amp;f_status);
<a name="l00314"></a>00314     <span class="comment">/* Angle reference frame is converted from aXe&apos;s to SeXtractor */</span>
<a name="l00315"></a>00315     sprintf(templt,<span class="stringliteral">&quot;ORIENT = %f / Orientation of object in deg. wrt y-axis, CCW&quot;</span>,((b-&gt;<a class="code" href="structbeam.html#a362f20c7f29a9d08731a03939103c8c1">orient</a>) / M_PI * 180. - 180.));
<a name="l00316"></a>00316     fits_parse_template (templt, cards-&gt;<a class="code" href="structFITScards.html#ad1be9be894e41dec8131959f119b387c">cards</a>[i++], &amp;keytype, &amp;f_status);
<a name="l00317"></a>00317     sprintf(templt,<span class="stringliteral">&quot;IGNORE = %d / Ignore flag for this beam&quot;</span>,b-&gt;<a class="code" href="structbeam.html#a8c7dc459dedfd957741d35c59440972f">ignore</a>);
<a name="l00318"></a>00318     fits_parse_template (templt, cards-&gt;<a class="code" href="structFITScards.html#ad1be9be894e41dec8131959f119b387c">cards</a>[i++], &amp;keytype, &amp;f_status);
<a name="l00319"></a>00319     sprintf(templt,<span class="stringliteral">&quot;OREFPNTX = %f / x coord. of reference point&quot;</span>,outref.<a class="code" href="structd__point.html#a922a3b5d82a119168ba85e5f939d02c3">x</a>);
<a name="l00320"></a>00320     fits_parse_template (templt, cards-&gt;<a class="code" href="structFITScards.html#ad1be9be894e41dec8131959f119b387c">cards</a>[i++], &amp;keytype, &amp;f_status);
<a name="l00321"></a>00321     sprintf(templt,<span class="stringliteral">&quot;OREFPNTY = %f / y coord. of reference point&quot;</span>,outref.<a class="code" href="structd__point.html#ad9846a025508bf8873a501ca5fcefbf4">y</a>);
<a name="l00322"></a>00322     fits_parse_template (templt, cards-&gt;<a class="code" href="structFITScards.html#ad1be9be894e41dec8131959f119b387c">cards</a>[i++], &amp;keytype, &amp;f_status);
<a name="l00323"></a>00323     sprintf(templt,<span class="stringliteral">&quot;RREFPNTX = %f / x coord. of refpoint in stamp image&quot;</span>,relx);
<a name="l00324"></a>00324     fits_parse_template (templt, cards-&gt;<a class="code" href="structFITScards.html#ad1be9be894e41dec8131959f119b387c">cards</a>[i++], &amp;keytype, &amp;f_status);
<a name="l00325"></a>00325     sprintf(templt,<span class="stringliteral">&quot;RREFPNTY = %f / y coord. of refpoint in stamp image&quot;</span>,rely);
<a name="l00326"></a>00326     fits_parse_template (templt, cards-&gt;<a class="code" href="structFITScards.html#ad1be9be894e41dec8131959f119b387c">cards</a>[i++], &amp;keytype, &amp;f_status);
<a name="l00327"></a>00327     sprintf(templt,<span class="stringliteral">&quot;WAVPNTX = %f / x coord. of reference point&quot;</span>, refwave_pos.<a class="code" href="structd__point.html#a922a3b5d82a119168ba85e5f939d02c3">x</a>);
<a name="l00328"></a>00328     fits_parse_template (templt, cards-&gt;<a class="code" href="structFITScards.html#ad1be9be894e41dec8131959f119b387c">cards</a>[i++], &amp;keytype, &amp;f_status);
<a name="l00329"></a>00329     sprintf(templt,<span class="stringliteral">&quot;WAVPNTY = %f / y coord. of reference point&quot;</span>, refwave_pos.<a class="code" href="structd__point.html#ad9846a025508bf8873a501ca5fcefbf4">y</a>);
<a name="l00330"></a>00330     fits_parse_template (templt, cards-&gt;<a class="code" href="structFITScards.html#ad1be9be894e41dec8131959f119b387c">cards</a>[i++], &amp;keytype, &amp;f_status);
<a name="l00331"></a>00331     sprintf(templt,<span class="stringliteral">&quot;XOFFS = %f / x-offset after drizzling&quot;</span>,conf-&gt;<a class="code" href="structaperture__conf.html#a7d7bf7ed2754c7f93315ae89a783f547">drz_xstart</a>);
<a name="l00332"></a>00332     fits_parse_template (templt, cards-&gt;<a class="code" href="structFITScards.html#ad1be9be894e41dec8131959f119b387c">cards</a>[i++], &amp;keytype, &amp;f_status);
<a name="l00333"></a>00333     sprintf(templt,<span class="stringliteral">&quot;LAMBDA0 = %f / wavelength drizzled to&quot;</span>,conf-&gt;<a class="code" href="structaperture__conf.html#a6ef4ef7172cdee4e54e27fc5c648a7f2">drz_lamb0</a>);
<a name="l00334"></a>00334     fits_parse_template (templt, cards-&gt;<a class="code" href="structFITScards.html#ad1be9be894e41dec8131959f119b387c">cards</a>[i++], &amp;keytype, &amp;f_status);
<a name="l00335"></a>00335     sprintf(templt,<span class="stringliteral">&quot;DLAMBDA = %f / wavelength increment drizzled to&quot;</span>,conf-&gt;<a class="code" href="structaperture__conf.html#a0fb034d1b39c351699420312b2c58d76">drz_resol</a>);
<a name="l00336"></a>00336     fits_parse_template (templt, cards-&gt;<a class="code" href="structFITScards.html#ad1be9be894e41dec8131959f119b387c">cards</a>[i++], &amp;keytype, &amp;f_status);
<a name="l00337"></a>00337     sprintf(templt,<span class="stringliteral">&quot;SKY_CPS = %f / electrons per second in the background&quot;</span>,sky_cps);
<a name="l00338"></a>00338     fits_parse_template (templt, cards-&gt;<a class="code" href="structFITScards.html#ad1be9be894e41dec8131959f119b387c">cards</a>[i++], &amp;keytype, &amp;f_status);
<a name="l00339"></a>00339     sprintf(templt,<span class="stringliteral">&quot;CDSCALE = %f / pixel scale in cross dispersion&quot;</span>,cdref);
<a name="l00340"></a>00340     fits_parse_template (templt, cards-&gt;<a class="code" href="structFITScards.html#ad1be9be894e41dec8131959f119b387c">cards</a>[i++], &amp;keytype, &amp;f_status);
<a name="l00341"></a>00341     sprintf(templt,<span class="stringliteral">&quot;SPCORR = %f / correction factor resolution&quot;</span>,spcorr);
<a name="l00342"></a>00342     fits_parse_template (templt, cards-&gt;<a class="code" href="structFITScards.html#ad1be9be894e41dec8131959f119b387c">cards</a>[i++], &amp;keytype, &amp;f_status);
<a name="l00343"></a>00343     sprintf(templt,<span class="stringliteral">&quot;SLITWIDT = %f / slit width [pix]&quot;</span>,b-&gt;<a class="code" href="structbeam.html#acc5dfdc4ba4457869ecb2a9395d1273e">slitgeom</a>[2]);
<a name="l00344"></a>00344     fits_parse_template (templt, cards-&gt;<a class="code" href="structFITScards.html#ad1be9be894e41dec8131959f119b387c">cards</a>[i++], &amp;keytype, &amp;f_status);
<a name="l00345"></a>00345     sprintf(templt,<span class="stringliteral">&quot;DRZ00 = %e / drizzle coefficient (0, 0)&quot;</span>,<a class="code" href="aXe__grism_8h.html#acf709ee71c580f1cd65d726ed03200ea">gsl_matrix_get</a>(drizzcoeffs, 0, 0));
<a name="l00346"></a>00346     fits_parse_template (templt, cards-&gt;<a class="code" href="structFITScards.html#ad1be9be894e41dec8131959f119b387c">cards</a>[i++], &amp;keytype, &amp;f_status);
<a name="l00347"></a>00347     sprintf(templt,<span class="stringliteral">&quot;DRZ01 = %e / drizzle coefficient (0, 1)&quot;</span>,<a class="code" href="aXe__grism_8h.html#acf709ee71c580f1cd65d726ed03200ea">gsl_matrix_get</a>(drizzcoeffs, 0, 1));
<a name="l00348"></a>00348     fits_parse_template (templt, cards-&gt;<a class="code" href="structFITScards.html#ad1be9be894e41dec8131959f119b387c">cards</a>[i++], &amp;keytype, &amp;f_status);
<a name="l00349"></a>00349     sprintf(templt,<span class="stringliteral">&quot;DRZ02 = %e / drizzle coefficient (0, 2)&quot;</span>,<a class="code" href="aXe__grism_8h.html#acf709ee71c580f1cd65d726ed03200ea">gsl_matrix_get</a>(drizzcoeffs, 0, 2));
<a name="l00350"></a>00350     fits_parse_template (templt, cards-&gt;<a class="code" href="structFITScards.html#ad1be9be894e41dec8131959f119b387c">cards</a>[i++], &amp;keytype, &amp;f_status);
<a name="l00351"></a>00351     sprintf(templt,<span class="stringliteral">&quot;DRZ03 = %e / drizzle coefficient (0, 3)&quot;</span>,<a class="code" href="aXe__grism_8h.html#acf709ee71c580f1cd65d726ed03200ea">gsl_matrix_get</a>(drizzcoeffs, 0, 3));
<a name="l00352"></a>00352     fits_parse_template (templt, cards-&gt;<a class="code" href="structFITScards.html#ad1be9be894e41dec8131959f119b387c">cards</a>[i++], &amp;keytype, &amp;f_status);
<a name="l00353"></a>00353     sprintf(templt,<span class="stringliteral">&quot;DRZ04 = %e / drizzle coefficient (0, 4)&quot;</span>,<a class="code" href="aXe__grism_8h.html#acf709ee71c580f1cd65d726ed03200ea">gsl_matrix_get</a>(drizzcoeffs, 0, 4));
<a name="l00354"></a>00354     fits_parse_template (templt, cards-&gt;<a class="code" href="structFITScards.html#ad1be9be894e41dec8131959f119b387c">cards</a>[i++], &amp;keytype, &amp;f_status);
<a name="l00355"></a>00355     sprintf(templt,<span class="stringliteral">&quot;DRZ05 = %e / drizzle coefficient (0, 5)&quot;</span>,<a class="code" href="aXe__grism_8h.html#acf709ee71c580f1cd65d726ed03200ea">gsl_matrix_get</a>(drizzcoeffs, 0, 5));
<a name="l00356"></a>00356     fits_parse_template (templt, cards-&gt;<a class="code" href="structFITScards.html#ad1be9be894e41dec8131959f119b387c">cards</a>[i++], &amp;keytype, &amp;f_status);
<a name="l00357"></a>00357     sprintf(templt,<span class="stringliteral">&quot;DRZ06 = %e / drizzle coefficient (0, 6)&quot;</span>,<a class="code" href="aXe__grism_8h.html#acf709ee71c580f1cd65d726ed03200ea">gsl_matrix_get</a>(drizzcoeffs, 0, 6));
<a name="l00358"></a>00358     fits_parse_template (templt, cards-&gt;<a class="code" href="structFITScards.html#ad1be9be894e41dec8131959f119b387c">cards</a>[i++], &amp;keytype, &amp;f_status);
<a name="l00359"></a>00359     sprintf(templt,<span class="stringliteral">&quot;DRZ07 = %e / drizzle coefficient (0, 7)&quot;</span>,<a class="code" href="aXe__grism_8h.html#acf709ee71c580f1cd65d726ed03200ea">gsl_matrix_get</a>(drizzcoeffs, 0, 7));
<a name="l00360"></a>00360     fits_parse_template (templt, cards-&gt;<a class="code" href="structFITScards.html#ad1be9be894e41dec8131959f119b387c">cards</a>[i++], &amp;keytype, &amp;f_status);
<a name="l00361"></a>00361     sprintf(templt,<span class="stringliteral">&quot;DRZ08 = %e / drizzle coefficient (0, 8)&quot;</span>,<a class="code" href="aXe__grism_8h.html#acf709ee71c580f1cd65d726ed03200ea">gsl_matrix_get</a>(drizzcoeffs, 0, 8));
<a name="l00362"></a>00362     fits_parse_template (templt, cards-&gt;<a class="code" href="structFITScards.html#ad1be9be894e41dec8131959f119b387c">cards</a>[i++], &amp;keytype, &amp;f_status);
<a name="l00363"></a>00363     sprintf(templt,<span class="stringliteral">&quot;DRZ09 = %e / drizzle coefficient (0, 9)&quot;</span>,<a class="code" href="aXe__grism_8h.html#acf709ee71c580f1cd65d726ed03200ea">gsl_matrix_get</a>(drizzcoeffs, 0, 9));
<a name="l00364"></a>00364     fits_parse_template (templt, cards-&gt;<a class="code" href="structFITScards.html#ad1be9be894e41dec8131959f119b387c">cards</a>[i++], &amp;keytype, &amp;f_status);
<a name="l00365"></a>00365     sprintf(templt,<span class="stringliteral">&quot;DRZ10 = %e / drizzle coefficient (1, 0)&quot;</span>,<a class="code" href="aXe__grism_8h.html#acf709ee71c580f1cd65d726ed03200ea">gsl_matrix_get</a>(drizzcoeffs, 1, 0));
<a name="l00366"></a>00366     fits_parse_template (templt, cards-&gt;<a class="code" href="structFITScards.html#ad1be9be894e41dec8131959f119b387c">cards</a>[i++], &amp;keytype, &amp;f_status);
<a name="l00367"></a>00367     sprintf(templt,<span class="stringliteral">&quot;DRZ11 = %e / drizzle coefficient (1, 1)&quot;</span>,<a class="code" href="aXe__grism_8h.html#acf709ee71c580f1cd65d726ed03200ea">gsl_matrix_get</a>(drizzcoeffs, 1, 1));
<a name="l00368"></a>00368     fits_parse_template (templt, cards-&gt;<a class="code" href="structFITScards.html#ad1be9be894e41dec8131959f119b387c">cards</a>[i++], &amp;keytype, &amp;f_status);
<a name="l00369"></a>00369     sprintf(templt,<span class="stringliteral">&quot;DRZ12 = %e / drizzle coefficient (1, 2)&quot;</span>,<a class="code" href="aXe__grism_8h.html#acf709ee71c580f1cd65d726ed03200ea">gsl_matrix_get</a>(drizzcoeffs, 1, 2));
<a name="l00370"></a>00370     fits_parse_template (templt, cards-&gt;<a class="code" href="structFITScards.html#ad1be9be894e41dec8131959f119b387c">cards</a>[i++], &amp;keytype, &amp;f_status);
<a name="l00371"></a>00371     sprintf(templt,<span class="stringliteral">&quot;DRZ13 = %e / drizzle coefficient (1, 3)&quot;</span>,<a class="code" href="aXe__grism_8h.html#acf709ee71c580f1cd65d726ed03200ea">gsl_matrix_get</a>(drizzcoeffs, 1, 3));
<a name="l00372"></a>00372     fits_parse_template (templt, cards-&gt;<a class="code" href="structFITScards.html#ad1be9be894e41dec8131959f119b387c">cards</a>[i++], &amp;keytype, &amp;f_status);
<a name="l00373"></a>00373     sprintf(templt,<span class="stringliteral">&quot;DRZ14 = %e / drizzle coefficient (1, 4)&quot;</span>,<a class="code" href="aXe__grism_8h.html#acf709ee71c580f1cd65d726ed03200ea">gsl_matrix_get</a>(drizzcoeffs, 1, 4));
<a name="l00374"></a>00374     fits_parse_template (templt, cards-&gt;<a class="code" href="structFITScards.html#ad1be9be894e41dec8131959f119b387c">cards</a>[i++], &amp;keytype, &amp;f_status);
<a name="l00375"></a>00375     sprintf(templt,<span class="stringliteral">&quot;DRZ15 = %e / drizzle coefficient (1, 5)&quot;</span>,<a class="code" href="aXe__grism_8h.html#acf709ee71c580f1cd65d726ed03200ea">gsl_matrix_get</a>(drizzcoeffs, 1, 5));
<a name="l00376"></a>00376     fits_parse_template (templt, cards-&gt;<a class="code" href="structFITScards.html#ad1be9be894e41dec8131959f119b387c">cards</a>[i++], &amp;keytype, &amp;f_status);
<a name="l00377"></a>00377     sprintf(templt,<span class="stringliteral">&quot;DRZ16 = %e / drizzle coefficient (1, 6)&quot;</span>,<a class="code" href="aXe__grism_8h.html#acf709ee71c580f1cd65d726ed03200ea">gsl_matrix_get</a>(drizzcoeffs, 1, 6));
<a name="l00378"></a>00378     fits_parse_template (templt, cards-&gt;<a class="code" href="structFITScards.html#ad1be9be894e41dec8131959f119b387c">cards</a>[i++], &amp;keytype, &amp;f_status);
<a name="l00379"></a>00379     sprintf(templt,<span class="stringliteral">&quot;DRZ17 = %e / drizzle coefficient (1, 7)&quot;</span>,<a class="code" href="aXe__grism_8h.html#acf709ee71c580f1cd65d726ed03200ea">gsl_matrix_get</a>(drizzcoeffs, 1, 7));
<a name="l00380"></a>00380     fits_parse_template (templt, cards-&gt;<a class="code" href="structFITScards.html#ad1be9be894e41dec8131959f119b387c">cards</a>[i++], &amp;keytype, &amp;f_status);
<a name="l00381"></a>00381     sprintf(templt,<span class="stringliteral">&quot;DRZ18 = %e / drizzle coefficient (1, 8)&quot;</span>,<a class="code" href="aXe__grism_8h.html#acf709ee71c580f1cd65d726ed03200ea">gsl_matrix_get</a>(drizzcoeffs, 1, 8));
<a name="l00382"></a>00382     fits_parse_template (templt, cards-&gt;<a class="code" href="structFITScards.html#ad1be9be894e41dec8131959f119b387c">cards</a>[i++], &amp;keytype, &amp;f_status);
<a name="l00383"></a>00383     sprintf(templt,<span class="stringliteral">&quot;DRZ19 = %e / drizzle coefficient (1, 9)&quot;</span>,<a class="code" href="aXe__grism_8h.html#acf709ee71c580f1cd65d726ed03200ea">gsl_matrix_get</a>(drizzcoeffs, 1, 9));
<a name="l00384"></a>00384     fits_parse_template (templt, cards-&gt;<a class="code" href="structFITScards.html#ad1be9be894e41dec8131959f119b387c">cards</a>[i++], &amp;keytype, &amp;f_status);
<a name="l00385"></a>00385 
<a name="l00386"></a>00386     <span class="keywordflow">return</span> cards;
<a name="l00387"></a>00387 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="aaaba4aea09f708f12bf52e9446e5384b"></a><!-- doxytag: member="spc_FITScards.c::free_FITScards" ref="aaaba4aea09f708f12bf52e9446e5384b" args="(FITScards *cards)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void free_FITScards </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structFITScards.html">FITScards</a> *&nbsp;</td>
          <td class="paramname"> <em>cards</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Routine to free a <a class="el" href="structFITScards.html">FITScards</a> structure.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>cards</em>&nbsp;</td><td>a pointer to an allocated <a class="el" href="structFITScards.html">FITScards</a> structure whose allocated memory is to be free'd. </td></tr>
  </table>
  </dd>
</dl>

<p><div class="fragment"><pre class="fragment"><a name="l00052"></a>00052 {
<a name="l00053"></a>00053     <span class="keywordtype">int</span> i;
<a name="l00054"></a>00054     <span class="keywordflow">for</span> (i=0;i&lt;cards-&gt;<a class="code" href="structFITScards.html#ae541232523495d8487f2d47d2ad71873">n</a>;i++)
<a name="l00055"></a>00055       free(cards-&gt;<a class="code" href="structFITScards.html#ad1be9be894e41dec8131959f119b387c">cards</a>[i]);
<a name="l00056"></a>00056 
<a name="l00057"></a>00057     free(cards-&gt;<a class="code" href="structFITScards.html#ad1be9be894e41dec8131959f119b387c">cards</a>);
<a name="l00058"></a>00058     free(cards);
<a name="l00059"></a>00059 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a7a09d3f4ae7b2068f051e00781080751"></a><!-- doxytag: member="spc_FITScards.c::get_WCS_FITScards" ref="a7a09d3f4ae7b2068f051e00781080751" args="(const double rval1, const double delta1, const double rval2)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structFITScards.html">FITScards</a>* get_WCS_FITScards </td>
          <td>(</td>
          <td class="paramtype">const double&nbsp;</td>
          <td class="paramname"> <em>rval1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&nbsp;</td>
          <td class="paramname"> <em>delta1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&nbsp;</td>
          <td class="paramname"> <em>rval2</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p><div class="fragment"><pre class="fragment"><a name="l00074"></a>00074 {
<a name="l00075"></a>00075   <span class="keywordtype">char</span> templt[FLEN_CARD];
<a name="l00076"></a>00076   <span class="keywordtype">int</span> i=0,keytype, f_status=0;
<a name="l00077"></a>00077 
<a name="l00078"></a>00078   <a class="code" href="structFITScards.html">FITScards</a> *cards;
<a name="l00079"></a>00079 
<a name="l00080"></a>00080   cards = <a class="code" href="spc__FITScards_8c.html#a2b3df1d707d609ec92e837b96e79140d">allocate_FITScards</a>(10);
<a name="l00081"></a>00081 
<a name="l00082"></a>00082   i=0;
<a name="l00083"></a>00083 
<a name="l00084"></a>00084   <span class="comment">// fill the cards for the first (dispersion) axis</span>
<a name="l00085"></a>00085   sprintf(templt,<span class="stringliteral">&quot;CTYPE1 = &apos;WAVE&apos; / Grating dispersion function&quot;</span>);
<a name="l00086"></a>00086   fits_parse_template (templt, cards-&gt;<a class="code" href="structFITScards.html#ad1be9be894e41dec8131959f119b387c">cards</a>[i++], &amp;keytype, &amp;f_status);
<a name="l00087"></a>00087   sprintf(templt,<span class="stringliteral">&quot;CUNIT1 = &apos;Angstrom&apos; / Dispersion units&quot;</span>);
<a name="l00088"></a>00088   fits_parse_template (templt, cards-&gt;<a class="code" href="structFITScards.html#ad1be9be894e41dec8131959f119b387c">cards</a>[i++], &amp;keytype, &amp;f_status);
<a name="l00089"></a>00089   sprintf(templt,<span class="stringliteral">&quot;CRPIX1 = %f / [pixel] Reference pixel&quot;</span>,1.0);
<a name="l00090"></a>00090   fits_parse_template (templt, cards-&gt;<a class="code" href="structFITScards.html#ad1be9be894e41dec8131959f119b387c">cards</a>[i++], &amp;keytype, &amp;f_status);
<a name="l00091"></a>00091   sprintf(templt,<span class="stringliteral">&quot;CRVAL1 = %f / [Angstrom] Reference value&quot;</span>,rval1);
<a name="l00092"></a>00092   fits_parse_template (templt, cards-&gt;<a class="code" href="structFITScards.html#ad1be9be894e41dec8131959f119b387c">cards</a>[i++], &amp;keytype, &amp;f_status);
<a name="l00093"></a>00093   sprintf(templt,<span class="stringliteral">&quot;CDELT1 = %f / [Angstrom/pixel] dispersion&quot;</span>,delta1);
<a name="l00094"></a>00094   fits_parse_template (templt, cards-&gt;<a class="code" href="structFITScards.html#ad1be9be894e41dec8131959f119b387c">cards</a>[i++], &amp;keytype, &amp;f_status);
<a name="l00095"></a>00095 
<a name="l00096"></a>00096   <span class="comment">// fill the cards for the second (cross-dispersion) axis</span>
<a name="l00097"></a>00097   sprintf(templt,<span class="stringliteral">&quot;CTYPE2 = &apos;CRDIST&apos; / Cross-dispersion distance&quot;</span>);
<a name="l00098"></a>00098   fits_parse_template (templt, cards-&gt;<a class="code" href="structFITScards.html#ad1be9be894e41dec8131959f119b387c">cards</a>[i++], &amp;keytype, &amp;f_status);
<a name="l00099"></a>00099   sprintf(templt,<span class="stringliteral">&quot;CUNIT2 = &apos;Pixel&apos; / Cross-dispersion units&quot;</span>);
<a name="l00100"></a>00100   fits_parse_template (templt, cards-&gt;<a class="code" href="structFITScards.html#ad1be9be894e41dec8131959f119b387c">cards</a>[i++], &amp;keytype, &amp;f_status);
<a name="l00101"></a>00101   sprintf(templt,<span class="stringliteral">&quot;CRPIX2 = %f / [pixel] Reference pixel&quot;</span>,1.0);
<a name="l00102"></a>00102   fits_parse_template (templt, cards-&gt;<a class="code" href="structFITScards.html#ad1be9be894e41dec8131959f119b387c">cards</a>[i++], &amp;keytype, &amp;f_status);
<a name="l00103"></a>00103   sprintf(templt,<span class="stringliteral">&quot;CRVAL2 = %f / [pixel] Reference value&quot;</span>,rval2);
<a name="l00104"></a>00104   fits_parse_template (templt, cards-&gt;<a class="code" href="structFITScards.html#ad1be9be894e41dec8131959f119b387c">cards</a>[i++], &amp;keytype, &amp;f_status);
<a name="l00105"></a>00105   sprintf(templt,<span class="stringliteral">&quot;CDELT2 = %f / [pixel/pixel] increment&quot;</span>,1.0);
<a name="l00106"></a>00106   fits_parse_template (templt, cards-&gt;<a class="code" href="structFITScards.html#ad1be9be894e41dec8131959f119b387c">cards</a>[i++], &amp;keytype, &amp;f_status);
<a name="l00107"></a>00107 
<a name="l00108"></a>00108   <span class="keywordflow">return</span> cards;
<a name="l00109"></a>00109 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="af17c0df011aa3245c5aecb6bf5d0b9b1"></a><!-- doxytag: member="spc_FITScards.c::nicbck_info_to_FITScards" ref="af17c0df011aa3245c5aecb6bf5d0b9b1" args="(const double skypix_frac, const double scale_factor, const double offset)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structFITScards.html">FITScards</a>* nicbck_info_to_FITScards </td>
          <td>(</td>
          <td class="paramtype">const double&nbsp;</td>
          <td class="paramname"> <em>skypix_frac</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&nbsp;</td>
          <td class="paramname"> <em>scale_factor</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&nbsp;</td>
          <td class="paramname"> <em>offset</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p><div class="fragment"><pre class="fragment"><a name="l00392"></a>00392 {
<a name="l00393"></a>00393     <span class="keywordtype">char</span> templt[FLEN_CARD];
<a name="l00394"></a>00394     <span class="keywordtype">int</span> i=0,keytype, f_status=0;
<a name="l00395"></a>00395 
<a name="l00396"></a>00396     <a class="code" href="structFITScards.html">FITScards</a> *cards;
<a name="l00397"></a>00397 
<a name="l00398"></a>00398     cards = <a class="code" href="spc__FITScards_8c.html#a2b3df1d707d609ec92e837b96e79140d">allocate_FITScards</a>(3);
<a name="l00399"></a>00399 
<a name="l00400"></a>00400     i=0;
<a name="l00401"></a>00401     sprintf(templt,<span class="stringliteral">&quot;SKY_SCAL = %e / Scale factor for background&quot;</span>, scale_factor);
<a name="l00402"></a>00402     fits_parse_template (templt, cards-&gt;<a class="code" href="structFITScards.html#ad1be9be894e41dec8131959f119b387c">cards</a>[i++], &amp;keytype, &amp;f_status);
<a name="l00403"></a>00403     sprintf(templt,<span class="stringliteral">&quot;SKY_OFFS = %e / Offset value for background&quot;</span>, offset);
<a name="l00404"></a>00404     fits_parse_template (templt, cards-&gt;<a class="code" href="structFITScards.html#ad1be9be894e41dec8131959f119b387c">cards</a>[i++], &amp;keytype, &amp;f_status);
<a name="l00405"></a>00405     sprintf(templt,<span class="stringliteral">&quot;F_SKYPIX = %e / Fraction of sky pixels&quot;</span>, skypix_frac);
<a name="l00406"></a>00406     fits_parse_template (templt, cards-&gt;<a class="code" href="structFITScards.html#ad1be9be894e41dec8131959f119b387c">cards</a>[i++], &amp;keytype, &amp;f_status);
<a name="l00407"></a>00407 
<a name="l00408"></a>00408     <span class="keywordflow">return</span> cards;
<a name="l00409"></a>00409 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a1c59aaa35e0ecd19cbbfc7d65b1cdf3a"></a><!-- doxytag: member="spc_FITScards.c::stpmin_to_FITScards" ref="a1c59aaa35e0ecd19cbbfc7d65b1cdf3a" args="(d_point stp_min)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structFITScards.html">FITScards</a>* stpmin_to_FITScards </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structd__point.html">d_point</a>&nbsp;</td>
          <td class="paramname"> <em>stp_min</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p><div class="fragment"><pre class="fragment"><a name="l00204"></a>00204 {
<a name="l00205"></a>00205     <span class="keywordtype">char</span> templt[FLEN_CARD];
<a name="l00206"></a>00206     <span class="keywordtype">int</span> i=0,keytype, f_status=0;
<a name="l00207"></a>00207 
<a name="l00208"></a>00208     <a class="code" href="structFITScards.html">FITScards</a> *cards;
<a name="l00209"></a>00209 
<a name="l00210"></a>00210     cards = <a class="code" href="spc__FITScards_8c.html#a2b3df1d707d609ec92e837b96e79140d">allocate_FITScards</a>(2);
<a name="l00211"></a>00211 
<a name="l00212"></a>00212     i=0;
<a name="l00213"></a>00213     sprintf(templt,<span class="stringliteral">&quot;XINISTP = %f / starting x-coordinate of stamp image&quot;</span>,stp_min.<a class="code" href="structd__point.html#a922a3b5d82a119168ba85e5f939d02c3">x</a>);
<a name="l00214"></a>00214     fits_parse_template (templt, cards-&gt;<a class="code" href="structFITScards.html#ad1be9be894e41dec8131959f119b387c">cards</a>[i++], &amp;keytype, &amp;f_status);
<a name="l00215"></a>00215     sprintf(templt,<span class="stringliteral">&quot;YINISTP = %f / starting y-coordinate of stamp image&quot;</span>,stp_min.<a class="code" href="structd__point.html#ad9846a025508bf8873a501ca5fcefbf4">y</a>);
<a name="l00216"></a>00216     fits_parse_template (templt, cards-&gt;<a class="code" href="structFITScards.html#ad1be9be894e41dec8131959f119b387c">cards</a>[i++], &amp;keytype, &amp;f_status);
<a name="l00217"></a>00217 
<a name="l00218"></a>00218     <span class="keywordflow">return</span> cards;
<a name="l00219"></a>00219 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a471d2609ea9bc328e07b18489922f5d2"></a><!-- doxytag: member="spc_FITScards.c::transport_cont_modname" ref="a471d2609ea9bc328e07b18489922f5d2" args="(char grism_file_path[], char PET_file_path[])" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void transport_cont_modname </td>
          <td>(</td>
          <td class="paramtype">char&nbsp;</td>
          <td class="paramname"> <em>grism_file_path</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char&nbsp;</td>
          <td class="paramname"> <em>PET_file_path</em>[]</td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>The function transports the keywird entry for the keyword "CONTAM" from one FITS file to another. As the parameter names suggest, this works particularly form drizzle grism images to PET's</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>grism_file_path</em>&nbsp;</td><td>- the name of the input FITS file </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>PET_file_path</em>&nbsp;</td><td>- the name of the output FITS file </td></tr>
  </table>
  </dd>
</dl>

<p><div class="fragment"><pre class="fragment"><a name="l00548"></a>00548 {
<a name="l00549"></a>00549 
<a name="l00550"></a>00550   fitsfile *in_fptr;
<a name="l00551"></a>00551   fitsfile *ou_fptr;
<a name="l00552"></a>00552 
<a name="l00553"></a>00553   <span class="keywordtype">char</span> keyval[FLEN_CARD];
<a name="l00554"></a>00554   <span class="keywordtype">char</span> keyw[FLEN_KEYWORD];
<a name="l00555"></a>00555   <span class="keywordtype">char</span> comment[FLEN_COMMENT];
<a name="l00556"></a>00556 
<a name="l00557"></a>00557   <span class="keywordtype">int</span>  f_status=0;
<a name="l00558"></a>00558 
<a name="l00559"></a>00559   <span class="comment">// open the input FITS file</span>
<a name="l00560"></a>00560   fits_open_file (&amp;in_fptr, grism_file_path, READONLY, &amp;f_status);
<a name="l00561"></a>00561   <span class="keywordflow">if</span> (f_status)
<a name="l00562"></a>00562     {
<a name="l00563"></a>00563       ffrprt (stderr, f_status);
<a name="l00564"></a>00564       <a class="code" href="aXe__errors_8c.html#a7ef7588e5f91237ba7ce4084e6ed3c11">aXe_message</a> (<a class="code" href="aXe__errors_8h.html#a2556a67874555249b07691c37aa6d6e9">aXe_M_FATAL</a>, __FILE__, __LINE__,
<a name="l00565"></a>00565                    <span class="stringliteral">&quot;transport_cont_modname: Could not open file %s .\n&quot;</span>, grism_file_path);
<a name="l00566"></a>00566     }
<a name="l00567"></a>00567 
<a name="l00568"></a>00568   <span class="comment">// name the keyword variable</span>
<a name="l00569"></a>00569   sprintf(keyw,<span class="stringliteral">&quot;CONTAM&quot;</span>);
<a name="l00570"></a>00570 
<a name="l00571"></a>00571   <span class="comment">// read the contamination keyword from the input file</span>
<a name="l00572"></a>00572   fits_read_key(in_fptr, TSTRING, keyw, keyval, comment, &amp;f_status);
<a name="l00573"></a>00573   <span class="keywordflow">if</span> (f_status)
<a name="l00574"></a>00574     {
<a name="l00575"></a>00575       ffrprt (stderr, f_status);
<a name="l00576"></a>00576       <a class="code" href="aXe__errors_8c.html#a7ef7588e5f91237ba7ce4084e6ed3c11">aXe_message</a> (<a class="code" href="aXe__errors_8h.html#a2556a67874555249b07691c37aa6d6e9">aXe_M_FATAL</a>, __FILE__, __LINE__,
<a name="l00577"></a>00577                    <span class="stringliteral">&quot;transport_cont_modname: Could not read keyword %s from %s.\n&quot;</span>, keyw, grism_file_path);
<a name="l00578"></a>00578     }
<a name="l00579"></a>00579 
<a name="l00580"></a>00580   <span class="comment">// close the input FITSfile</span>
<a name="l00581"></a>00581   fits_close_file (in_fptr, &amp;f_status);
<a name="l00582"></a>00582   <span class="keywordflow">if</span> (f_status)
<a name="l00583"></a>00583     {
<a name="l00584"></a>00584       ffrprt (stderr, f_status);
<a name="l00585"></a>00585       <a class="code" href="aXe__errors_8c.html#a7ef7588e5f91237ba7ce4084e6ed3c11">aXe_message</a> (<a class="code" href="aXe__errors_8h.html#a2556a67874555249b07691c37aa6d6e9">aXe_M_FATAL</a>, __FILE__, __LINE__,
<a name="l00586"></a>00586                    <span class="stringliteral">&quot;transport_cont_modname: Could not close file %s .\n&quot;</span>, grism_file_path);
<a name="l00587"></a>00587     }
<a name="l00588"></a>00588 
<a name="l00589"></a>00589   <span class="comment">// uptdate that keyword in the output FITS-file</span>
<a name="l00590"></a>00590   <span class="comment">// in case that it is not empty</span>
<a name="l00591"></a>00591   <span class="keywordflow">if</span> (strlen(keyval) &gt; 0)
<a name="l00592"></a>00592     {
<a name="l00593"></a>00593 
<a name="l00594"></a>00594       <span class="comment">// open the output FITS file</span>
<a name="l00595"></a>00595       fits_open_file (&amp;ou_fptr, PET_file_path, READWRITE, &amp;f_status);
<a name="l00596"></a>00596       <span class="keywordflow">if</span> (f_status)
<a name="l00597"></a>00597         {
<a name="l00598"></a>00598           ffrprt (stderr, f_status);
<a name="l00599"></a>00599           <a class="code" href="aXe__errors_8c.html#a7ef7588e5f91237ba7ce4084e6ed3c11">aXe_message</a> (<a class="code" href="aXe__errors_8h.html#a2556a67874555249b07691c37aa6d6e9">aXe_M_FATAL</a>, __FILE__, __LINE__,
<a name="l00600"></a>00600                        <span class="stringliteral">&quot;transport_cont_modname: Could not open file %s .\n&quot;</span>, PET_file_path);
<a name="l00601"></a>00601         }
<a name="l00602"></a>00602 
<a name="l00603"></a>00603       <span class="comment">// use the function to update that keyword</span>
<a name="l00604"></a>00604       <a class="code" href="spc__FITScards_8c.html#a6cb1187c647e381a5d1803846ee73a3e">update_contam_model</a>(ou_fptr, keyval);
<a name="l00605"></a>00605 
<a name="l00606"></a>00606 
<a name="l00607"></a>00607       <span class="comment">// close the output FITS file</span>
<a name="l00608"></a>00608       fits_close_file (ou_fptr, &amp;f_status);
<a name="l00609"></a>00609       <span class="keywordflow">if</span> (f_status)
<a name="l00610"></a>00610         {
<a name="l00611"></a>00611           ffrprt (stderr, f_status);
<a name="l00612"></a>00612           <a class="code" href="aXe__errors_8c.html#a7ef7588e5f91237ba7ce4084e6ed3c11">aXe_message</a> (<a class="code" href="aXe__errors_8h.html#a2556a67874555249b07691c37aa6d6e9">aXe_M_FATAL</a>, __FILE__, __LINE__,
<a name="l00613"></a>00613                        <span class="stringliteral">&quot;transport_cont_modname: Could not close file %s .\n&quot;</span>, PET_file_path);
<a name="l00614"></a>00614         }
<a name="l00615"></a>00615     }
<a name="l00616"></a>00616 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a6cb1187c647e381a5d1803846ee73a3e"></a><!-- doxytag: member="spc_FITScards.c::update_contam_model" ref="a6cb1187c647e381a5d1803846ee73a3e" args="(fitsfile *fptr, char model_name[])" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void update_contam_model </td>
          <td>(</td>
          <td class="paramtype">fitsfile *&nbsp;</td>
          <td class="paramname"> <em>fptr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char&nbsp;</td>
          <td class="paramname"> <em>model_name</em>[]</td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>The function updates the keyword "CONTAM" in a fits file. Update means that an existing entry is replace. It is used to update this keyword in a PET files within the command aXe_PETCONT.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>fptr</em>&nbsp;</td><td>- pointer to the fits file </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>model_name</em>&nbsp;</td><td>- the name of the model </td></tr>
  </table>
  </dd>
</dl>

<p><div class="fragment"><pre class="fragment"><a name="l00459"></a>00459 {
<a name="l00460"></a>00460 
<a name="l00461"></a>00461  <span class="comment">//char templt[FLEN_CARD];</span>
<a name="l00462"></a>00462  <span class="keywordtype">char</span> keyw[FLEN_KEYWORD];
<a name="l00463"></a>00463  <span class="keywordtype">char</span> comment[FLEN_COMMENT];
<a name="l00464"></a>00464 
<a name="l00465"></a>00465  <span class="keywordtype">int</span>  f_status=0;
<a name="l00466"></a>00466 
<a name="l00467"></a>00467  <span class="comment">// fill the keyword valiable</span>
<a name="l00468"></a>00468  sprintf(keyw,<span class="stringliteral">&quot;CONTAM&quot;</span>);
<a name="l00469"></a>00469  sprintf(comment,<span class="stringliteral">&quot;Name of the contamination model&quot;</span>);
<a name="l00470"></a>00470 
<a name="l00471"></a>00471  <span class="comment">// use the fitsio routine to update the keyword</span>
<a name="l00472"></a>00472  <span class="comment">// react in case of an error</span>
<a name="l00473"></a>00473  fits_update_key(fptr, TSTRING, keyw, model_name,comment, &amp;f_status);
<a name="l00474"></a>00474  <span class="keywordflow">if</span> (f_status)
<a name="l00475"></a>00475    {
<a name="l00476"></a>00476      ffrprt (stderr, f_status);
<a name="l00477"></a>00477      <a class="code" href="aXe__errors_8c.html#a7ef7588e5f91237ba7ce4084e6ed3c11">aXe_message</a> (<a class="code" href="aXe__errors_8h.html#a2556a67874555249b07691c37aa6d6e9">aXe_M_FATAL</a>, __FILE__, __LINE__,
<a name="l00478"></a>00478                   <span class="stringliteral">&quot;update_contam_model: Could not update the contamination model name.\n&quot;</span>);
<a name="l00479"></a>00479    }
<a name="l00480"></a>00480 }
</pre></div></p>

</div>
</div>
</div>
<!--- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&nbsp;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&nbsp;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&nbsp;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&nbsp;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&nbsp;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&nbsp;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&nbsp;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&nbsp;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&nbsp;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&nbsp;</span>Defines</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<hr size="1"/><address style="text-align: right;"><small>Generated on 12 Oct 2014 for TIPS by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.6.1 </small></address>
</body>
</html>
