<!-- This comment will put IE 6, 7 and 8 in quirks mode -->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>TIPS: /renoir/fourmano/Desktop/OUSIM/TIPS/branches/tips_build/include/axesim/spc_utils.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javaScript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body onload='searchBox.OnSelectItem(0);'>
<!-- Generated by Doxygen 1.6.1 -->
<script type="text/javascript"><!--
var searchBox = new SearchBox("searchBox", "search",false,'Search');
--></script>
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Data&nbsp;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <img id="MSearchSelect" src="search/search.png"
             onmouseover="return searchBox.OnSearchSelectShow()"
             onmouseout="return searchBox.OnSearchSelectHide()"
             alt=""/>
        <input type="text" id="MSearchField" value="Search" accesskey="S"
             onfocus="searchBox.OnSearchFieldFocus(true)" 
             onblur="searchBox.OnSearchFieldFocus(false)" 
             onkeyup="searchBox.OnSearchFieldChange(event)"/>
        <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
        </div>
      </li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="files.html"><span>File&nbsp;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
</div>
<div class="contents">
<h1>/renoir/fourmano/Desktop/OUSIM/TIPS/branches/tips_build/include/axesim/spc_utils.h File Reference</h1><code>#include &lt;stddef.h&gt;</code><br/>
<code>#include &lt;string.h&gt;</code><br/>
<code>#include &lt;stdlib.h&gt;</code><br/>
<code>#include &lt;stdio.h&gt;</code><br/>
<code>#include &lt;ctype.h&gt;</code><br/>
<code>#include &lt;limits.h&gt;</code><br/>
<code>#include &lt;math.h&gt;</code><br/>
<code>#include &lt;gsl/gsl_version.h&gt;</code><br/>
<code>#include &lt;gsl/gsl_nan.h&gt;</code><br/>
<code>#include &lt;gsl/gsl_sys.h&gt;</code><br/>
<code>#include &lt;gsl/gsl_vector.h&gt;</code><br/>
<code>#include &quot;<a class="el" href="aXe__errors_8h_source.html">aXe_errors.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="aXe__grism_8h_source.html">aXe_grism.h</a>&quot;</code><br/>

<p><a href="spc__utils_8h_source.html">Go to the source code of this file.</a></p>
<table border="0" cellpadding="0" cellspacing="0">
<tr><td colspan="2"><h2>Data Structures</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structsexcol.html">sexcol</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structcolinfo.html">colinfo</a></td></tr>
<tr><td colspan="2"><h2>Namespaces</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">namespace &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacespc__utils.html">spc_utils</a></td></tr>
<tr><td colspan="2"><h2>Defines</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="spc__utils_8h.html#a750fb88b0e928a751d106138d9c31ce3">LAMBDACENTRAL</a>&nbsp;&nbsp;&nbsp;8000.0</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="spc__utils_8h.html#a840c8714a6150c8842d085a7de95a5bf">COLNAMELENGTH</a>&nbsp;&nbsp;&nbsp;12</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="spc__utils_8h.html#a6a83dc415ae5e205183f0488b46228c4">MAXCOLS</a>&nbsp;&nbsp;&nbsp;200</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="spc__utils_8h.html#aa3ca150e9f00716cbf138ce56ff3ef9c">strMove</a>(d, s)&nbsp;&nbsp;&nbsp;memmove(d,s,strlen(s)+1)</td></tr>
<tr><td colspan="2"><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="spc__utils_8h.html#ab90505406d3960f2f61d6db4c5a9b7cc">init_search</a> (const char *string)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">char *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="spc__utils_8h.html#a288420ef2c849abe17db4f995aa73325">strsearch</a> (const char *string)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="spc__utils_8h.html#a8e9536e04ecffec6365a655c18070867">is_valid_entry</a> (double mag)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="spc__utils_8h.html#a975f8bbace187edba3fbb05b9d099046">get_valid_entries</a> (const gsl_vector *magnitudes)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="spc__utils_8h.html#ab746bad662c3d633b8ea691cf6fb9bf9">check_worldcoo_input</a> (const <a class="el" href="structcolinfo.html">colinfo</a> *actcatinfo, const int thsky)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="spc__utils_8h.html#a7ff43f642c35a3c47fbef83f1000ff36">check_imagecoo_input</a> (const <a class="el" href="structcolinfo.html">colinfo</a> *actcatinfo)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="spc__utils_8h.html#a1300c5f47fbca9f266e3536034a859e0">make_GOL_header</a> (FILE *fout, const <a class="el" href="structcolinfo.html">colinfo</a> *actcatinfo, const gsl_vector *waves, const gsl_vector *cnums, const <a class="el" href="structpx__point.html">px_point</a> backwin_cols, const <a class="el" href="structpx__point.html">px_point</a> modinfo_cols)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="structcolinfo.html">colinfo</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="spc__utils_8h.html#a47a365ec494841b98f872779b80535b0">get_sex_col_descr</a> (char *filename)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">double&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="spc__utils_8h.html#ad97d117907a3a7344fae7ecf3f5f7ec5">get_col_value</a> (const <a class="el" href="structcolinfo.html">colinfo</a> *actcatinfo, const char key[], gsl_vector *v, int fatal)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">double&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="spc__utils_8h.html#a1720a86f177dc973d965f0bf525ebd3a">get_col_value2</a> (const <a class="el" href="structcolinfo.html">colinfo</a> *actcatinfo, const char key[], gsl_vector *v, int fatal)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="spc__utils_8h.html#a045718d450da547eb37a4413e815d4d8">line_is_valid</a> (const <a class="el" href="structcolinfo.html">colinfo</a> *actcatinfo, char line[])</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="spc__utils_8h.html#a9cfaa2da5415e6bde7e7cea924473b41">get_magauto_col</a> (const gsl_vector *wavelength, const gsl_vector *colnums, const double lambda_mark)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="spc__utils_8h.html#a50e5a8658878acd54ee085583f3964b7">has_magnitudes</a> (const <a class="el" href="structcolinfo.html">colinfo</a> *actcatinfo)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="structpx__point.html">px_point</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="spc__utils_8h.html#a57a488065fd31edc4276c24af0a2fe53">has_backwindow</a> (const <a class="el" href="structcolinfo.html">colinfo</a> *actcatinfo)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="structpx__point.html">px_point</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="spc__utils_8h.html#a77125dc504a3f1905e2f89b0296d37cf">has_modelinfo</a> (const <a class="el" href="structcolinfo.html">colinfo</a> *actcatinfo)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="spc__utils_8h.html#a3d16714a512547070ba425e88c4bb763">get_magcols</a> (const <a class="el" href="structcolinfo.html">colinfo</a> *actcatinfo, gsl_vector *wavelength, gsl_vector *colnums)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="spc__utils_8h.html#a68eb57d69bfda17abe4d99b5f9c27705">resolve_colname</a> (const char colname[])</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="spc__utils_8h.html#a5e9372d2eac4722199973f6c033b21f2">get_columname</a> (const <a class="el" href="structcolinfo.html">colinfo</a> *actcatinfo, const int colnum, char colname[])</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="spc__utils_8h.html#a5c6acd1c34d2de7d9e7d369a6518eb54">get_columnumber</a> (const char cname[], const <a class="el" href="structcolinfo.html">colinfo</a> *actcatinfo)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">char *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="spc__utils_8h.html#a758cf1ef470ca77056e97ce46e0cd95b">rmlead</a> (char *str)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">char *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="spc__utils_8h.html#a8681db0694ab1aa93d402f813cfd520a">stptok</a> (const char *s, char *tok, size_t toklen, char *brk)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="spc__utils_8h.html#a5173a4942a3d83d368b97ad51aabedb6">lv1ws</a> (char *str)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="spc__utils_8h.html#a4a82c9b42093bc1e0795ef6441f89c49">isnum2</a> (char *string)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">gsl_vector *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="spc__utils_8h.html#ae52364129107c1b86e38dd795086046d">string_to_gsl_array</a> (char *str)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="spc__utils_8h.html#a7be51426329dec34067041865bf2d36c">check_libraries</a> (void)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="structobservation.html">observation</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="spc__utils_8h.html#ac89172f10962f24de5d0284500597c64">load_dummy_observation</a> ()</td></tr>
</table>
<hr/><h2>Define Documentation</h2>
<a class="anchor" id="a840c8714a6150c8842d085a7de95a5bf"></a><!-- doxytag: member="spc_utils.h::COLNAMELENGTH" ref="a840c8714a6150c8842d085a7de95a5bf" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define COLNAMELENGTH&nbsp;&nbsp;&nbsp;12</td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="a750fb88b0e928a751d106138d9c31ce3"></a><!-- doxytag: member="spc_utils.h::LAMBDACENTRAL" ref="a750fb88b0e928a751d106138d9c31ce3" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define LAMBDACENTRAL&nbsp;&nbsp;&nbsp;8000.0</td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="a6a83dc415ae5e205183f0488b46228c4"></a><!-- doxytag: member="spc_utils.h::MAXCOLS" ref="a6a83dc415ae5e205183f0488b46228c4" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define MAXCOLS&nbsp;&nbsp;&nbsp;200</td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="aa3ca150e9f00716cbf138ce56ff3ef9c"></a><!-- doxytag: member="spc_utils.h::strMove" ref="aa3ca150e9f00716cbf138ce56ff3ef9c" args="(d, s)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define strMove</td>
          <td>(</td>
          <td class="paramtype">d, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">s&nbsp;</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td>&nbsp;&nbsp;&nbsp;memmove(d,s,strlen(s)+1)</td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<hr/><h2>Function Documentation</h2>
<a class="anchor" id="a7ff43f642c35a3c47fbef83f1000ff36"></a><!-- doxytag: member="spc_utils.h::check_imagecoo_input" ref="a7ff43f642c35a3c47fbef83f1000ff36" args="(const colinfo *actcatinfo)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int check_imagecoo_input </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structcolinfo.html">colinfo</a> *&nbsp;</td>
          <td class="paramname"> <em>actcatinfo</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Function: check_imagecoo_input Checks whether the columns for the image coordinates are present in a catalog header. Returns the number of missing columns</p>
<p>Parameters: </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>actcatinfo</em>&nbsp;</td><td>- the catalog header ot be examined</td></tr>
  </table>
  </dd>
</dl>
<p>Returns: </p>
<dl class="return"><dt><b>Returns:</b></dt><dd>checksum - the number of missing columns </dd></dl>

<p><div class="fragment"><pre class="fragment"><a name="l00131"></a>00131                                                 {
<a name="l00132"></a>00132 
<a name="l00133"></a>00133   <span class="keywordtype">int</span> checksum=0;
<a name="l00134"></a>00134   
<a name="l00135"></a>00135   <span class="comment">// check for each column </span>
<a name="l00136"></a>00136   <span class="keywordflow">if</span> (!<a class="code" href="spc__utils_8c.html#a5c6acd1c34d2de7d9e7d369a6518eb54">get_columnumber</a>(<span class="stringliteral">&quot;X_IMAGE&quot;</span>, actcatinfo))
<a name="l00137"></a>00137     checksum++;
<a name="l00138"></a>00138   <span class="keywordflow">if</span> (!<a class="code" href="spc__utils_8c.html#a5c6acd1c34d2de7d9e7d369a6518eb54">get_columnumber</a>(<span class="stringliteral">&quot;Y_IMAGE&quot;</span>, actcatinfo))
<a name="l00139"></a>00139     checksum++;
<a name="l00140"></a>00140   <span class="keywordflow">if</span> (!<a class="code" href="spc__utils_8c.html#a5c6acd1c34d2de7d9e7d369a6518eb54">get_columnumber</a>(<span class="stringliteral">&quot;A_IMAGE&quot;</span>, actcatinfo))
<a name="l00141"></a>00141     checksum++;
<a name="l00142"></a>00142   <span class="keywordflow">if</span> (!<a class="code" href="spc__utils_8c.html#a5c6acd1c34d2de7d9e7d369a6518eb54">get_columnumber</a>(<span class="stringliteral">&quot;B_IMAGE&quot;</span>, actcatinfo))
<a name="l00143"></a>00143     checksum++;
<a name="l00144"></a>00144   <span class="keywordflow">if</span> (!<a class="code" href="spc__utils_8c.html#a5c6acd1c34d2de7d9e7d369a6518eb54">get_columnumber</a>(<span class="stringliteral">&quot;THETA_IMAGE&quot;</span>, actcatinfo))
<a name="l00145"></a>00145     checksum++;
<a name="l00146"></a>00146 
<a name="l00147"></a>00147   <span class="comment">// return the number of missing columns</span>
<a name="l00148"></a>00148   <span class="keywordflow">return</span> checksum;
<a name="l00149"></a>00149 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a7be51426329dec34067041865bf2d36c"></a><!-- doxytag: member="spc_utils.h::check_libraries" ref="a7be51426329dec34067041865bf2d36c" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void check_libraries </td>
          <td>(</td>
          <td class="paramtype">void&nbsp;</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Function: check_libraries A helper function which checks the versin numbers of a few runtime libraries to ensure that the proper versions of libraries are being found. </p>

<p><div class="fragment"><pre class="fragment"><a name="l00784"></a>00784 {
<a name="l00785"></a>00785   <span class="keywordtype">int</span> n;
<a name="l00786"></a>00786   <span class="keywordtype">int</span> major = 0, minor = 0, micro = 0;
<a name="l00787"></a>00787   <span class="keywordtype">int</span> gsl_major_version = 0, gsl_minor_version = 0, gsl_micro_version = 0;
<a name="l00788"></a>00788   
<a name="l00789"></a>00789 <span class="preprocessor">#define NEEDED_GSL_VERSION &quot;0.9.1&quot;</span>
<a name="l00790"></a>00790 <span class="preprocessor"></span>  
<a name="l00791"></a>00791   n = sscanf (GSL_VERSION, <span class="stringliteral">&quot;%d.%d.%d&quot;</span>, &amp;major, &amp;minor, &amp;micro);
<a name="l00792"></a>00792   <span class="keywordflow">if</span> (n != 2 &amp;&amp; n != 3)
<a name="l00793"></a>00793     {
<a name="l00794"></a>00794       <a class="code" href="aXe__errors_8c.html#a7ef7588e5f91237ba7ce4084e6ed3c11">aXe_message</a> (<a class="code" href="aXe__errors_8h.html#a2556a67874555249b07691c37aa6d6e9">aXe_M_FATAL</a>, __FILE__, __LINE__,
<a name="l00795"></a>00795                    <span class="stringliteral">&quot;check_libraries: %s, bad GSL version string\n&quot;</span>,
<a name="l00796"></a>00796                    GSL_VERSION);
<a name="l00797"></a>00797     }
<a name="l00798"></a>00798   n = sscanf (NEEDED_GSL_VERSION, <span class="stringliteral">&quot;%d.%d.%d&quot;</span>, &amp;gsl_major_version,
<a name="l00799"></a>00799               &amp;gsl_minor_version, &amp;gsl_micro_version);
<a name="l00800"></a>00800   <span class="keywordflow">if</span> (n != 2 &amp;&amp; n != 3)
<a name="l00801"></a>00801     {
<a name="l00802"></a>00802       <a class="code" href="aXe__errors_8c.html#a7ef7588e5f91237ba7ce4084e6ed3c11">aXe_message</a> (<a class="code" href="aXe__errors_8h.html#a2556a67874555249b07691c37aa6d6e9">aXe_M_FATAL</a>, __FILE__, __LINE__,
<a name="l00803"></a>00803                    <span class="stringliteral">&quot;check_libraries: %s, bad NEEEDED GSL version string\n&quot;</span>,
<a name="l00804"></a>00804                    GSL_VERSION);
<a name="l00805"></a>00805     }
<a name="l00806"></a>00806   <span class="keywordflow">if</span> (((gsl_major_version &gt; major)
<a name="l00807"></a>00807        || ((gsl_major_version == major) &amp;&amp; (gsl_minor_version &gt; minor))
<a name="l00808"></a>00808        || ((gsl_major_version == major) &amp;&amp; (gsl_minor_version == minor)
<a name="l00809"></a>00809            &amp;&amp; (gsl_micro_version &gt;= micro))))
<a name="l00810"></a>00810     {
<a name="l00811"></a>00811       <a class="code" href="aXe__errors_8c.html#a7ef7588e5f91237ba7ce4084e6ed3c11">aXe_message</a> (<a class="code" href="aXe__errors_8h.html#a2556a67874555249b07691c37aa6d6e9">aXe_M_FATAL</a>, __FILE__, __LINE__,
<a name="l00812"></a>00812                    <span class="stringliteral">&quot;check_libraries: Need GSL version %s, loaded version is %s.&quot;</span>,
<a name="l00813"></a>00813                    NEEDED_GSL_VERSION, GSL_VERSION);
<a name="l00814"></a>00814     }
<a name="l00815"></a>00815 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="ab746bad662c3d633b8ea691cf6fb9bf9"></a><!-- doxytag: member="spc_utils.h::check_worldcoo_input" ref="ab746bad662c3d633b8ea691cf6fb9bf9" args="(const colinfo *actcatinfo, const int thsky)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int check_worldcoo_input </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structcolinfo.html">colinfo</a> *&nbsp;</td>
          <td class="paramname"> <em>actcatinfo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>thsky</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Function: check_worldcoo_input Checks whether the columns for the world coordinates are present in a catalog header. Returns the number of missing columns</p>
<p>Parameters: </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>actcatinfo</em>&nbsp;</td><td>- the catalog header ot be examined</td></tr>
  </table>
  </dd>
</dl>
<p>Returns: </p>
<dl class="return"><dt><b>Returns:</b></dt><dd>checksum - the number of missing columns </dd></dl>

<p><div class="fragment"><pre class="fragment"><a name="l00088"></a>00088 {
<a name="l00089"></a>00089   <span class="keywordtype">int</span> checksum=0;
<a name="l00090"></a>00090 
<a name="l00091"></a>00091   <span class="comment">// check for each column</span>
<a name="l00092"></a>00092   <span class="keywordflow">if</span> (!<a class="code" href="spc__utils_8c.html#a5c6acd1c34d2de7d9e7d369a6518eb54">get_columnumber</a>(<span class="stringliteral">&quot;NUMBER&quot;</span>, actcatinfo))
<a name="l00093"></a>00093     checksum++;
<a name="l00094"></a>00094   <span class="keywordflow">if</span> (!<a class="code" href="spc__utils_8c.html#a5c6acd1c34d2de7d9e7d369a6518eb54">get_columnumber</a>(<span class="stringliteral">&quot;X_WORLD&quot;</span>, actcatinfo))
<a name="l00095"></a>00095     checksum++;
<a name="l00096"></a>00096   <span class="keywordflow">if</span> (!<a class="code" href="spc__utils_8c.html#a5c6acd1c34d2de7d9e7d369a6518eb54">get_columnumber</a>(<span class="stringliteral">&quot;Y_WORLD&quot;</span>, actcatinfo))
<a name="l00097"></a>00097     checksum++;
<a name="l00098"></a>00098   <span class="keywordflow">if</span> (!<a class="code" href="spc__utils_8c.html#a5c6acd1c34d2de7d9e7d369a6518eb54">get_columnumber</a>(<span class="stringliteral">&quot;A_WORLD&quot;</span>, actcatinfo))
<a name="l00099"></a>00099     checksum++;
<a name="l00100"></a>00100   <span class="keywordflow">if</span> (!<a class="code" href="spc__utils_8c.html#a5c6acd1c34d2de7d9e7d369a6518eb54">get_columnumber</a>(<span class="stringliteral">&quot;B_WORLD&quot;</span>, actcatinfo))
<a name="l00101"></a>00101     checksum++;
<a name="l00102"></a>00102 
<a name="l00103"></a>00103   <span class="comment">//  if (thsky)</span>
<a name="l00104"></a>00104   <span class="comment">//    {</span>
<a name="l00105"></a>00105   <span class="comment">//      if (!get_columnumber(&quot;THETA_SKY&quot;, actcatinfo))</span>
<a name="l00106"></a>00106   <span class="comment">//    checksum++;</span>
<a name="l00107"></a>00107   <span class="comment">//    }</span>
<a name="l00108"></a>00108   <span class="comment">//  else</span>
<a name="l00109"></a>00109   <span class="comment">//    {</span>
<a name="l00110"></a>00110   <span class="keywordflow">if</span> (!<a class="code" href="spc__utils_8c.html#a5c6acd1c34d2de7d9e7d369a6518eb54">get_columnumber</a>(<span class="stringliteral">&quot;THETA_WORLD&quot;</span>, actcatinfo))
<a name="l00111"></a>00111     checksum++;
<a name="l00112"></a>00112         <span class="comment">//    }</span>
<a name="l00113"></a>00113 
<a name="l00114"></a>00114   <span class="comment">// return the number of missing columns</span>
<a name="l00115"></a>00115   <span class="keywordflow">return</span> checksum;
<a name="l00116"></a>00116 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="ad97d117907a3a7344fae7ecf3f5f7ec5"></a><!-- doxytag: member="spc_utils.h::get_col_value" ref="ad97d117907a3a7344fae7ecf3f5f7ec5" args="(const colinfo *actcatinfo, const char key[], gsl_vector *v, int fatal)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double get_col_value </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structcolinfo.html">colinfo</a> *&nbsp;</td>
          <td class="paramname"> <em>actcatinfo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char&nbsp;</td>
          <td class="paramname"> <em>key</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">gsl_vector *&nbsp;</td>
          <td class="paramname"> <em>v</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>fatal</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Function: get_col_value The function identifies the column number for a given column name, and extracts the data value for this column from the vector representation of a catalog line.</p>
<p>Parameters: </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>actcatinfo</em>&nbsp;</td><td>- the header of the catalog </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>key</em>&nbsp;</td><td>- the column name </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>v</em>&nbsp;</td><td>- a gsl_vector containing the data of a catalog line </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>fatal</em>&nbsp;</td><td>- controls the severity of the error if the column does not exist</td></tr>
  </table>
  </dd>
</dl>
<p>Returns: </p>
<dl class="return"><dt><b>Returns:</b></dt><dd>res - the data value in the column </dd></dl>

<p><div class="fragment"><pre class="fragment"><a name="l00326"></a>00326 {
<a name="l00327"></a>00327   <span class="keywordtype">double</span> res;
<a name="l00328"></a>00328   <span class="keywordtype">int</span>    col;
<a name="l00329"></a>00329   
<a name="l00330"></a>00330   <span class="comment">// determine the column number for the column name </span>
<a name="l00331"></a>00331   col = <a class="code" href="spc__utils_8c.html#a5c6acd1c34d2de7d9e7d369a6518eb54">get_columnumber</a>(key, actcatinfo);
<a name="l00332"></a>00332   <span class="comment">// depending on &apos;fatal&apos; exit or give back NaN</span>
<a name="l00333"></a>00333   <span class="comment">// if the column does not exist</span>
<a name="l00334"></a>00334   <span class="keywordflow">if</span> ( (fatal!=0) &amp;&amp; (col == 0) )
<a name="l00335"></a>00335     {
<a name="l00336"></a>00336       <a class="code" href="aXe__errors_8c.html#a7ef7588e5f91237ba7ce4084e6ed3c11">aXe_message</a> (<a class="code" href="aXe__errors_8h.html#a2556a67874555249b07691c37aa6d6e9">aXe_M_FATAL</a>, __FILE__, __LINE__,
<a name="l00337"></a>00337                    <span class="stringliteral">&quot;%s not found in object catalog&quot;</span>, key);
<a name="l00338"></a>00338     }
<a name="l00339"></a>00339 
<a name="l00340"></a>00340   <span class="keywordflow">if</span> ( (fatal==0) &amp;&amp; (col == 0) )
<a name="l00341"></a>00341     <span class="keywordflow">return</span> GSL_NAN;
<a name="l00342"></a>00342 
<a name="l00343"></a>00343   <span class="comment">// get the data value from the vector</span>
<a name="l00344"></a>00344   res = gsl_vector_get (v, col - 1);
<a name="l00345"></a>00345 
<a name="l00346"></a>00346   <span class="comment">//  return the data value</span>
<a name="l00347"></a>00347   <span class="keywordflow">return</span> res;
<a name="l00348"></a>00348 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a1720a86f177dc973d965f0bf525ebd3a"></a><!-- doxytag: member="spc_utils.h::get_col_value2" ref="a1720a86f177dc973d965f0bf525ebd3a" args="(const colinfo *actcatinfo, const char key[], gsl_vector *v, int fatal)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double get_col_value2 </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structcolinfo.html">colinfo</a> *&nbsp;</td>
          <td class="paramname"> <em>actcatinfo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char&nbsp;</td>
          <td class="paramname"> <em>key</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">gsl_vector *&nbsp;</td>
          <td class="paramname"> <em>v</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>fatal</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p><div class="fragment"><pre class="fragment"><a name="l00356"></a>00356 {
<a name="l00357"></a>00357   <span class="keywordtype">double</span> res;
<a name="l00358"></a>00358   <span class="keywordtype">int</span>    col;
<a name="l00359"></a>00359   
<a name="l00360"></a>00360   <span class="comment">// determine the column number for the column name </span>
<a name="l00361"></a>00361   col = <a class="code" href="spc__utils_8c.html#a5c6acd1c34d2de7d9e7d369a6518eb54">get_columnumber</a>(key, actcatinfo);
<a name="l00362"></a>00362   <span class="comment">// depending on &apos;fatal&apos; exit or give back NaN</span>
<a name="l00363"></a>00363   <span class="comment">// if the column does not exist</span>
<a name="l00364"></a>00364   <span class="keywordflow">if</span> ( (fatal!=0) &amp;&amp; (col == 0) )
<a name="l00365"></a>00365     {
<a name="l00366"></a>00366       <a class="code" href="aXe__errors_8c.html#a7ef7588e5f91237ba7ce4084e6ed3c11">aXe_message</a> (<a class="code" href="aXe__errors_8h.html#a2556a67874555249b07691c37aa6d6e9">aXe_M_FATAL</a>, __FILE__, __LINE__,
<a name="l00367"></a>00367                    <span class="stringliteral">&quot;%s not found in object catalog&quot;</span>, key);
<a name="l00368"></a>00368     }
<a name="l00369"></a>00369 
<a name="l00370"></a>00370   <span class="keywordflow">if</span> ( (fatal==0) &amp;&amp; (col == 0) )
<a name="l00371"></a>00371     <span class="keywordflow">return</span> -1000000;
<a name="l00372"></a>00372 
<a name="l00373"></a>00373   <span class="comment">// get the data value from the vector</span>
<a name="l00374"></a>00374   res = gsl_vector_get (v, col - 1);
<a name="l00375"></a>00375 
<a name="l00376"></a>00376   <span class="comment">//  return the data value</span>
<a name="l00377"></a>00377   <span class="keywordflow">return</span> res;
<a name="l00378"></a>00378 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a5e9372d2eac4722199973f6c033b21f2"></a><!-- doxytag: member="spc_utils.h::get_columname" ref="a5e9372d2eac4722199973f6c033b21f2" args="(const colinfo *actcatinfo, const int colnum, char colname[])" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void get_columname </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structcolinfo.html">colinfo</a> *&nbsp;</td>
          <td class="paramname"> <em>actcatinfo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>colnum</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char&nbsp;</td>
          <td class="paramname"> <em>cname</em>[]</td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Function: get_columname The function extracts a specific column name from the header structure.</p>
<p>Parameters: </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>actcatinfo</em>&nbsp;</td><td>- the header structure with the column names </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>colnum</em>&nbsp;</td><td>- the column number </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>cname</em>&nbsp;</td><td>- string to store the column name </td></tr>
  </table>
  </dd>
</dl>

<p><div class="fragment"><pre class="fragment"><a name="l00698"></a>00698 {
<a name="l00699"></a>00699   <span class="comment">// copy the column name into the buffer string</span>
<a name="l00700"></a>00700   strcpy(cname, actcatinfo-&gt;<a class="code" href="structcolinfo.html#a001692bf4f745ef0c5066c8ece0f7628">columns</a>[colnum-1].<a class="code" href="structsexcol.html#a570145e70159e58db2e88d99830dda95">name</a>);
<a name="l00701"></a>00701 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a5c6acd1c34d2de7d9e7d369a6518eb54"></a><!-- doxytag: member="spc_utils.h::get_columnumber" ref="a5c6acd1c34d2de7d9e7d369a6518eb54" args="(const char cname[], const colinfo *actcatinfo)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int get_columnumber </td>
          <td>(</td>
          <td class="paramtype">const char&nbsp;</td>
          <td class="paramname"> <em>cname</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structcolinfo.html">colinfo</a> *&nbsp;</td>
          <td class="paramname"> <em>actcatinfo</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Function: get_columnumber The function searches in the catalog header structure for a column name and returns its column number.</p>
<p>Parameters: </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>cname</em>&nbsp;</td><td>- the column name </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>actcatinfo</em>&nbsp;</td><td>- the header structure with the column names</td></tr>
  </table>
  </dd>
</dl>
<p>Returns: </p>
<dl class="return"><dt><b>Returns:</b></dt><dd>cnum - the number of columns with magnitudes </dd></dl>

<p><div class="fragment"><pre class="fragment"><a name="l00717"></a>00717 {
<a name="l00718"></a>00718   <span class="keywordtype">int</span> cnum = 0;
<a name="l00719"></a>00719   <span class="keywordtype">int</span> i;
<a name="l00720"></a>00720 
<a name="l00721"></a>00721   <span class="comment">// go through all columns</span>
<a name="l00722"></a>00722   <span class="keywordflow">for</span> (i = 0; i &lt; actcatinfo-&gt;<a class="code" href="structcolinfo.html#aeac67ce88746e560df5b1f503d26a670">numcols</a>; i++)
<a name="l00723"></a>00723     {
<a name="l00724"></a>00724       <span class="comment">// compare each column name against the name </span>
<a name="l00725"></a>00725       <span class="keywordflow">if</span> (!strcmp(actcatinfo-&gt;<a class="code" href="structcolinfo.html#a001692bf4f745ef0c5066c8ece0f7628">columns</a>[i].<a class="code" href="structsexcol.html#a570145e70159e58db2e88d99830dda95">name</a>,cname))
<a name="l00726"></a>00726         <span class="comment">// store the column number</span>
<a name="l00727"></a>00727         cnum = actcatinfo-&gt;<a class="code" href="structcolinfo.html#a001692bf4f745ef0c5066c8ece0f7628">columns</a>[i].<a class="code" href="structsexcol.html#af73c810dc7f06f2585ba28425d5eb595">number</a>;
<a name="l00728"></a>00728     }
<a name="l00729"></a>00729   <span class="comment">// return the column number</span>
<a name="l00730"></a>00730   <span class="keywordflow">return</span> cnum;
<a name="l00731"></a>00731 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a9cfaa2da5415e6bde7e7cea924473b41"></a><!-- doxytag: member="spc_utils.h::get_magauto_col" ref="a9cfaa2da5415e6bde7e7cea924473b41" args="(const gsl_vector *wavelength, const gsl_vector *colnums, const double lambda_mark)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int get_magauto_col </td>
          <td>(</td>
          <td class="paramtype">const gsl_vector *&nbsp;</td>
          <td class="paramname"> <em>wavelength</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const gsl_vector *&nbsp;</td>
          <td class="paramname"> <em>colnums</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&nbsp;</td>
          <td class="paramname"> <em>lambda_mark</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Function: get_magauto_col The functions selects the catalog column with the closest wavelength to LAMBDACENTRAL. The column number is returned.</p>
<p>Parameters: </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>wavelength</em>&nbsp;</td><td>- vector with the wavelengths of all magnitude columns </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>colnums</em>&nbsp;</td><td>- vector with the column numbers of of all magnitude columns</td></tr>
  </table>
  </dd>
</dl>
<p>Return: </p>
<dl class="return"><dt><b>Returns:</b></dt><dd>select - column number of the magnitude closest to lambda_mark </dd></dl>

<p><div class="fragment"><pre class="fragment"><a name="l00749"></a>00749 {
<a name="l00750"></a>00750   <span class="keywordtype">int</span> i =0, select=0;
<a name="l00751"></a>00751   <span class="keywordtype">double</span> minimum = 10E+06;
<a name="l00752"></a>00752 
<a name="l00753"></a>00753   <span class="comment">// if there is only one magnitude column</span>
<a name="l00754"></a>00754   <span class="keywordflow">if</span> (wavelength-&gt;size &lt; 2){
<a name="l00755"></a>00755     <span class="comment">// return the column number of the magnitude column </span>
<a name="l00756"></a>00756     <span class="keywordflow">return</span> ((<span class="keywordtype">int</span>)gsl_vector_get(colnums, 0));
<a name="l00757"></a>00757   }
<a name="l00758"></a>00758   <span class="keywordflow">else</span>{
<a name="l00759"></a>00759     <span class="comment">// in case there are more magnitude columns, loop over all</span>
<a name="l00760"></a>00760     <span class="keywordflow">for</span> (i=0; i &lt; wavelength-&gt;size; i++){
<a name="l00761"></a>00761       <span class="comment">// look whether the difference to LAMBDACENTRAL is </span>
<a name="l00762"></a>00762       <span class="comment">// smaller then the actual minimum</span>
<a name="l00763"></a>00763       <span class="keywordflow">if</span> (fabs(lambda_mark - gsl_vector_get(wavelength,i)) &lt; minimum)
<a name="l00764"></a>00764         {
<a name="l00765"></a>00765           <span class="comment">// store the new minimum and its column number</span>
<a name="l00766"></a>00766           minimum = fabs(lambda_mark - gsl_vector_get(wavelength,i));
<a name="l00767"></a>00767           select = (int)gsl_vector_get(colnums,i);
<a name="l00768"></a>00768         }
<a name="l00769"></a>00769     }
<a name="l00770"></a>00770   }
<a name="l00771"></a>00771   <span class="comment">// return the column number</span>
<a name="l00772"></a>00772   <span class="keywordflow">return</span> select;
<a name="l00773"></a>00773 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a3d16714a512547070ba425e88c4bb763"></a><!-- doxytag: member="spc_utils.h::get_magcols" ref="a3d16714a512547070ba425e88c4bb763" args="(const colinfo *actcatinfo, gsl_vector *wavelength, gsl_vector *colnums)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int get_magcols </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structcolinfo.html">colinfo</a> *&nbsp;</td>
          <td class="paramname"> <em>actcatinfo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">gsl_vector *&nbsp;</td>
          <td class="paramname"> <em>wavelength</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">gsl_vector *&nbsp;</td>
          <td class="paramname"> <em>colnums</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Function: get_magcols The function searches for magnitude coulumns in the header structure, then it extracts the wavelength from column name and stores column number and wavelength in gsl_vectors.</p>
<p>Parameters: </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>actcatinfo</em>&nbsp;</td><td>- the header structure with the column names </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>wavelength</em>&nbsp;</td><td>- vector with the wavelengths </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>wavelength</em>&nbsp;</td><td>- vector with the column numbers</td></tr>
  </table>
  </dd>
</dl>
<p>Returns: </p>
<dl class="return"><dt><b>Returns:</b></dt><dd>mags - the number of columns with magnitudes </dd></dl>

<p><div class="fragment"><pre class="fragment"><a name="l00607"></a>00607                                                         {
<a name="l00608"></a>00608 
<a name="l00609"></a>00609   <span class="keywordtype">int</span> mags = 0;
<a name="l00610"></a>00610   <span class="keywordtype">int</span> i= 0, j=0;
<a name="l00611"></a>00611   <span class="keywordtype">int</span> iwlength=0;
<a name="l00612"></a>00612   <span class="keywordtype">int</span> entry = 0;
<a name="l00613"></a>00613   <span class="keywordtype">int</span> idest;
<a name="l00614"></a>00614 
<a name="l00615"></a>00615 
<a name="l00616"></a>00616   <span class="keywordflow">for</span> (i = 0; i &lt; actcatinfo-&gt;<a class="code" href="structcolinfo.html#aeac67ce88746e560df5b1f503d26a670">numcols</a>; i++)
<a name="l00617"></a>00617     {
<a name="l00618"></a>00618       <span class="comment">// look whether the column name is suspicious</span>
<a name="l00619"></a>00619       <span class="keywordflow">if</span> (strstr(actcatinfo-&gt;<a class="code" href="structcolinfo.html#a001692bf4f745ef0c5066c8ece0f7628">columns</a>[i].<a class="code" href="structsexcol.html#a570145e70159e58db2e88d99830dda95">name</a>,<span class="stringliteral">&quot;MAG_&quot;</span>) != NULL)
<a name="l00620"></a>00620         {
<a name="l00621"></a>00621           <span class="comment">// look whether the column name is &quot;MAG_AUTO&quot;</span>
<a name="l00622"></a>00622           <span class="keywordflow">if</span> (!strcmp(actcatinfo-&gt;<a class="code" href="structcolinfo.html#a001692bf4f745ef0c5066c8ece0f7628">columns</a>[i].<a class="code" href="structsexcol.html#a570145e70159e58db2e88d99830dda95">name</a>,<span class="stringliteral">&quot;MAG_AUTO&quot;</span>))
<a name="l00623"></a>00623             {
<a name="l00624"></a>00624               <span class="comment">// store the column number, store wavelength 0.0 to indicate</span>
<a name="l00625"></a>00625               <span class="comment">// that it is column MAG_AUTO</span>
<a name="l00626"></a>00626               gsl_vector_set (colnums, entry, (<span class="keywordtype">double</span>)actcatinfo-&gt;<a class="code" href="structcolinfo.html#a001692bf4f745ef0c5066c8ece0f7628">columns</a>[i].<a class="code" href="structsexcol.html#af73c810dc7f06f2585ba28425d5eb595">number</a>);
<a name="l00627"></a>00627               gsl_vector_set (wavelength, entry++, 0.0);
<a name="l00628"></a>00628               <span class="comment">// increment the number of magnitude columns</span>
<a name="l00629"></a>00629               mags++;
<a name="l00630"></a>00630             }
<a name="l00631"></a>00631           <span class="keywordflow">else</span>
<a name="l00632"></a>00632             {
<a name="l00633"></a>00633               <span class="comment">// look whether it is possible to extract a wavelength</span>
<a name="l00634"></a>00634               <span class="comment">// from the column name</span>
<a name="l00635"></a>00635               iwlength = <a class="code" href="spc__utils_8c.html#a68eb57d69bfda17abe4d99b5f9c27705">resolve_colname</a>(actcatinfo-&gt;<a class="code" href="structcolinfo.html#a001692bf4f745ef0c5066c8ece0f7628">columns</a>[i].<a class="code" href="structsexcol.html#a570145e70159e58db2e88d99830dda95">name</a>);
<a name="l00636"></a>00636               <span class="keywordflow">if</span> (iwlength)
<a name="l00637"></a>00637                 {
<a name="l00638"></a>00638                   <span class="comment">// search for the correct position of the actual column</span>
<a name="l00639"></a>00639                   <span class="comment">// in the set of magnitude columns. the magnitude</span>
<a name="l00640"></a>00640                   <span class="comment">// columns are stored in ascending order </span>
<a name="l00641"></a>00641                   idest=0;
<a name="l00642"></a>00642                   <span class="keywordflow">while</span> (iwlength &gt; gsl_vector_get(wavelength, idest) &amp;&amp; idest &lt; entry)
<a name="l00643"></a>00643                     idest++;
<a name="l00644"></a>00644                   
<a name="l00645"></a>00645                   <span class="comment">// check whether the correct position is at the end of the</span>
<a name="l00646"></a>00646                   <span class="comment">// magnitude column list</span>
<a name="l00647"></a>00647                   <span class="keywordflow">if</span> (idest == entry)
<a name="l00648"></a>00648                     {
<a name="l00649"></a>00649 
<a name="l00650"></a>00650                       <span class="comment">// append the column to the list</span>
<a name="l00651"></a>00651                       gsl_vector_set (colnums, entry, (<span class="keywordtype">double</span>)actcatinfo-&gt;<a class="code" href="structcolinfo.html#a001692bf4f745ef0c5066c8ece0f7628">columns</a>[i].<a class="code" href="structsexcol.html#af73c810dc7f06f2585ba28425d5eb595">number</a>);
<a name="l00652"></a>00652                       gsl_vector_set (wavelength, entry++, (<span class="keywordtype">double</span>)iwlength);
<a name="l00653"></a>00653                     }
<a name="l00654"></a>00654 
<a name="l00655"></a>00655                   <span class="comment">// in case that the correct position is somewhere in the middle</span>
<a name="l00656"></a>00656                   <span class="keywordflow">else</span>
<a name="l00657"></a>00657                     {
<a name="l00658"></a>00658 
<a name="l00659"></a>00659 
<a name="l00660"></a>00660                       <span class="comment">// move the other columns, starting from the last in the</span>
<a name="l00661"></a>00661                       <span class="comment">// list until the column which is at the correct</span>
<a name="l00662"></a>00662                       <span class="comment">// position of the new column</span>
<a name="l00663"></a>00663                       <span class="keywordflow">for</span> (j=entry; j &gt; idest; j--)
<a name="l00664"></a>00664                         {
<a name="l00665"></a>00665                           gsl_vector_set (colnums, j, gsl_vector_get(colnums, j-1));
<a name="l00666"></a>00666                           gsl_vector_set (wavelength, j, gsl_vector_get(wavelength, j-1));
<a name="l00667"></a>00667                         } 
<a name="l00668"></a>00668 
<a name="l00669"></a>00669                       <span class="comment">// put the new column at the correct position</span>
<a name="l00670"></a>00670                       gsl_vector_set (colnums, idest, (<span class="keywordtype">double</span>)actcatinfo-&gt;<a class="code" href="structcolinfo.html#a001692bf4f745ef0c5066c8ece0f7628">columns</a>[i].<a class="code" href="structsexcol.html#af73c810dc7f06f2585ba28425d5eb595">number</a>);
<a name="l00671"></a>00671                       gsl_vector_set (wavelength, idest, (<span class="keywordtype">double</span>)iwlength);                                   
<a name="l00672"></a>00672                       entry++;
<a name="l00673"></a>00673                     }
<a name="l00674"></a>00674 
<a name="l00675"></a>00675                   <span class="comment">// increment the number of magnitude columns</span>
<a name="l00676"></a>00676                   mags++;
<a name="l00677"></a>00677                 }
<a name="l00678"></a>00678             }
<a name="l00679"></a>00679         }
<a name="l00680"></a>00680     }
<a name="l00681"></a>00681   <span class="comment">// return the number of magnitude columns</span>
<a name="l00682"></a>00682   <span class="keywordflow">return</span> mags;
<a name="l00683"></a>00683 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a47a365ec494841b98f872779b80535b0"></a><!-- doxytag: member="spc_utils.h::get_sex_col_descr" ref="a47a365ec494841b98f872779b80535b0" args="(char *filename)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structcolinfo.html">colinfo</a>* get_sex_col_descr </td>
          <td>(</td>
          <td class="paramtype">char *&nbsp;</td>
          <td class="paramname"> <em>filename</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Function: get_sex_col_descr The function parses through the catalog and extracts the header information , which mainly are the columnnames plus the associated column numbers. The information is stored and returned in a structure of type 'colinfo'.</p>
<p>Parameters: </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>filename</em>&nbsp;</td><td>- the catalog name</td></tr>
  </table>
  </dd>
</dl>
<p>Returns: </p>
<dl class="return"><dt><b>Returns:</b></dt><dd>actinfo - the header structure with the catalog information </dd></dl>

<p><div class="fragment"><pre class="fragment"><a name="l00253"></a>00253 {
<a name="l00254"></a>00254   FILE    *input;
<a name="l00255"></a>00255   <span class="keywordtype">char</span>     Buffer[<a class="code" href="aXe__grism_8h.html#ac1535592e39e7edf0cafbd5e695ea622">MAXCHAR</a>];
<a name="l00256"></a>00256   <span class="keywordtype">int</span>      num=0;
<a name="l00257"></a>00257   <span class="keywordtype">int</span>      count=0;
<a name="l00258"></a>00258   <span class="keywordtype">char</span>    *key;
<a name="l00259"></a>00259   <a class="code" href="structcolinfo.html">colinfo</a> *actinfo;
<a name="l00260"></a>00260      
<a name="l00261"></a>00261 
<a name="l00262"></a>00262   <span class="comment">// allocate memory for the header structure</span>
<a name="l00263"></a>00263   actinfo = (<a class="code" href="structcolinfo.html">colinfo</a> *) malloc (<span class="keyword">sizeof</span> (<a class="code" href="structcolinfo.html">colinfo</a>));
<a name="l00264"></a>00264   <span class="keywordflow">if</span> (actinfo == NULL)
<a name="l00265"></a>00265     <a class="code" href="aXe__errors_8c.html#a7ef7588e5f91237ba7ce4084e6ed3c11">aXe_message</a> (<a class="code" href="aXe__errors_8h.html#a2556a67874555249b07691c37aa6d6e9">aXe_M_FATAL</a>, __FILE__, __LINE__,
<a name="l00266"></a>00266                  <span class="stringliteral">&quot;get_sex_col_descr: Could not allocate memory.&quot;</span>);
<a name="l00267"></a>00267 
<a name="l00268"></a>00268   <span class="comment">//  allocate memory for the dummy &apos;key</span>
<a name="l00269"></a>00269   key = (<span class="keywordtype">char</span> *) malloc (<a class="code" href="aXe__grism_8h.html#ac1535592e39e7edf0cafbd5e695ea622">MAXCHAR</a> * <span class="keyword">sizeof</span> (<span class="keywordtype">char</span>));
<a name="l00270"></a>00270   <span class="keywordflow">if</span> (key == NULL)
<a name="l00271"></a>00271     <a class="code" href="aXe__errors_8c.html#a7ef7588e5f91237ba7ce4084e6ed3c11">aXe_message</a> (<a class="code" href="aXe__errors_8h.html#a2556a67874555249b07691c37aa6d6e9">aXe_M_FATAL</a>, __FILE__, __LINE__,
<a name="l00272"></a>00272                  <span class="stringliteral">&quot;get_sex_col_descr: Could not allocate memory.&quot;</span>);
<a name="l00273"></a>00273 
<a name="l00274"></a>00274   <span class="comment">// open the catalog file</span>
<a name="l00275"></a>00275   input = fopen (filename, <span class="stringliteral">&quot;r&quot;</span>);
<a name="l00276"></a>00276   <span class="keywordflow">if</span> (!input)
<a name="l00277"></a>00277     {
<a name="l00278"></a>00278       <a class="code" href="aXe__errors_8c.html#a7ef7588e5f91237ba7ce4084e6ed3c11">aXe_message</a> (<a class="code" href="aXe__errors_8h.html#a2556a67874555249b07691c37aa6d6e9">aXe_M_FATAL</a>, __FILE__, __LINE__,
<a name="l00279"></a>00279                    <span class="stringliteral">&quot;get_sex_col_descr: Could not open %s&quot;</span>, filename);
<a name="l00280"></a>00280     }
<a name="l00281"></a>00281   
<a name="l00282"></a>00282   <span class="comment">//  go through the catalog file</span>
<a name="l00283"></a>00283   <span class="keywordflow">while</span> (NULL != fgets (Buffer, <a class="code" href="aXe__grism_8h.html#ac1535592e39e7edf0cafbd5e695ea622">MAXCHAR</a>, input))
<a name="l00284"></a>00284     {
<a name="l00285"></a>00285       <span class="comment">// see whether the current line is part of the header</span>
<a name="l00286"></a>00286       <span class="keywordflow">if</span> (Buffer[0] == <span class="charliteral">&apos;#&apos;</span>)
<a name="l00287"></a>00287         {
<a name="l00288"></a>00288           <span class="comment">// read the column number and column name from the header line          </span>
<a name="l00289"></a>00289           sscanf (Buffer, <span class="stringliteral">&quot;# %d %21s&quot;</span>, &amp;num, key);
<a name="l00290"></a>00290 
<a name="l00291"></a>00291           <span class="comment">// store column number and column name in the header structure</span>
<a name="l00292"></a>00292           strcpy(actinfo-&gt;<a class="code" href="structcolinfo.html#a001692bf4f745ef0c5066c8ece0f7628">columns</a>[count].<a class="code" href="structsexcol.html#a570145e70159e58db2e88d99830dda95">name</a>, key);
<a name="l00293"></a>00293           actinfo-&gt;<a class="code" href="structcolinfo.html#a001692bf4f745ef0c5066c8ece0f7628">columns</a>[count++].<a class="code" href="structsexcol.html#af73c810dc7f06f2585ba28425d5eb595">number</a> = num;
<a name="l00294"></a>00294         }
<a name="l00295"></a>00295     }
<a name="l00296"></a>00296   <span class="comment">// fill in the number of columns</span>
<a name="l00297"></a>00297   actinfo-&gt;<a class="code" href="structcolinfo.html#aeac67ce88746e560df5b1f503d26a670">numcols</a> = count;
<a name="l00298"></a>00298 
<a name="l00299"></a>00299   <span class="comment">// free memory</span>
<a name="l00300"></a>00300   free (key);
<a name="l00301"></a>00301   key = NULL;
<a name="l00302"></a>00302 
<a name="l00303"></a>00303   <span class="comment">// return the header structure</span>
<a name="l00304"></a>00304   <span class="keywordflow">return</span> actinfo;
<a name="l00305"></a>00305 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a975f8bbace187edba3fbb05b9d099046"></a><!-- doxytag: member="spc_utils.h::get_valid_entries" ref="a975f8bbace187edba3fbb05b9d099046" args="(const gsl_vector *magnitudes)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int get_valid_entries </td>
          <td>(</td>
          <td class="paramtype">const gsl_vector *&nbsp;</td>
          <td class="paramname"> <em>magnitudes</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Function: get_valid_entries The routine determines the number of valid magnitudes in a magnitude array.</p>
<p>Parameters: </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>magnitudes</em>&nbsp;</td><td>- the vector with magnitude to be checked</td></tr>
  </table>
  </dd>
</dl>
<p>Returns: </p>
<dl class="return"><dt><b>Returns:</b></dt><dd>nvalid - the number of valid magnitudes in the vector </dd></dl>

<p><div class="fragment"><pre class="fragment"><a name="l00056"></a>00056                                                {
<a name="l00057"></a>00057 
<a name="l00058"></a>00058   <span class="keywordtype">int</span> i=0;
<a name="l00059"></a>00059   <span class="keywordtype">int</span> nvalid = 0;
<a name="l00060"></a>00060   
<a name="l00061"></a>00061   <span class="comment">// go over each entry in the vector</span>
<a name="l00062"></a>00062   <span class="keywordflow">for</span> (i=0; i &lt; magnitudes-&gt;size; i++)
<a name="l00063"></a>00063     {
<a name="l00064"></a>00064       <span class="comment">// check whether an entry is valid,</span>
<a name="l00065"></a>00065       <span class="comment">// count up &apos;nvalid&apos; if the entry is valid</span>
<a name="l00066"></a>00066       <span class="keywordflow">if</span> (<a class="code" href="spc__utils_8c.html#a8e9536e04ecffec6365a655c18070867">is_valid_entry</a>(gsl_vector_get(magnitudes, i)))
<a name="l00067"></a>00067         nvalid++;
<a name="l00068"></a>00068     }
<a name="l00069"></a>00069 
<a name="l00070"></a>00070   <span class="comment">// return the number of valid entries</span>
<a name="l00071"></a>00071   <span class="keywordflow">return</span> nvalid;
<a name="l00072"></a>00072 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a57a488065fd31edc4276c24af0a2fe53"></a><!-- doxytag: member="spc_utils.h::has_backwindow" ref="a57a488065fd31edc4276c24af0a2fe53" args="(const colinfo *actcatinfo)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structpx__point.html">px_point</a> has_backwindow </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structcolinfo.html">colinfo</a> *&nbsp;</td>
          <td class="paramname"> <em>actcatinfo</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Function: has_backwindow The functions searches for columns which describe the apertures around the <a class="el" href="structobject.html">object</a> to compute the background. This information is stored in the columns :BACKWIN_UPP and :BACKWIN_LOW</p>
<p>Parameters: </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>actcatinfo</em>&nbsp;</td><td>- the structure with the column names</td></tr>
  </table>
  </dd>
</dl>
<p>Returns: </p>
<dl class="return"><dt><b>Returns:</b></dt><dd>hasmags+magauto - the number of columns with magnitudes </dd></dl>

<p><div class="fragment"><pre class="fragment"><a name="l00526"></a>00526 {
<a name="l00527"></a>00527 
<a name="l00528"></a>00528   <a class="code" href="structpx__point.html">px_point</a> ret;
<a name="l00529"></a>00529   
<a name="l00530"></a>00530   ret.<a class="code" href="structpx__point.html#ab715a558731a820a25b50bd7797dd004">x</a> = -1;
<a name="l00531"></a>00531   ret.<a class="code" href="structpx__point.html#a2d02b900722a71f22a8d5100822bda61">y</a> = -1;
<a name="l00532"></a>00532 
<a name="l00533"></a>00533   <span class="comment">// check the backwindow column</span>
<a name="l00534"></a>00534   ret.<a class="code" href="structpx__point.html#ab715a558731a820a25b50bd7797dd004">x</a> = <a class="code" href="spc__utils_8c.html#a5c6acd1c34d2de7d9e7d369a6518eb54">get_columnumber</a>(<span class="stringliteral">&quot;BACKWINDOW&quot;</span>, actcatinfo);
<a name="l00535"></a>00535   ret.<a class="code" href="structpx__point.html#a2d02b900722a71f22a8d5100822bda61">y</a> = -1;
<a name="l00536"></a>00536 
<a name="l00537"></a>00537   <span class="keywordflow">if</span> (!ret.<a class="code" href="structpx__point.html#ab715a558731a820a25b50bd7797dd004">x</a>)
<a name="l00538"></a>00538     {
<a name="l00539"></a>00539       ret.<a class="code" href="structpx__point.html#ab715a558731a820a25b50bd7797dd004">x</a>=-1;
<a name="l00540"></a>00540       ret.<a class="code" href="structpx__point.html#a2d02b900722a71f22a8d5100822bda61">y</a>=-1;
<a name="l00541"></a>00541     }
<a name="l00542"></a>00542 
<a name="l00543"></a>00543   <span class="comment">// -----------------------------</span>
<a name="l00544"></a>00544   <span class="comment">//</span>
<a name="l00545"></a>00545   <span class="comment">// code for FORS2-MXU</span>
<a name="l00546"></a>00546   <span class="comment">// ret.x = get_columnumber(&quot;BACKWIN_UPP&quot;, actcatinfo);</span>
<a name="l00547"></a>00547   <span class="comment">// ret.y = get_columnumber(&quot;BACKWIN_LOW&quot;, actcatinfo);</span>
<a name="l00548"></a>00548   <span class="comment">// if (!ret.x || !ret.y)</span>
<a name="l00549"></a>00549   <span class="comment">//  {</span>
<a name="l00550"></a>00550   <span class="comment">//    ret.x=-1;</span>
<a name="l00551"></a>00551   <span class="comment">//    ret.y=-1;</span>
<a name="l00552"></a>00552   <span class="comment">//  }</span>
<a name="l00553"></a>00553    
<a name="l00554"></a>00554   <span class="keywordflow">return</span> ret;
<a name="l00555"></a>00555 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a50e5a8658878acd54ee085583f3964b7"></a><!-- doxytag: member="spc_utils.h::has_magnitudes" ref="a50e5a8658878acd54ee085583f3964b7" args="(const colinfo *actcatinfo)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int has_magnitudes </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structcolinfo.html">colinfo</a> *&nbsp;</td>
          <td class="paramname"> <em>actcatinfo</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Function: has_magnitudes The functions searches for columns with magnitudes in the set of column names within the catalog header structure</p>
<p>Parameters: </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>actcatinfo</em>&nbsp;</td><td>- the structure with the column names</td></tr>
  </table>
  </dd>
</dl>
<p>Returns: </p>
<dl class="return"><dt><b>Returns:</b></dt><dd>hasmags+magauto - the number of columns with magnitudes </dd></dl>

<p><div class="fragment"><pre class="fragment"><a name="l00475"></a>00475                                           {
<a name="l00476"></a>00476 
<a name="l00477"></a>00477   <span class="keywordtype">int</span> hasmags = 0, magauto=0;
<a name="l00478"></a>00478   <span class="keywordtype">int</span> i= 0;
<a name="l00479"></a>00479   <span class="comment">//int iwlength=0;</span>
<a name="l00480"></a>00480 
<a name="l00481"></a>00481   <span class="comment">// go over all columns</span>
<a name="l00482"></a>00482   <span class="keywordflow">for</span> (i = 0; i &lt; actcatinfo-&gt;<a class="code" href="structcolinfo.html#aeac67ce88746e560df5b1f503d26a670">numcols</a>; i++)
<a name="l00483"></a>00483     {
<a name="l00484"></a>00484       <span class="comment">// look whether the column name is suspicious</span>
<a name="l00485"></a>00485       <span class="keywordflow">if</span> (strstr(actcatinfo-&gt;<a class="code" href="structcolinfo.html#a001692bf4f745ef0c5066c8ece0f7628">columns</a>[i].<a class="code" href="structsexcol.html#a570145e70159e58db2e88d99830dda95">name</a>,<span class="stringliteral">&quot;MAG_&quot;</span>) != NULL)
<a name="l00486"></a>00486         {
<a name="l00487"></a>00487           <span class="comment">// look whether the column name is &apos;MAG_AUTO&apos;</span>
<a name="l00488"></a>00488           <span class="keywordflow">if</span> (!strcmp(actcatinfo-&gt;<a class="code" href="structcolinfo.html#a001692bf4f745ef0c5066c8ece0f7628">columns</a>[i].<a class="code" href="structsexcol.html#a570145e70159e58db2e88d99830dda95">name</a>,<span class="stringliteral">&quot;MAG_AUTO&quot;</span>))
<a name="l00489"></a>00489             {
<a name="l00490"></a>00490               <span class="comment">// increment the counter for mag_auto</span>
<a name="l00491"></a>00491               magauto++;
<a name="l00492"></a>00492             }
<a name="l00493"></a>00493           <span class="keywordflow">else</span>
<a name="l00494"></a>00494             {
<a name="l00495"></a>00495               <span class="comment">// look whether it is possible to extract a wavelength</span>
<a name="l00496"></a>00496               <span class="comment">// from the column name</span>
<a name="l00497"></a>00497               <span class="keywordflow">if</span> (<a class="code" href="spc__utils_8c.html#a68eb57d69bfda17abe4d99b5f9c27705">resolve_colname</a>(actcatinfo-&gt;<a class="code" href="structcolinfo.html#a001692bf4f745ef0c5066c8ece0f7628">columns</a>[i].<a class="code" href="structsexcol.html#a570145e70159e58db2e88d99830dda95">name</a>))
<a name="l00498"></a>00498                 hasmags++;
<a name="l00499"></a>00499               <span class="comment">// increment the counter for columns with wavelengths coded</span>
<a name="l00500"></a>00500             }
<a name="l00501"></a>00501         }
<a name="l00502"></a>00502     }
<a name="l00503"></a>00503   <span class="comment">// exit if there is mag_auto plus other magnitude columns</span>
<a name="l00504"></a>00504   <span class="keywordflow">if</span> (magauto &amp;&amp; hasmags)
<a name="l00505"></a>00505     <a class="code" href="aXe__errors_8c.html#a7ef7588e5f91237ba7ce4084e6ed3c11">aXe_message</a> (<a class="code" href="aXe__errors_8h.html#a2556a67874555249b07691c37aa6d6e9">aXe_M_FATAL</a>, __FILE__, __LINE__,
<a name="l00506"></a>00506                  <span class="stringliteral">&quot;There exist MAG_AUTO plus additional columns with magnitudes!\n&quot;</span>);
<a name="l00507"></a>00507 
<a name="l00508"></a>00508   <span class="comment">// return the number of magnitude columns</span>
<a name="l00509"></a>00509   <span class="keywordflow">return</span> (hasmags+magauto);
<a name="l00510"></a>00510 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a77125dc504a3f1905e2f89b0296d37cf"></a><!-- doxytag: member="spc_utils.h::has_modelinfo" ref="a77125dc504a3f1905e2f89b0296d37cf" args="(const colinfo *actcatinfo)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structpx__point.html">px_point</a> has_modelinfo </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structcolinfo.html">colinfo</a> *&nbsp;</td>
          <td class="paramname"> <em>actcatinfo</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Function: has_modelinfo The function searches for the columns 'MODSPEC' and 'MODIMAGE'. The column numbers are returned. if not found, the column index -1 is returned.</p>
<p>Parameters: </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>actcatinfo</em>&nbsp;</td><td>- the structure with the column names</td></tr>
  </table>
  </dd>
</dl>
<p>Returns: </p>
<dl class="return"><dt><b>Returns:</b></dt><dd>ret - column numbers for <a class="el" href="structobject.html">object</a> shape and spectral model </dd></dl>

<p><div class="fragment"><pre class="fragment"><a name="l00571"></a>00571 {
<a name="l00572"></a>00572 
<a name="l00573"></a>00573   <a class="code" href="structpx__point.html">px_point</a> ret;
<a name="l00574"></a>00574   
<a name="l00575"></a>00575   ret.<a class="code" href="structpx__point.html#ab715a558731a820a25b50bd7797dd004">x</a> = -1;
<a name="l00576"></a>00576   ret.<a class="code" href="structpx__point.html#a2d02b900722a71f22a8d5100822bda61">y</a> = -1;
<a name="l00577"></a>00577 
<a name="l00578"></a>00578   <span class="comment">// check for each column</span>
<a name="l00579"></a>00579   ret.<a class="code" href="structpx__point.html#ab715a558731a820a25b50bd7797dd004">x</a> = <a class="code" href="spc__utils_8c.html#a5c6acd1c34d2de7d9e7d369a6518eb54">get_columnumber</a>(<span class="stringliteral">&quot;MODSPEC&quot;</span>, actcatinfo);
<a name="l00580"></a>00580   ret.<a class="code" href="structpx__point.html#a2d02b900722a71f22a8d5100822bda61">y</a> = <a class="code" href="spc__utils_8c.html#a5c6acd1c34d2de7d9e7d369a6518eb54">get_columnumber</a>(<span class="stringliteral">&quot;MODIMAGE&quot;</span>, actcatinfo);
<a name="l00581"></a>00581 
<a name="l00582"></a>00582   <span class="keywordflow">if</span> (!ret.<a class="code" href="structpx__point.html#ab715a558731a820a25b50bd7797dd004">x</a>)
<a name="l00583"></a>00583     ret.<a class="code" href="structpx__point.html#ab715a558731a820a25b50bd7797dd004">x</a>=-1;
<a name="l00584"></a>00584   <span class="keywordflow">if</span> (!ret.<a class="code" href="structpx__point.html#a2d02b900722a71f22a8d5100822bda61">y</a>)
<a name="l00585"></a>00585     ret.<a class="code" href="structpx__point.html#a2d02b900722a71f22a8d5100822bda61">y</a>=-1;
<a name="l00586"></a>00586 
<a name="l00587"></a>00587   <span class="comment">// return the column numbers</span>
<a name="l00588"></a>00588   <span class="keywordflow">return</span> ret;
<a name="l00589"></a>00589 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="ab90505406d3960f2f61d6db4c5a9b7cc"></a><!-- doxytag: member="spc_utils.h::init_search" ref="ab90505406d3960f2f61d6db4c5a9b7cc" args="(const char *string)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void init_search </td>
          <td>(</td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>string</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p><div class="fragment"><pre class="fragment"><a name="l00841"></a>00841 {
<a name="l00842"></a>00842   <span class="keywordtype">size_t</span> i;
<a name="l00843"></a>00843   
<a name="l00844"></a>00844   <a class="code" href="spc__utils_8c.html#a7360b55975153b822efc5217b7734e6a">len</a> = strlen (<span class="keywordtype">string</span>);
<a name="l00845"></a>00845   <span class="keywordflow">for</span> (i = 0; i &lt;= UCHAR_MAX; i++)      <span class="comment">/* rdg 10/93 */</span>
<a name="l00846"></a>00846     <a class="code" href="spc__utils_8c.html#a3278fc9538370857ff6034411692abd1">table</a>[i] = <a class="code" href="spc__utils_8c.html#a7360b55975153b822efc5217b7734e6a">len</a>;
<a name="l00847"></a>00847   <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="spc__utils_8c.html#a7360b55975153b822efc5217b7734e6a">len</a>; i++)
<a name="l00848"></a>00848     <a class="code" href="spc__utils_8c.html#a3278fc9538370857ff6034411692abd1">table</a>[(<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>) <span class="keywordtype">string</span>[i]] = len - i - 1;
<a name="l00849"></a>00849   <a class="code" href="spc__utils_8c.html#a9b856709f3a6aa9192b8075a5154cb73">findme</a> = (<span class="keywordtype">char</span> *) <span class="keywordtype">string</span>;
<a name="l00850"></a>00850 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a8e9536e04ecffec6365a655c18070867"></a><!-- doxytag: member="spc_utils.h::is_valid_entry" ref="a8e9536e04ecffec6365a655c18070867" args="(double mag)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int is_valid_entry </td>
          <td>(</td>
          <td class="paramtype">double&nbsp;</td>
          <td class="paramname"> <em>mag</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Function: is_valid_entry The routine checks whether a magnitude is valid or not. Returns true/false in case the value is valid/not valid.</p>
<p>Parameters: </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>mag</em>&nbsp;</td><td>- the magnitude to be checked</td></tr>
  </table>
  </dd>
</dl>
<p>Returns: </p>
<dl class="return"><dt><b>Returns:</b></dt><dd>valid - 1/0 for valid/non valid magnitude, respectively </dd></dl>

<p><div class="fragment"><pre class="fragment"><a name="l00029"></a>00029                           {
<a name="l00030"></a>00030 
<a name="l00031"></a>00031   <span class="keywordtype">int</span> valid = 0;
<a name="l00032"></a>00032 
<a name="l00033"></a>00033   <span class="comment">// Magnitudes must be in the range 0.0 &lt; mag &lt; 90.0.</span>
<a name="l00034"></a>00034   <span class="comment">// Sextractor usually gives the value 99.0 if the flux</span>
<a name="l00035"></a>00035   <span class="comment">// is below zero.</span>
<a name="l00036"></a>00036   <span class="keywordflow">if</span> (mag &lt; 0.0 || mag &gt; 90.0)
<a name="l00037"></a>00037     valid=0;
<a name="l00038"></a>00038   <span class="keywordflow">else</span>
<a name="l00039"></a>00039     valid=1;
<a name="l00040"></a>00040 
<a name="l00041"></a>00041   <span class="keywordflow">return</span> valid;
<a name="l00042"></a>00042 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a4a82c9b42093bc1e0795ef6441f89c49"></a><!-- doxytag: member="spc_utils.h::isnum2" ref="a4a82c9b42093bc1e0795ef6441f89c49" args="(char *string)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int isnum2 </td>
          <td>(</td>
          <td class="paramtype">char *&nbsp;</td>
          <td class="paramname"> <em>string</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Function: isnum2 determine if a string is a number</p>
<p>Parameters: </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>str</em>&nbsp;</td><td>a pointer to a string to test</td></tr>
  </table>
  </dd>
</dl>
<p>Retruns: </p>
<dl class="return"><dt><b>Returns:</b></dt><dd>1 if string contains a numeric entry, 0 otherwise </dd></dl>

<p><div class="fragment"><pre class="fragment"><a name="l00905"></a>00905 {
<a name="l00906"></a>00906   <span class="keywordtype">int</span> lstr, i, nd;
<a name="l00907"></a>00907   <span class="keywordtype">char</span> cstr, cstr1;
<a name="l00908"></a>00908   <span class="keywordtype">int</span> fpcode;
<a name="l00909"></a>00909   
<a name="l00910"></a>00910   <span class="comment">/* Return 0 if string is NULL */</span>
<a name="l00911"></a>00911   <span class="keywordflow">if</span> (<span class="keywordtype">string</span> == NULL)
<a name="l00912"></a>00912     <span class="keywordflow">return</span> (0);
<a name="l00913"></a>00913   
<a name="l00914"></a>00914   lstr = strlen (<span class="keywordtype">string</span>);
<a name="l00915"></a>00915   nd = 0;
<a name="l00916"></a>00916   fpcode = 1;
<a name="l00917"></a>00917 
<a name="l00918"></a>00918   <span class="comment">/* Return 0 if string starts with a D or E */</span>
<a name="l00919"></a>00919   cstr = <span class="keywordtype">string</span>[0];
<a name="l00920"></a>00920   <span class="keywordflow">if</span> (cstr == <span class="charliteral">&apos;D&apos;</span> || cstr == <span class="charliteral">&apos;d&apos;</span> || cstr == <span class="charliteral">&apos;E&apos;</span> || cstr == <span class="charliteral">&apos;e&apos;</span>)
<a name="l00921"></a>00921     {
<a name="l00922"></a>00922       <span class="keywordflow">return</span> (0);
<a name="l00923"></a>00923     }
<a name="l00924"></a>00924 
<a name="l00925"></a>00925   <span class="comment">/* Numeric strings contain 0123456789-+ and d or e for exponents */</span>
<a name="l00926"></a>00926   <span class="keywordflow">for</span> (i = 0; i &lt; lstr; i++)
<a name="l00927"></a>00927     {
<a name="l00928"></a>00928       cstr = <span class="keywordtype">string</span>[i];
<a name="l00929"></a>00929       <span class="keywordflow">if</span> (cstr == <span class="charliteral">&apos;\n&apos;</span>)
<a name="l00930"></a>00930         <span class="keywordflow">break</span>;
<a name="l00931"></a>00931       <span class="keywordflow">if</span> (cstr == <span class="charliteral">&apos; &apos;</span> &amp;&amp; nd == 0)
<a name="l00932"></a>00932         <span class="keywordflow">continue</span>;
<a name="l00933"></a>00933       <span class="keywordflow">if</span> ((cstr &lt; 48 || cstr &gt; 57) &amp;&amp; cstr != <span class="charliteral">&apos;+&apos;</span> &amp;&amp; cstr != <span class="charliteral">&apos;-&apos;</span>
<a name="l00934"></a>00934           &amp;&amp; cstr != <span class="charliteral">&apos;D&apos;</span> &amp;&amp; cstr != <span class="charliteral">&apos;d&apos;</span> &amp;&amp; cstr != <span class="charliteral">&apos;E&apos;</span> &amp;&amp; cstr != <span class="charliteral">&apos;e&apos;</span>
<a name="l00935"></a>00935           &amp;&amp; cstr != <span class="charliteral">&apos;.&apos;</span>)
<a name="l00936"></a>00936         <span class="keywordflow">return</span> (0);
<a name="l00937"></a>00937       <span class="keywordflow">else</span> <span class="keywordflow">if</span> (cstr == <span class="charliteral">&apos;+&apos;</span> || cstr == <span class="charliteral">&apos;-&apos;</span>)
<a name="l00938"></a>00938         {
<a name="l00939"></a>00939           <span class="keywordflow">if</span> (<span class="keywordtype">string</span>[i + 1] == <span class="charliteral">&apos;-&apos;</span> || <span class="keywordtype">string</span>[i + 1] == <span class="charliteral">&apos;+&apos;</span>)
<a name="l00940"></a>00940             <span class="keywordflow">return</span> (0);
<a name="l00941"></a>00941           <span class="keywordflow">else</span> <span class="keywordflow">if</span> (i &gt; 0)
<a name="l00942"></a>00942             {
<a name="l00943"></a>00943               cstr1 = <span class="keywordtype">string</span>[i - 1];
<a name="l00944"></a>00944               <span class="keywordflow">if</span> (cstr1 != <span class="charliteral">&apos;D&apos;</span> &amp;&amp; cstr1 != <span class="charliteral">&apos;d&apos;</span> &amp;&amp; cstr1 != <span class="charliteral">&apos;E&apos;</span>
<a name="l00945"></a>00945                   &amp;&amp; cstr1 != <span class="charliteral">&apos;e&apos;</span> &amp;&amp; cstr1 != <span class="charliteral">&apos; &apos;</span>)
<a name="l00946"></a>00946                 <span class="keywordflow">return</span> (0);
<a name="l00947"></a>00947             }
<a name="l00948"></a>00948         }
<a name="l00949"></a>00949       <span class="keywordflow">else</span> <span class="keywordflow">if</span> (cstr &gt;= 47 &amp;&amp; cstr &lt;= 57)
<a name="l00950"></a>00950         nd++;
<a name="l00951"></a>00951       <span class="keywordflow">if</span> (cstr == <span class="charliteral">&apos;.&apos;</span> || cstr == <span class="charliteral">&apos;d&apos;</span> || cstr == <span class="charliteral">&apos;e&apos;</span> || cstr == <span class="charliteral">&apos;d&apos;</span>
<a name="l00952"></a>00952           || cstr == <span class="charliteral">&apos;e&apos;</span>)
<a name="l00953"></a>00953         fpcode = 2;
<a name="l00954"></a>00954     }
<a name="l00955"></a>00955   <span class="keywordflow">if</span> (nd &gt; 0)
<a name="l00956"></a>00956     <span class="keywordflow">return</span> (fpcode);
<a name="l00957"></a>00957   <span class="keywordflow">else</span>
<a name="l00958"></a>00958     <span class="keywordflow">return</span> (0);
<a name="l00959"></a>00959 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a045718d450da547eb37a4413e815d4d8"></a><!-- doxytag: member="spc_utils.h::line_is_valid" ref="a045718d450da547eb37a4413e815d4d8" args="(const colinfo *actcatinfo, char line[])" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int line_is_valid </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structcolinfo.html">colinfo</a> *&nbsp;</td>
          <td class="paramname"> <em>actcatinfo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char&nbsp;</td>
          <td class="paramname"> <em>line</em>[]</td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Function: line_is_valid The function checks whether a catalog line is valid. Valid lines have a data entry for each catalog column</p>
<p>Parameters: </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>actcatinfo</em>&nbsp;</td><td>- the header of the catalog </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>line</em>&nbsp;</td><td>- line to be examined</td></tr>
  </table>
  </dd>
</dl>
<p>Returns: </p>
<dl class="return"><dt><b>Returns:</b></dt><dd>0/1 - 0 for not valid lines, 1 for a valid line </dd></dl>

<p><div class="fragment"><pre class="fragment"><a name="l00396"></a>00396 {
<a name="l00397"></a>00397 
<a name="l00398"></a>00398   gsl_vector *v;
<a name="l00399"></a>00399 
<a name="l00400"></a>00400   <span class="comment">// transform the line into a vector with the data values</span>
<a name="l00401"></a>00401   <a class="code" href="spc__utils_8c.html#a5173a4942a3d83d368b97ad51aabedb6">lv1ws</a> (line);
<a name="l00402"></a>00402   v = <a class="code" href="spc__utils_8c.html#ae52364129107c1b86e38dd795086046d">string_to_gsl_array</a> (line);
<a name="l00403"></a>00403 
<a name="l00404"></a>00404   <span class="comment">// an empty vector indicates a non valid line</span>
<a name="l00405"></a>00405   <span class="keywordflow">if</span> (v==NULL) <span class="keywordflow">return</span> 0;
<a name="l00406"></a>00406 
<a name="l00407"></a>00407   <span class="comment">// compare the vector length to the number of columns</span>
<a name="l00408"></a>00408   <span class="comment">// and return &apos;0&apos; for a non valid line if the numbers differ</span>
<a name="l00409"></a>00409   <span class="keywordflow">if</span> ((<span class="keywordtype">int</span>)v-&gt;size != actcatinfo-&gt;<a class="code" href="structcolinfo.html#aeac67ce88746e560df5b1f503d26a670">numcols</a>)
<a name="l00410"></a>00410     <span class="keywordflow">return</span> 0;
<a name="l00411"></a>00411 
<a name="l00412"></a>00412   <span class="comment">// return &apos;1&apos; for a valid line</span>
<a name="l00413"></a>00413   <span class="keywordflow">return</span> 1;
<a name="l00414"></a>00414 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="ac89172f10962f24de5d0284500597c64"></a><!-- doxytag: member="spc_utils.h::load_dummy_observation" ref="ac89172f10962f24de5d0284500597c64" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structobservation.html">observation</a>* load_dummy_observation </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Function: load_dummy_observation A function that returns a dummy allocated abservation pointer.</p>
<p>Returns: </p>
<dl class="return"><dt><b>Returns:</b></dt><dd>obs - pointer to the dummy <a class="el" href="structobservation.html">observation</a> </dd></dl>

<p><div class="fragment"><pre class="fragment"><a name="l01170"></a>01170 {
<a name="l01171"></a>01171      <a class="code" href="structobservation.html">observation</a> *obs;
<a name="l01172"></a>01172 
<a name="l01173"></a>01173      obs = malloc (<span class="keyword">sizeof</span> (<a class="code" href="structobservation.html">observation</a>));
<a name="l01174"></a>01174      obs-&gt;<a class="code" href="structobservation.html#a012c0ff489fbb74fc6c9abfbd7c6e320">grism</a> = <a class="code" href="aXe__grism_8h.html#a1214ab1bea5fd80474d7a27db0bfb429">gsl_matrix_alloc</a> (2, 2);
<a name="l01175"></a>01175      obs-&gt;<a class="code" href="structobservation.html#a79ef486b081fa7b1973c39323f163010">pixerrs</a> = <a class="code" href="aXe__grism_8h.html#a1214ab1bea5fd80474d7a27db0bfb429">gsl_matrix_alloc</a> (2, 2);
<a name="l01176"></a>01176 
<a name="l01177"></a>01177      <span class="keywordflow">return</span> obs;
<a name="l01178"></a>01178 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a5173a4942a3d83d368b97ad51aabedb6"></a><!-- doxytag: member="spc_utils.h::lv1ws" ref="a5173a4942a3d83d368b97ad51aabedb6" args="(char *str)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void lv1ws </td>
          <td>(</td>
          <td class="paramtype">char *&nbsp;</td>
          <td class="paramname"> <em>str</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Function: lv1ws Convert in-place all blanks in a string into single space.</p>
<p>Parameters: </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>str</em>&nbsp;</td><td>- a pointer to a string. </td></tr>
  </table>
  </dd>
</dl>

<p><div class="fragment"><pre class="fragment"><a name="l01097"></a>01097 {
<a name="l01098"></a>01098   <span class="keywordtype">char</span> *ibuf, *obuf;
<a name="l01099"></a>01099   <span class="keywordtype">int</span> i, cnt;
<a name="l01100"></a>01100   
<a name="l01101"></a>01101   <span class="keywordflow">if</span> (str)
<a name="l01102"></a>01102     {
<a name="l01103"></a>01103       ibuf = obuf = str;
<a name="l01104"></a>01104       i = cnt = 0;
<a name="l01105"></a>01105       
<a name="l01106"></a>01106       <span class="keywordflow">while</span> (*ibuf)
<a name="l01107"></a>01107         {
<a name="l01108"></a>01108           <span class="keywordflow">if</span> (isspace ((<span class="keywordtype">int</span>) *ibuf) &amp;&amp; cnt)
<a name="l01109"></a>01109             ibuf++;
<a name="l01110"></a>01110           <span class="keywordflow">else</span>
<a name="l01111"></a>01111             {
<a name="l01112"></a>01112               <span class="keywordflow">if</span> (!isspace ((<span class="keywordtype">int</span>) *ibuf))
<a name="l01113"></a>01113                 cnt = 0;
<a name="l01114"></a>01114               <span class="keywordflow">else</span>
<a name="l01115"></a>01115                 {
<a name="l01116"></a>01116                   *ibuf = <span class="charliteral">&apos; &apos;</span>;
<a name="l01117"></a>01117                   cnt = 1;
<a name="l01118"></a>01118                 }
<a name="l01119"></a>01119               obuf[i++] = *ibuf++;
<a name="l01120"></a>01120             }
<a name="l01121"></a>01121         }
<a name="l01122"></a>01122       obuf[i] = <span class="charliteral">&apos;\0&apos;</span>;
<a name="l01123"></a>01123     }
<a name="l01124"></a>01124 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a1300c5f47fbca9f266e3536034a859e0"></a><!-- doxytag: member="spc_utils.h::make_GOL_header" ref="a1300c5f47fbca9f266e3536034a859e0" args="(FILE *fout, const colinfo *actcatinfo, const gsl_vector *waves, const gsl_vector *cnums, const px_point backwin_cols, const px_point modinfo_cols)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void make_GOL_header </td>
          <td>(</td>
          <td class="paramtype">FILE *&nbsp;</td>
          <td class="paramname"> <em>fout</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structcolinfo.html">colinfo</a> *&nbsp;</td>
          <td class="paramname"> <em>actcatinfo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const gsl_vector *&nbsp;</td>
          <td class="paramname"> <em>waves</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const gsl_vector *&nbsp;</td>
          <td class="paramname"> <em>cnums</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structpx__point.html">px_point</a>&nbsp;</td>
          <td class="paramname"> <em>backwin_cols</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structpx__point.html">px_point</a>&nbsp;</td>
          <td class="paramname"> <em>modinfo_cols</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Function: make_GOL_header The function prints the header of a GOL file to an output stream. Besides the standard columns it composes the names for the magnitude columns and also makes the header entries for those columns</p>
<p>Parameters: </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>fout</em>&nbsp;</td><td>- the output stream </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>actcatinfo</em>&nbsp;</td><td>- the structure with the header information of the SExtractor catalog </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>waves</em>&nbsp;</td><td>- vector with the wavelengths of magnitude columns </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>cnums</em>&nbsp;</td><td>- vector with the column numbers of magnitude columns </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>backwin_cols</em>&nbsp;</td><td>- vector with the column numbers of background window columns </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>modinfo_cols</em>&nbsp;</td><td>- vector with the column numbers of modelling index numbers </td></tr>
  </table>
  </dd>
</dl>

<p><div class="fragment"><pre class="fragment"><a name="l00172"></a>00172 {
<a name="l00173"></a>00173 
<a name="l00174"></a>00174   <span class="keywordtype">char</span> str[<a class="code" href="spc__sex_8h.html#a385dd6d87c5af9252e1c0bf82d87e969">CATBUFFERSIZE</a>];
<a name="l00175"></a>00175   <span class="keywordtype">char</span> cname[<a class="code" href="spc__utils_8h.html#a840c8714a6150c8842d085a7de95a5bf">COLNAMELENGTH</a>];
<a name="l00176"></a>00176   <span class="keywordtype">int</span> cbase=1;
<a name="l00177"></a>00177   <span class="keywordtype">int</span> i=0;
<a name="l00178"></a>00178 
<a name="l00179"></a>00179   sprintf (str, <span class="stringliteral">&quot;#%3i NUMBER       Running object number\n&quot;</span>, cbase++);
<a name="l00180"></a>00180   fputs (str, fout);
<a name="l00181"></a>00181   sprintf (str, <span class="stringliteral">&quot;#%3i X_WORLD      Barycenter position along world x axis     [deg]\n&quot;</span>, cbase++);
<a name="l00182"></a>00182   fputs (str, fout);
<a name="l00183"></a>00183   sprintf (str, <span class="stringliteral">&quot;#%3i Y_WORLD      Barycenter position along world Y axis     [deg]\n&quot;</span>, cbase++);
<a name="l00184"></a>00184   fputs (str, fout);
<a name="l00185"></a>00185   sprintf (str, <span class="stringliteral">&quot;#%3i A_WORLD      Profile RMS along major axis (world units) [deg]\n&quot;</span>, cbase++);
<a name="l00186"></a>00186   fputs (str, fout);
<a name="l00187"></a>00187   sprintf (str, <span class="stringliteral">&quot;#%3i B_WORLD      Profile RMS along minor axis (world units) [deg]\n&quot;</span>, cbase++);
<a name="l00188"></a>00188   fputs (str, fout);
<a name="l00189"></a>00189   sprintf (str, <span class="stringliteral">&quot;#%3i THETA_WORLD  Position angle (CCW/world-x)               [deg]\n&quot;</span>, cbase++);
<a name="l00190"></a>00190   fputs (str, fout);
<a name="l00191"></a>00191   sprintf (str, <span class="stringliteral">&quot;#%3i X_IMAGE      Object position along x                    [pixel]\n&quot;</span>, cbase++);
<a name="l00192"></a>00192   fputs (str, fout);
<a name="l00193"></a>00193   sprintf (str, <span class="stringliteral">&quot;#%3i Y_IMAGE      Object position along x                    [pixel]\n&quot;</span>, cbase++);
<a name="l00194"></a>00194   fputs (str, fout);
<a name="l00195"></a>00195   sprintf (str, <span class="stringliteral">&quot;#%3i A_IMAGE      Profile RMS along major axis               [pixel]\n&quot;</span>, cbase++);
<a name="l00196"></a>00196   fputs (str, fout);
<a name="l00197"></a>00197   sprintf (str, <span class="stringliteral">&quot;#%3i B_IMAGE      Profile RMS along minor axis               [pixel]\n&quot;</span>, cbase++);
<a name="l00198"></a>00198   fputs (str, fout);
<a name="l00199"></a>00199   sprintf (str, <span class="stringliteral">&quot;#%3i THETA_IMAGE  Position angle (CCW/x)                     [deg]\n&quot;</span>, cbase++);
<a name="l00200"></a>00200   fputs (str, fout);
<a name="l00201"></a>00201 
<a name="l00202"></a>00202   <span class="keywordflow">if</span> (backwin_cols.<a class="code" href="structpx__point.html#ab715a558731a820a25b50bd7797dd004">x</a> != -1)
<a name="l00203"></a>00203     {
<a name="l00204"></a>00204       sprintf (str, <span class="stringliteral">&quot;#%3i BACKWINDOW  Upper window for background                [pixel]\n&quot;</span>, cbase++);
<a name="l00205"></a>00205       fputs (str, fout);
<a name="l00206"></a>00206       <span class="comment">// old code for FORS2-MXU</span>
<a name="l00207"></a>00207       <span class="comment">// sprintf (str, &quot;#%3i BACKWIN_LOW  Lower window for background                [pixel]\n&quot;, cbase++);</span>
<a name="l00208"></a>00208       <span class="comment">// fputs (str, fout);</span>
<a name="l00209"></a>00209     }
<a name="l00210"></a>00210 
<a name="l00211"></a>00211   <span class="keywordflow">if</span> (modinfo_cols.<a class="code" href="structpx__point.html#ab715a558731a820a25b50bd7797dd004">x</a> != -1)
<a name="l00212"></a>00212     {
<a name="l00213"></a>00213       sprintf (str, <span class="stringliteral">&quot;#%3i MODSPEC      Index for model spectrum                  [pixel]\n&quot;</span>, cbase++);
<a name="l00214"></a>00214       fputs (str, fout);
<a name="l00215"></a>00215     }
<a name="l00216"></a>00216   <span class="keywordflow">if</span> (modinfo_cols.<a class="code" href="structpx__point.html#a2d02b900722a71f22a8d5100822bda61">y</a> != -1)
<a name="l00217"></a>00217     {
<a name="l00218"></a>00218       sprintf (str, <span class="stringliteral">&quot;#%3i MODIMAGE     Index for the object shape                [pixel]\n&quot;</span>, cbase++);
<a name="l00219"></a>00219       fputs (str, fout);
<a name="l00220"></a>00220     }
<a name="l00221"></a>00221 
<a name="l00222"></a>00222   <span class="keywordflow">if</span> ((<span class="keywordtype">int</span>)waves-&gt;size == 1 &amp;&amp; (<span class="keywordtype">int</span>)gsl_vector_get (waves, 0) == 0)
<a name="l00223"></a>00223     {
<a name="l00224"></a>00224       sprintf (str, <span class="stringliteral">&quot;#%3i MAG_AUTO     Kron-like elliptical aperture magnitude    [mag]\n&quot;</span>, cbase++);
<a name="l00225"></a>00225       fputs (str, fout);
<a name="l00226"></a>00226     }
<a name="l00227"></a>00227   <span class="keywordflow">else</span>
<a name="l00228"></a>00228     {
<a name="l00229"></a>00229       <span class="keywordflow">for</span> (i=0; i &lt; (int)waves-&gt;size; i++){
<a name="l00230"></a>00230         <a class="code" href="spc__utils_8c.html#a35d9db69c2b8f12924f8389532178efd">get_columname</a>(actcatinfo, (<span class="keywordtype">int</span>)gsl_vector_get (cnums, i), cname);
<a name="l00231"></a>00231         sprintf (str, <span class="stringliteral">&quot;#%3i %-13sAB-magnitude at wavelength %9i nm    [mag]\n&quot;</span>, cbase+i, cname, (<span class="keywordtype">int</span>)gsl_vector_get (waves, i));
<a name="l00232"></a>00232         fputs (str, fout);
<a name="l00233"></a>00233         
<a name="l00234"></a>00234       }
<a name="l00235"></a>00235     }
<a name="l00236"></a>00236 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a68eb57d69bfda17abe4d99b5f9c27705"></a><!-- doxytag: member="spc_utils.h::resolve_colname" ref="a68eb57d69bfda17abe4d99b5f9c27705" args="(const char colname[])" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int resolve_colname </td>
          <td>(</td>
          <td class="paramtype">const char&nbsp;</td>
          <td class="paramname"> <em>colname</em>[]</td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Function: resolve_colname The function extracts the wavelength from column names. The column names must have the format "MAG_CNNNNNN...C..." with C as character and N as a number.</p>
<p>Parameters: </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>colname</em>&nbsp;</td><td>- the column name</td></tr>
  </table>
  </dd>
</dl>
<p>Returns: </p>
<dl class="return"><dt><b>Returns:</b></dt><dd>iwave - the wavelength extracted from the column name </dd></dl>

<p><div class="fragment"><pre class="fragment"><a name="l00429"></a>00429                                      {
<a name="l00430"></a>00430 
<a name="l00431"></a>00431   <span class="keywordtype">char</span> tmp[<a class="code" href="spc__utils_8h.html#a840c8714a6150c8842d085a7de95a5bf">COLNAMELENGTH</a>];
<a name="l00432"></a>00432   <span class="keywordtype">char</span> **t_err=NULL;
<a name="l00433"></a>00433   <span class="keywordtype">char</span> *WorkPtr;
<a name="l00434"></a>00434   <span class="keywordtype">char</span> *WorkPtr2;
<a name="l00435"></a>00435 
<a name="l00436"></a>00436   <span class="keywordtype">int</span> i, <a class="code" href="spc__utils_8c.html#a7360b55975153b822efc5217b7734e6a">len</a>;
<a name="l00437"></a>00437   <span class="comment">//int nmagcols = 0;</span>
<a name="l00438"></a>00438   <span class="keywordtype">int</span> iwave=0;
<a name="l00439"></a>00439 
<a name="l00440"></a>00440   <span class="comment">// copy everything after &apos;MAG_C&apos; to tmp</span>
<a name="l00441"></a>00441   strcpy(tmp, &amp;colname[5]);
<a name="l00442"></a>00442 
<a name="l00443"></a>00443   <span class="comment">// place pointer at both ends of tmp</span>
<a name="l00444"></a>00444   WorkPtr = tmp;
<a name="l00445"></a>00445   WorkPtr2 = tmp+ strlen (tmp);
<a name="l00446"></a>00446   *WorkPtr2-- = <span class="charliteral">&apos;\0&apos;</span>;
<a name="l00447"></a>00447   len = strlen(tmp);
<a name="l00448"></a>00448 
<a name="l00449"></a>00449   <span class="comment">// check whether the string is a number,</span>
<a name="l00450"></a>00450   <span class="comment">// and cut away a digit at the end if not</span>
<a name="l00451"></a>00451   i = 0;
<a name="l00452"></a>00452   <span class="keywordflow">while</span> (i++ &lt; len){
<a name="l00453"></a>00453     iwave = (int)strtol(WorkPtr,t_err,10);
<a name="l00454"></a>00454     <span class="keywordflow">if</span> (iwave != 0)
<a name="l00455"></a>00455       <span class="keywordflow">break</span>;
<a name="l00456"></a>00456     *WorkPtr2-- = <span class="charliteral">&apos;\0&apos;</span>;
<a name="l00457"></a>00457   }
<a name="l00458"></a>00458 
<a name="l00459"></a>00459   <span class="comment">// return the wavelength</span>
<a name="l00460"></a>00460   <span class="keywordflow">return</span> iwave;
<a name="l00461"></a>00461 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a758cf1ef470ca77056e97ce46e0cd95b"></a><!-- doxytag: member="spc_utils.h::rmlead" ref="a758cf1ef470ca77056e97ce46e0cd95b" args="(char *str)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">char* rmlead </td>
          <td>(</td>
          <td class="paramtype">char *&nbsp;</td>
          <td class="paramname"> <em>str</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p><div class="fragment"><pre class="fragment"><a name="l01147"></a>01147 {
<a name="l01148"></a>01148   <span class="keywordtype">char</span> *obuf;
<a name="l01149"></a>01149   
<a name="l01150"></a>01150   <span class="keywordflow">if</span> (str)
<a name="l01151"></a>01151     {
<a name="l01152"></a>01152       <span class="keywordflow">for</span> (obuf = str; *obuf &amp;&amp; isspace ((<span class="keywordtype">int</span>) *obuf); ++obuf);
<a name="l01153"></a>01153       <span class="keywordflow">if</span> (str != obuf)
<a name="l01154"></a>01154         <a class="code" href="spc__utils_8h.html#aa3ca150e9f00716cbf138ce56ff3ef9c">strMove</a> (str, obuf);
<a name="l01155"></a>01155     }
<a name="l01156"></a>01156   <span class="keywordflow">return</span> str;
<a name="l01157"></a>01157 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a8681db0694ab1aa93d402f813cfd520a"></a><!-- doxytag: member="spc_utils.h::stptok" ref="a8681db0694ab1aa93d402f813cfd520a" args="(const char *s, char *tok, size_t toklen, char *brk)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">char* stptok </td>
          <td>(</td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>s</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&nbsp;</td>
          <td class="paramname"> <em>tok</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&nbsp;</td>
          <td class="paramname"> <em>toklen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&nbsp;</td>
          <td class="paramname"> <em>brk</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Function: stptok A function to recursively tokenize an input string.</p>
<p>Parameters: </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>s</em>&nbsp;</td><td>a pointer to the input string. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>tok</em>&nbsp;</td><td>a pointer to the current token in s. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>toklen</em>&nbsp;</td><td>the length of the tok. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>brk</em>&nbsp;</td><td>the separator string to use.</td></tr>
  </table>
  </dd>
</dl>
<p>Returns: </p>
<dl class="return"><dt><b>Returns:</b></dt><dd>a new position in the input string. </dd></dl>

<p><div class="fragment"><pre class="fragment"><a name="l01057"></a>01057 {
<a name="l01058"></a>01058   <span class="keywordtype">char</span> *lim, *b;
<a name="l01059"></a>01059 
<a name="l01060"></a>01060   <span class="keywordflow">if</span> (!*s)
<a name="l01061"></a>01061     <span class="keywordflow">return</span> NULL;
<a name="l01062"></a>01062 
<a name="l01063"></a>01063   lim = tok + toklen - 1;
<a name="l01064"></a>01064   <span class="keywordflow">while</span> (*s &amp;&amp; tok &lt; lim)
<a name="l01065"></a>01065     {
<a name="l01066"></a>01066       <span class="keywordflow">for</span> (b = brk; *b; b++)
<a name="l01067"></a>01067         {
<a name="l01068"></a>01068           <span class="keywordflow">if</span> (*s == *b)
<a name="l01069"></a>01069             {
<a name="l01070"></a>01070               *tok = 0;
<a name="l01071"></a>01071               <span class="keywordflow">for</span> (++s, b = brk; *s &amp;&amp; *b; ++b)
<a name="l01072"></a>01072                 {
<a name="l01073"></a>01073                   <span class="keywordflow">if</span> (*s == *b)
<a name="l01074"></a>01074                     {
<a name="l01075"></a>01075                       ++s;
<a name="l01076"></a>01076                       b = brk;
<a name="l01077"></a>01077                     }
<a name="l01078"></a>01078                 }
<a name="l01079"></a>01079               <span class="keywordflow">return</span> (<span class="keywordtype">char</span> *) s;
<a name="l01080"></a>01080             }
<a name="l01081"></a>01081         }
<a name="l01082"></a>01082       *tok++ = *s++;
<a name="l01083"></a>01083     }
<a name="l01084"></a>01084   *tok = 0;
<a name="l01085"></a>01085   <span class="keywordflow">return</span> (<span class="keywordtype">char</span> *) s;
<a name="l01086"></a>01086 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="ae52364129107c1b86e38dd795086046d"></a><!-- doxytag: member="spc_utils.h::string_to_gsl_array" ref="ae52364129107c1b86e38dd795086046d" args="(char *str)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">gsl_vector* string_to_gsl_array </td>
          <td>(</td>
          <td class="paramtype">char *&nbsp;</td>
          <td class="paramname"> <em>str</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Function: string_to_gsl_array Parse the content of a string into a float GSL array. Checks each entry to ensure that it is numeric. skip over the non numerical ones. Entries containing ###,NaN, -NaN, +NaN are set to GSL_NAN.</p>
<p>Parameters: </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>str</em>&nbsp;</td><td>the pointer to a string containing floats to parse.</td></tr>
  </table>
  </dd>
</dl>
<p>Returns: </p>
<dl class="return"><dt><b>Returns:</b></dt><dd>v - the gslvector with the table row </dd></dl>

<p><div class="fragment"><pre class="fragment"><a name="l00979"></a>00979 {
<a name="l00980"></a>00980   <span class="keywordtype">char</span> *ptr, buf[256];
<a name="l00981"></a>00981   gsl_vector *v;
<a name="l00982"></a>00982   <span class="keywordtype">int</span> i, n = 0;
<a name="l00983"></a>00983   
<a name="l00984"></a>00984 
<a name="l00985"></a>00985   <span class="keywordflow">if</span> (str == NULL)
<a name="l00986"></a>00986     <span class="keywordflow">return</span> NULL;
<a name="l00987"></a>00987   
<a name="l00988"></a>00988   ptr = <a class="code" href="spc__utils_8c.html#a758cf1ef470ca77056e97ce46e0cd95b">rmlead</a> (str);
<a name="l00989"></a>00989   <a class="code" href="spc__utils_8c.html#a5173a4942a3d83d368b97ad51aabedb6">lv1ws</a> (ptr);
<a name="l00990"></a>00990   
<a name="l00991"></a>00991   <span class="comment">/* Find the number of elements */</span>
<a name="l00992"></a>00992   <span class="keywordflow">do</span>
<a name="l00993"></a>00993     {
<a name="l00994"></a>00994       ptr = <a class="code" href="spc__utils_8c.html#a8681db0694ab1aa93d402f813cfd520a">stptok</a> (ptr, buf, <span class="keyword">sizeof</span> (buf), <span class="stringliteral">&quot; &quot;</span>);
<a name="l00995"></a>00995       <span class="keywordflow">if</span> (<a class="code" href="spc__utils_8c.html#a4a82c9b42093bc1e0795ef6441f89c49">isnum2</a> (buf))
<a name="l00996"></a>00996         n++;
<a name="l00997"></a>00997       <span class="keywordflow">if</span> (!strcmp (buf, <span class="stringliteral">&quot;###&quot;</span>))
<a name="l00998"></a>00998         n++;            <span class="comment">/* Allow entries to be ### */</span>
<a name="l00999"></a>00999       <span class="keywordflow">if</span> (!strcmp (buf, <span class="stringliteral">&quot;NaN&quot;</span>))
<a name="l01000"></a>01000         n++;            <span class="comment">/* Allow entries to be ### */</span>
<a name="l01001"></a>01001       <span class="keywordflow">if</span> (!strcmp (buf, <span class="stringliteral">&quot;nan&quot;</span>))
<a name="l01002"></a>01002         n++;            <span class="comment">/* Allow entries to be ### */</span>
<a name="l01003"></a>01003       <span class="keywordflow">if</span> (!strcmp (buf, <span class="stringliteral">&quot;-NaN&quot;</span>))
<a name="l01004"></a>01004         n++;            <span class="comment">/* Allow entries to be ### */</span>
<a name="l01005"></a>01005       <span class="keywordflow">if</span> (!strcmp (buf, <span class="stringliteral">&quot;+NaN&quot;</span>))
<a name="l01006"></a>01006         n++;            <span class="comment">/* Allow entries to be ### */</span>
<a name="l01007"></a>01007       
<a name="l01008"></a>01008     }
<a name="l01009"></a>01009   <span class="keywordflow">while</span> (ptr &amp;&amp; *ptr);
<a name="l01010"></a>01010   
<a name="l01011"></a>01011   <span class="keywordflow">if</span> (n&lt;1) <span class="keywordflow">return</span> NULL;
<a name="l01012"></a>01012   
<a name="l01013"></a>01013   <span class="comment">/* Allocate a vector */</span>
<a name="l01014"></a>01014   v = gsl_vector_alloc (n);
<a name="l01015"></a>01015   <span class="comment">//     gsl_vector_set_zero (v);</span>
<a name="l01016"></a>01016   <span class="comment">/* Fill the vector */</span>
<a name="l01017"></a>01017   ptr = str;
<a name="l01018"></a>01018   <a class="code" href="spc__utils_8c.html#a5173a4942a3d83d368b97ad51aabedb6">lv1ws</a> (ptr);
<a name="l01019"></a>01019   
<a name="l01020"></a>01020   i = 0;
<a name="l01021"></a>01021   <span class="keywordflow">do</span>
<a name="l01022"></a>01022     {
<a name="l01023"></a>01023       ptr = <a class="code" href="spc__utils_8c.html#a8681db0694ab1aa93d402f813cfd520a">stptok</a> (ptr, buf, <span class="keyword">sizeof</span> (buf), <span class="stringliteral">&quot; &quot;</span>);
<a name="l01024"></a>01024       <span class="keywordflow">if</span> (<a class="code" href="spc__utils_8c.html#a4a82c9b42093bc1e0795ef6441f89c49">isnum2</a> (buf))
<a name="l01025"></a>01025         {
<a name="l01026"></a>01026           gsl_vector_set (v, i, atof (buf));
<a name="l01027"></a>01027           i++;
<a name="l01028"></a>01028         }
<a name="l01029"></a>01029       <span class="keywordflow">if</span> ((!strcmp (buf, <span class="stringliteral">&quot;###&quot;</span>)) || (!strcmp (buf, <span class="stringliteral">&quot;NaN&quot;</span>))
<a name="l01030"></a>01030           || (!strcmp (buf, <span class="stringliteral">&quot;-NaN&quot;</span>)) || (!strcmp (buf, <span class="stringliteral">&quot;+NaN&quot;</span>))
<a name="l01031"></a>01031           || (!strcmp (buf, <span class="stringliteral">&quot;nan&quot;</span>)))
<a name="l01032"></a>01032         {
<a name="l01033"></a>01033           gsl_vector_set (v, i, GSL_NAN);
<a name="l01034"></a>01034           i++;
<a name="l01035"></a>01035         }
<a name="l01036"></a>01036     }
<a name="l01037"></a>01037   <span class="keywordflow">while</span> (ptr &amp;&amp; *ptr);
<a name="l01038"></a>01038 
<a name="l01039"></a>01039   <span class="keywordflow">return</span> v;
<a name="l01040"></a>01040 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a288420ef2c849abe17db4f995aa73325"></a><!-- doxytag: member="spc_utils.h::strsearch" ref="a288420ef2c849abe17db4f995aa73325" args="(const char *string)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">char* strsearch </td>
          <td>(</td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>string</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p><div class="fragment"><pre class="fragment"><a name="l00864"></a>00864 {
<a name="l00865"></a>00865   <span class="keyword">register</span> <span class="keywordtype">size_t</span> shift = 0;
<a name="l00866"></a>00866   <span class="keyword">register</span> <span class="keywordtype">size_t</span> pos = <a class="code" href="spc__utils_8c.html#a7360b55975153b822efc5217b7734e6a">len</a> - 1;
<a name="l00867"></a>00867   <span class="keywordtype">char</span> *here;
<a name="l00868"></a>00868   <span class="keywordtype">size_t</span> limit = strlen (<span class="keywordtype">string</span>);
<a name="l00869"></a>00869 
<a name="l00870"></a>00870   <span class="keywordflow">while</span> (pos &lt; limit)
<a name="l00871"></a>00871     {
<a name="l00872"></a>00872       <span class="keywordflow">while</span> (pos &lt; limit
<a name="l00873"></a>00873              &amp;&amp; (shift = <a class="code" href="spc__utils_8c.html#a3278fc9538370857ff6034411692abd1">table</a>[(<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>) <span class="keywordtype">string</span>[pos]]) &gt; 0)
<a name="l00874"></a>00874         {
<a name="l00875"></a>00875           pos += shift;
<a name="l00876"></a>00876         }
<a name="l00877"></a>00877       <span class="keywordflow">if</span> (0 == shift)
<a name="l00878"></a>00878         {
<a name="l00879"></a>00879           <span class="keywordflow">if</span> (0 ==
<a name="l00880"></a>00880               strncmp (<a class="code" href="spc__utils_8c.html#a9b856709f3a6aa9192b8075a5154cb73">findme</a>, here =
<a name="l00881"></a>00881                        (<span class="keywordtype">char</span> *) &amp;<span class="keywordtype">string</span>[pos - <a class="code" href="spc__utils_8c.html#a7360b55975153b822efc5217b7734e6a">len</a> + 1], <a class="code" href="spc__utils_8c.html#a7360b55975153b822efc5217b7734e6a">len</a>))
<a name="l00882"></a>00882             {
<a name="l00883"></a>00883               <span class="keywordflow">return</span> (here);
<a name="l00884"></a>00884             }
<a name="l00885"></a>00885           <span class="keywordflow">else</span>
<a name="l00886"></a>00886             pos++;
<a name="l00887"></a>00887         }
<a name="l00888"></a>00888     }
<a name="l00889"></a>00889   <span class="keywordflow">return</span> NULL;
<a name="l00890"></a>00890 }
</pre></div></p>

</div>
</div>
</div>
<!--- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&nbsp;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&nbsp;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&nbsp;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&nbsp;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&nbsp;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&nbsp;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&nbsp;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&nbsp;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&nbsp;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&nbsp;</span>Defines</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<hr size="1"/><address style="text-align: right;"><small>Generated on 12 Oct 2014 for TIPS by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.6.1 </small></address>
</body>
</html>
