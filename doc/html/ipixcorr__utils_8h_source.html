<!-- This comment will put IE 6, 7 and 8 in quirks mode -->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>TIPS: /renoir/fourmano/Desktop/OUSIM/TIPS/branches/tips_build/include/axesim/ipixcorr_utils.h Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javaScript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body onload='searchBox.OnSelectItem(0);'>
<!-- Generated by Doxygen 1.6.1 -->
<script type="text/javascript"><!--
var searchBox = new SearchBox("searchBox", "search",false,'Search');
--></script>
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Data&nbsp;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <img id="MSearchSelect" src="search/search.png"
             onmouseover="return searchBox.OnSearchSelectShow()"
             onmouseout="return searchBox.OnSearchSelectHide()"
             alt=""/>
        <input type="text" id="MSearchField" value="Search" accesskey="S"
             onfocus="searchBox.OnSearchFieldFocus(true)" 
             onblur="searchBox.OnSearchFieldFocus(false)" 
             onkeyup="searchBox.OnSearchFieldChange(event)"/>
        <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
        </div>
      </li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="files.html"><span>File&nbsp;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
<h1>/renoir/fourmano/Desktop/OUSIM/TIPS/branches/tips_build/include/axesim/ipixcorr_utils.h</h1><a href="ipixcorr__utils_8h.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 
<a name="l00011"></a>00011 <span class="preprocessor">#ifndef _IPIXCORR_UTILS_H</span>
<a name="l00012"></a>00012 <span class="preprocessor"></span>
<a name="l00013"></a>00013 <span class="preprocessor">#define _IPIXCORR_UTILS_H</span>
<a name="l00014"></a>00014 <span class="preprocessor"></span>
<a name="l00015"></a>00015 <span class="comment">// interpolation type used for the</span>
<a name="l00016"></a>00016 <span class="comment">// complex refractive indices</span>
<a name="l00017"></a><a class="code" href="ipixcorr__utils_8h.html#ab6f58a9a73a7eade1a2f0bbc8f5f8657">00017</a> <span class="preprocessor">#define IPCORR_INTERP_TYPE gsl_interp_linear</span>
<a name="l00018"></a>00018 <span class="preprocessor"></span>
<a name="l00019"></a>00019 <span class="comment">// interpolation type used for the</span>
<a name="l00020"></a>00020 <span class="comment">// complex refractive indices</span>
<a name="l00021"></a><a class="code" href="ipixcorr__utils_8h.html#a6fe7977081409268795744b40b706596">00021</a> <span class="preprocessor">#define NLINCORR_INTERP_TYPE gsl_interp_linear</span>
<a name="l00022"></a>00022 <span class="preprocessor"></span>
<a name="l00023"></a>00023 <span class="comment">// maximum beamID to be corrected</span>
<a name="l00024"></a><a class="code" href="ipixcorr__utils_8h.html#a7a12c5ae2a7aa5651d4dde49a1a29bd3">00024</a> <span class="preprocessor">#define CORRMAX    0</span>
<a name="l00025"></a>00025 <span class="preprocessor"></span>
<a name="l00026"></a>00026 <span class="comment">// maximum number of iterations</span>
<a name="l00027"></a>00027 <span class="comment">// for the zero point search</span>
<a name="l00028"></a><a class="code" href="ipixcorr__utils_8h.html#acd517c6f195c75b9dd0f3aad65326f3b">00028</a> <span class="preprocessor">#define MAX_ITER 1000</span>
<a name="l00029"></a>00029 <span class="preprocessor"></span>
<a name="l00030"></a>00030 <span class="comment">// extension for the interval in the zero</span>
<a name="l00031"></a>00031 <span class="comment">// point search to include the zero</span>
<a name="l00032"></a><a class="code" href="ipixcorr__utils_8h.html#a2d56827b1d456cb0d5546dfd3bca0f9f">00032</a> <span class="preprocessor">#define INTERVEXT    10</span>
<a name="l00033"></a>00033 <span class="preprocessor"></span>
<a name="l00034"></a>00034 <span class="comment">// stepsize in x to compute the</span>
<a name="l00035"></a>00035 <span class="comment">// correction factor and the wavelength</span>
<a name="l00036"></a>00036 <span class="comment">// on the object trace</span>
<a name="l00037"></a><a class="code" href="ipixcorr__utils_8h.html#a99d3339a8922f358fc9875c1e1dc9afa">00037</a> <span class="preprocessor">#define XSTEPSIZE    0.5</span>
<a name="l00038"></a>00038 <span class="preprocessor"></span>
<a name="l00039"></a>00039 <span class="comment">// the ipc fit to the</span>
<a name="l00040"></a>00040 <span class="comment">// data must be lower than this number</span>
<a name="l00041"></a>00041 <span class="comment">// to initialize a correction of the spectrum</span>
<a name="l00042"></a><a class="code" href="ipixcorr__utils_8h.html#a75c39c28d1307d02529f28b9a4327f91">00042</a> <span class="preprocessor">#define MAXQUALITY 1.5</span>
<a name="l00043"></a>00043 <span class="preprocessor"></span>
<a name="l00044"></a>00044 
<a name="l00045"></a>00045 
<a name="l00046"></a><a class="code" href="structfull__spectr.html">00046</a> <span class="keyword">typedef</span> <span class="keyword">struct</span>
<a name="l00047"></a>00047 {
<a name="l00048"></a><a class="code" href="structfull__spectr.html#a23d627eb19c4c148165339f09baae88b">00048</a>   <span class="keywordtype">int</span>       aperID;     <span class="comment">// the aperture  ID</span>
<a name="l00049"></a><a class="code" href="structfull__spectr.html#abbbe908129fb930d91fa025be6ed63d0">00049</a>   <span class="keywordtype">int</span>       beamID;     <span class="comment">// the beam ID</span>
<a name="l00050"></a><a class="code" href="structfull__spectr.html#a8f580565ed9f3fe21c4961c75ed0db7e">00050</a>   <span class="keywordtype">int</span>       nelems;     <span class="comment">// the number of spectral elements</span>
<a name="l00051"></a><a class="code" href="structfull__spectr.html#a82b0b0c21545b0af2fd869ec00227be5">00051</a>   <a class="code" href="structspectrum.html">spectrum</a>  *fgr_spec;  <span class="comment">// the spectrum structure for the foreground</span>
<a name="l00052"></a><a class="code" href="structfull__spectr.html#a6ec36890c31b664af3b77e4a98f40d53">00052</a>   <a class="code" href="structspectrum.html">spectrum</a>  *bck_spec;  <span class="comment">// the spectrum structure for the background</span>
<a name="l00053"></a><a class="code" href="structfull__spectr.html#ab003d5523b6cf8d7114cb638685c64e7">00053</a>   <a class="code" href="structspectrum.html">spectrum</a>  *obj_spec;  <span class="comment">// the spectrum structure for the object</span>
<a name="l00054"></a>00054 }
<a name="l00055"></a>00055   <a class="code" href="structfull__spectr.html">full_spectr</a>;
<a name="l00056"></a>00056 
<a name="l00057"></a>00057 
<a name="l00058"></a>00058 
<a name="l00062"></a><a class="code" href="structtlength__pars.html">00062</a> <span class="keyword">typedef</span> <span class="keyword">struct</span>
<a name="l00063"></a>00063 {
<a name="l00064"></a><a class="code" href="structtlength__pars.html#aa407253036242c48d9966676885f0cde">00064</a>   <a class="code" href="structbeam.html">beam</a>    *actbeam;
<a name="l00065"></a><a class="code" href="structtlength__pars.html#ae4abb3d406e407e652aa41015f12521d">00065</a>   <span class="keywordtype">double</span>   tlength;
<a name="l00066"></a>00066 }
<a name="l00067"></a>00067 <a class="code" href="structtlength__pars.html">tlength_pars</a>;
<a name="l00068"></a>00068 
<a name="l00069"></a>00069 
<a name="l00070"></a>00070 <span class="keyword">extern</span> <span class="keywordtype">double</span>
<a name="l00071"></a>00071 <a class="code" href="ipixcorr__utils_8c.html#af4e9765f3104c17a1476c67db9c8a84f">get_intpix_corr</a>(<a class="code" href="structbeam.html">beam</a> *actbeam, gsl_vector *cdisp, <a class="code" href="structinterpolator.html">interpolator</a> *ipcorr,
<a name="l00072"></a>00072                 <span class="keywordtype">float</span> lambda);
<a name="l00073"></a>00073 
<a name="l00074"></a>00074 <span class="keyword">extern</span> <span class="keywordtype">double</span> 
<a name="l00075"></a>00075 <a class="code" href="ipixcorr__utils_8c.html#a939a6e6f443e4e0fa40f51101f137309">get_yfract_for_xvalue</a>(<span class="keyword">const</span> <a class="code" href="structbeam.html">beam</a> *actbeam, <span class="keywordtype">double</span> xvalue);
<a name="l00076"></a>00076 
<a name="l00077"></a>00077 <span class="keyword">extern</span> <span class="keywordtype">double</span> 
<a name="l00078"></a>00078 <a class="code" href="ipixcorr__utils_8c.html#a5726174d85d0ab4c454528d0649e5db2">get_xvalue_from_tlength</a>(<a class="code" href="structbeam.html">beam</a> *actbeam, <span class="keywordtype">double</span> tlength);
<a name="l00079"></a>00079 
<a name="l00080"></a>00080 <span class="keyword">extern</span> <a class="code" href="structd__point.html">d_point</a> 
<a name="l00081"></a>00081 <a class="code" href="ipixcorr__utils_8c.html#a3b46ac0fc3c8ebd989b486424d6a3152">get_xinterv_from_beam</a>(<span class="keyword">const</span> <a class="code" href="structbeam.html">beam</a> *actbeam);
<a name="l00082"></a>00082 
<a name="l00083"></a>00083 <span class="keyword">extern</span> <span class="keywordtype">double</span>
<a name="l00084"></a>00084 <a class="code" href="ipixcorr__utils_8c.html#a10bb24af557b72099c27576721cd8100">zero_tlength</a> (<span class="keywordtype">double</span> x, <span class="keywordtype">void</span> *params);
<a name="l00085"></a>00085 
<a name="l00086"></a>00086 <span class="keyword">extern</span> <span class="keywordtype">double</span> 
<a name="l00087"></a>00087 <a class="code" href="ipixcorr__utils_8c.html#ad686ad3fa4f574a675a9e2f1f1b88225">get_tlength_from_dispersion</a>(gsl_vector *cdisp, <span class="keywordtype">float</span> lambda);
<a name="l00088"></a>00088 
<a name="l00089"></a>00089 <span class="keyword">extern</span> gsl_vector *
<a name="l00090"></a>00090 <a class="code" href="ipixcorr__utils_8c.html#a2da26172f91396f0e78e1f60d01a786a">condense_dispersion</a>(gsl_vector *disp_input);
<a name="l00091"></a>00091 
<a name="l00092"></a>00092 <span class="keyword">extern</span> <span class="keywordtype">int</span> 
<a name="l00093"></a>00093 <a class="code" href="ipixcorr__utils_8c.html#a6974f8614d588fa617386755767ecd4a">fitting_ipc_corr</a>(<a class="code" href="structbeam.html">beam</a> act_beam, <span class="keywordtype">char</span> conf_file_path[], <a class="code" href="structinterpolator.html">interpolator</a> *ipcorr,
<a name="l00094"></a>00094                  <a class="code" href="structfull__spectr.html">full_spectr</a> *SPC, <a class="code" href="structobservation.html">observation</a> *obs, <a class="code" href="aXe__grism_8h.html#a6117e17bb3108107676f4486e62d40e5">gsl_matrix</a> *data_matrix,
<a name="l00095"></a>00095                  <span class="keywordtype">char</span> ipc_file_path[], <a class="code" href="structbeam.html">beam</a> *beam_ptr);
<a name="l00096"></a>00096 
<a name="l00097"></a>00097 <span class="keyword">extern</span> <span class="keywordtype">void</span>
<a name="l00098"></a>00098 <a class="code" href="ipixcorr__utils_8c.html#ad46502c245fb93ee30197de24a70464b">intpix_corr_beam</a>(<a class="code" href="structbeam.html">beam</a> actbeam, <span class="keywordtype">char</span> conf_file_path[], <a class="code" href="structinterpolator.html">interpolator</a> *ipcorr,
<a name="l00099"></a>00099                  <a class="code" href="structfull__spectr.html">full_spectr</a> *SPC);
<a name="l00100"></a>00100 
<a name="l00101"></a>00101 <span class="keyword">extern</span> gsl_vector *
<a name="l00102"></a>00102 <a class="code" href="ipixcorr__utils_8c.html#a5fe31b6414ccdc53def40b719096d262">get_ipc_lambdas</a>(<span class="keyword">const</span> <a class="code" href="structbeam.html">beam</a> actbeam, <span class="keywordtype">char</span> conf_file_path[], gsl_vector *xvalues);
<a name="l00103"></a>00103 
<a name="l00104"></a>00104 <span class="keyword">extern</span> gsl_vector *
<a name="l00105"></a>00105 <a class="code" href="ipixcorr__utils_8c.html#aca657609c2dac5ac21c4b2f0d9b78674">get_ipc_cvalues</a>(<span class="keyword">const</span> <a class="code" href="structbeam.html">beam</a> actbeam, <a class="code" href="structinterpolator.html">interpolator</a> *ipcorr, gsl_vector *xvalues);
<a name="l00106"></a>00106 
<a name="l00107"></a>00107 <span class="keyword">extern</span> gsl_vector *
<a name="l00108"></a>00108 <a class="code" href="ipixcorr__utils_8c.html#a8003796c1b619b34fa8f964769cbbf14">get_ipc_xvalues</a>(<span class="keyword">const</span> <a class="code" href="structbeam.html">beam</a> actbeam);
<a name="l00109"></a>00109 
<a name="l00110"></a>00110 <span class="keyword">extern</span> <a class="code" href="structinterpolator.html">interpolator</a> *
<a name="l00111"></a>00111 <a class="code" href="ipixcorr__utils_8c.html#a2f8e61631faac85222b6f6451db085b1">get_ipclambda</a>(<a class="code" href="structbeam.html">beam</a> actbeam, <span class="keywordtype">char</span> conf_file_path[], <a class="code" href="structinterpolator.html">interpolator</a> *ipcorr);
<a name="l00112"></a>00112 
<a name="l00113"></a>00113 <span class="keyword">extern</span> <span class="keywordtype">void</span>
<a name="l00114"></a>00114 <a class="code" href="ipixcorr__utils_8c.html#a727f93ef1ebcbde730ff5930d5f379be">apply_corr_pet</a>(<a class="code" href="structinterpolator.html">interpolator</a> *ipclambda, <a class="code" href="structap__pixel.html">ap_pixel</a> *PET);
<a name="l00115"></a>00115 
<a name="l00116"></a>00116 <span class="keyword">extern</span> <span class="keywordtype">void</span>
<a name="l00117"></a>00117 <a class="code" href="ipixcorr__utils_8c.html#a41eb356cbfa31c8062d1c702617b2983">intpix_corr_pet</a>(<a class="code" href="structbeam.html">beam</a> actbeam, <span class="keywordtype">char</span> conf_file_path[],
<a name="l00118"></a>00118                 <a class="code" href="structinterpolator.html">interpolator</a> *ipcorr, <a class="code" href="structap__pixel.html">ap_pixel</a> *PET);
<a name="l00119"></a>00119 
<a name="l00120"></a>00120 <span class="keyword">extern</span> <span class="keywordtype">int</span> 
<a name="l00121"></a>00121 <a class="code" href="ipixcorr__utils_8c.html#ae596c1811da8db43b343a0f21ddd418e">is_pointlike</a>(<a class="code" href="structbeam.html">beam</a> actbeam, <span class="keywordtype">int</span> spec_OAF, <span class="keywordtype">double</span> max_ext);
<a name="l00122"></a>00122 
<a name="l00123"></a>00123 <span class="keyword">extern</span> fitsfile *
<a name="l00124"></a>00124 <a class="code" href="ipixcorr__utils_8c.html#ae32733e8fdf2ee4520d3664901a39781">get_SPC_opened</a>(<span class="keywordtype">char</span> SPCname[], <span class="keywordtype">int</span> mode);
<a name="l00125"></a>00125 
<a name="l00126"></a>00126 <span class="keyword">extern</span> <a class="code" href="structfull__spectr.html">full_spectr</a> *
<a name="l00127"></a>00127 <a class="code" href="ipixcorr__utils_8c.html#a63ff84c36a3d526c53eb1509181fd986">get_ALL_from_next_in_SPC</a>(fitsfile *SPC_ptr, <span class="keywordtype">int</span> *aperID, <span class="keywordtype">int</span> *beamID);
<a name="l00128"></a>00128 
<a name="l00129"></a>00129 <span class="keyword">extern</span> <span class="keywordtype">void</span>
<a name="l00130"></a>00130 <a class="code" href="ipixcorr__utils_8c.html#a053cf1d4fd530d3a4682673369f6e98e">free_full_spectr</a>(<a class="code" href="structfull__spectr.html">full_spectr</a> *act_spectr);
<a name="l00131"></a>00131 
<a name="l00132"></a>00132 <span class="keyword">extern</span> <a class="code" href="structspectrum.html">spectrum</a> *
<a name="l00133"></a>00133 <a class="code" href="ipixcorr__utils_8c.html#a7cc3b80e223da09ba29b1a11f3a6187e">get_spectrum_from_SPC</a>(fitsfile *SPC_ptr, <span class="keywordtype">char</span> count_col[], <span class="keywordtype">char</span> error_col[],
<a name="l00134"></a>00134                       <span class="keywordtype">int</span> nelems);
<a name="l00135"></a>00135 
<a name="l00136"></a>00136 <span class="keyword">extern</span> <span class="keywordtype">double</span> *
<a name="l00137"></a>00137 <a class="code" href="ipixcorr__utils_8c.html#a8a51bc806e29c38d040ef21711503b1e">get_dcolumn_from_SPC_opened</a>(fitsfile *SPC_ptr, <span class="keywordtype">char</span> colname[], <span class="keywordtype">int</span> nelems);
<a name="l00138"></a>00138 
<a name="l00139"></a>00139 <span class="keyword">extern</span> <span class="keywordtype">long</span> *
<a name="l00140"></a>00140 <a class="code" href="ipixcorr__utils_8c.html#adc3a06bf3550f201761db2e64f6e5d34">get_lcolumn_from_SPC_opened</a>(fitsfile *SPC_ptr, <span class="keywordtype">char</span> colname[], <span class="keywordtype">int</span> nelems);
<a name="l00141"></a>00141 
<a name="l00142"></a>00142 <span class="keyword">extern</span> <a class="code" href="structinterpolator.html">interpolator</a> *
<a name="l00143"></a>00143 <a class="code" href="ipixcorr__utils_8c.html#a73ef325bc09e4f02d034ac1f504388d1">create_nlincor</a>();
<a name="l00144"></a>00144 
<a name="l00145"></a>00145 <span class="keyword">extern</span> <span class="keywordtype">void</span>
<a name="l00146"></a>00146 <a class="code" href="ipixcorr__utils_8c.html#a7de262e2563e925ff59276137e4a1880">nlin_corr_beam</a>(<a class="code" href="structinterpolator.html">interpolator</a> *nlincorr, <span class="keywordtype">double</span> adcgain, <a class="code" href="structfull__spectr.html">full_spectr</a> *SPC);
<a name="l00147"></a>00147 
<a name="l00148"></a>00148 <span class="keyword">extern</span> <span class="keywordtype">double</span>
<a name="l00149"></a>00149 <a class="code" href="ipixcorr__utils_8c.html#a84e089833e7f6ea9ae5a48691e768c35">get_nlin_corr</a>(<a class="code" href="structinterpolator.html">interpolator</a> *nlincorr, <span class="keyword">const</span> <span class="keywordtype">double</span> lambda, <span class="keyword">const</span> <span class="keywordtype">double</span> cps);
<a name="l00150"></a>00150 <span class="preprocessor">#endif</span>
</pre></div></div>
<!--- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&nbsp;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&nbsp;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&nbsp;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&nbsp;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&nbsp;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&nbsp;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&nbsp;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&nbsp;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&nbsp;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&nbsp;</span>Defines</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<hr size="1"/><address style="text-align: right;"><small>Generated on 12 Oct 2014 for TIPS by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.6.1 </small></address>
</body>
</html>
